var fl=Object.defineProperty;var _l=(e,t,s)=>t in e?fl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var gt=(e,t,s)=>(_l(e,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function hr(e,t){const s=new Set(e.split(","));return i=>s.has(i)}const tt={},Ne=[],vt=()=>{},pl=()=>!1,si=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),gr=e=>e.startsWith("onUpdate:"),nt=Object.assign,dr=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},ml=Object.prototype.hasOwnProperty,G=(e,t)=>ml.call(e,t),U=Array.isArray,is=e=>ii(e)==="[object Map]",yl=e=>ii(e)==="[object Set]",z=e=>typeof e=="function",ot=e=>typeof e=="string",bs=e=>typeof e=="symbol",it=e=>e!==null&&typeof e=="object",Ea=e=>(it(e)||z(e))&&z(e.then)&&z(e.catch),xl=Object.prototype.toString,ii=e=>xl.call(e),Cl=e=>ii(e).slice(8,-1),Sl=e=>ii(e)==="[object Object]",fr=e=>ot(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,rs=hr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ri=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},bl=/-(\w)/g,Ge=ri(e=>e.replace(bl,(t,s)=>s?s.toUpperCase():"")),Ml=/\B([A-Z])/g,We=ri(e=>e.replace(Ml,"-$1").toLowerCase()),Ra=ri(e=>e.charAt(0).toUpperCase()+e.slice(1)),mi=ri(e=>e?`on${Ra(e)}`:""),he=(e,t)=>!Object.is(e,t),yi=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},Fa=(e,t,s,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:s})},vl=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Hr;const Da=()=>Hr||(Hr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function _r(e){if(U(e)){const t={};for(let s=0;s<e.length;s++){const i=e[s],r=ot(i)?Vl(i):_r(i);if(r)for(const n in r)t[n]=r[n]}return t}else if(ot(e)||it(e))return e}const Pl=/;(?![^(]*\))/g,Bl=/:([^]+)/,Il=/\/\*[^]*?\*\//g;function Vl(e){const t={};return e.replace(Il,"").split(Pl).forEach(s=>{if(s){const i=s.split(Bl);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function pr(e){let t="";if(ot(e))t=e;else if(U(e))for(let s=0;s<e.length;s++){const i=pr(e[s]);i&&(t+=i+" ")}else if(it(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const wl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Tl=hr(wl);function Aa(e){return!!e||e===""}/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vt;class El{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Vt,!t&&Vt&&(this.index=(Vt.scopes||(Vt.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const s=Vt;try{return Vt=this,t()}finally{Vt=s}}}on(){Vt=this}off(){Vt=this.parent}stop(t){if(this._active){let s,i;for(s=0,i=this.effects.length;s<i;s++)this.effects[s].stop();for(s=0,i=this.cleanups.length;s<i;s++)this.cleanups[s]();if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Rl(e,t=Vt){t&&t.active&&t.effects.push(e)}function Fl(){return Vt}let ve;class mr{constructor(t,s,i,r){this.fn=t,this.trigger=s,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Rl(this,r)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,ge();for(let t=0;t<this._depsLength;t++){const s=this.deps[t];if(s.computed&&(Dl(s.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),de()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=oe,s=ve;try{return oe=!0,ve=this,this._runnings++,Wr(this),this.fn()}finally{Yr(this),this._runnings--,ve=s,oe=t}}stop(){this.active&&(Wr(this),Yr(this),this.onStop&&this.onStop(),this.active=!1)}}function Dl(e){return e.value}function Wr(e){e._trackId++,e._depsLength=0}function Yr(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)La(e.deps[t],e);e.deps.length=e._depsLength}}function La(e,t){const s=e.get(t);s!==void 0&&t._trackId!==s&&(e.delete(t),e.size===0&&e.cleanup())}let oe=!0,ki=0;const Oa=[];function ge(){Oa.push(oe),oe=!1}function de(){const e=Oa.pop();oe=e===void 0?!0:e}function yr(){ki++}function xr(){for(ki--;!ki&&Ni.length;)Ni.shift()()}function ka(e,t,s){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const i=e.deps[e._depsLength];i!==t?(i&&La(i,e),e.deps[e._depsLength++]=t):e._depsLength++}}const Ni=[];function Na(e,t,s){yr();for(const i of e.keys()){let r;i._dirtyLevel<t&&(r??(r=e.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(r??(r=e.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&Ni.push(i.scheduler)))}xr()}const Ua=(e,t)=>{const s=new Map;return s.cleanup=e,s.computed=t,s},Ui=new WeakMap,Pe=Symbol(""),zi=Symbol("");function yt(e,t,s){if(oe&&ve){let i=Ui.get(e);i||Ui.set(e,i=new Map);let r=i.get(s);r||i.set(s,r=Ua(()=>i.delete(s))),ka(ve,r)}}function Yt(e,t,s,i,r,n){const a=Ui.get(e);if(!a)return;let o=[];if(t==="clear")o=[...a.values()];else if(s==="length"&&U(e)){const l=Number(i);a.forEach((u,c)=>{(c==="length"||!bs(c)&&c>=l)&&o.push(u)})}else switch(s!==void 0&&o.push(a.get(s)),t){case"add":U(e)?fr(s)&&o.push(a.get("length")):(o.push(a.get(Pe)),is(e)&&o.push(a.get(zi)));break;case"delete":U(e)||(o.push(a.get(Pe)),is(e)&&o.push(a.get(zi)));break;case"set":is(e)&&o.push(a.get(Pe));break}yr();for(const l of o)l&&Na(l,4);xr()}const Al=hr("__proto__,__v_isRef,__isVue"),za=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(bs)),qr=Ll();function Ll(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...s){const i=H(this);for(let n=0,a=this.length;n<a;n++)yt(i,"get",n+"");const r=i[t](...s);return r===-1||r===!1?i[t](...s.map(H)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...s){ge(),yr();const i=H(this)[t].apply(this,s);return xr(),de(),i}}),e}function Ol(e){bs(e)||(e=String(e));const t=H(this);return yt(t,"has",e),t.hasOwnProperty(e)}class ja{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,i){const r=this._isReadonly,n=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return n;if(s==="__v_raw")return i===(r?n?Jl:Ha:n?$a:Ga).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const a=U(t);if(!r){if(a&&G(qr,s))return Reflect.get(qr,s,i);if(s==="hasOwnProperty")return Ol}const o=Reflect.get(t,s,i);return(bs(s)?za.has(s):Al(s))||(r||yt(t,"get",s),n)?o:xt(o)?a&&fr(s)?o:o.value:it(o)?r?Wa(o):br(o):o}}class Xa extends ja{constructor(t=!1){super(!1,t)}set(t,s,i,r){let n=t[s];if(!this._isShallow){const l=hs(n);if(!Hs(i)&&!hs(i)&&(n=H(n),i=H(i)),!U(t)&&xt(n)&&!xt(i))return l?!1:(n.value=i,!0)}const a=U(t)&&fr(s)?Number(s)<t.length:G(t,s),o=Reflect.set(t,s,i,r);return t===H(r)&&(a?he(i,n)&&Yt(t,"set",s,i):Yt(t,"add",s,i)),o}deleteProperty(t,s){const i=G(t,s);t[s];const r=Reflect.deleteProperty(t,s);return r&&i&&Yt(t,"delete",s,void 0),r}has(t,s){const i=Reflect.has(t,s);return(!bs(s)||!za.has(s))&&yt(t,"has",s),i}ownKeys(t){return yt(t,"iterate",U(t)?"length":Pe),Reflect.ownKeys(t)}}class kl extends ja{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const Nl=new Xa,Ul=new kl,zl=new Xa(!0);const Cr=e=>e,ni=e=>Reflect.getPrototypeOf(e);function Bs(e,t,s=!1,i=!1){e=e.__v_raw;const r=H(e),n=H(t);s||(he(t,n)&&yt(r,"get",t),yt(r,"get",n));const{has:a}=ni(r),o=i?Cr:s?vr:gs;if(a.call(r,t))return o(e.get(t));if(a.call(r,n))return o(e.get(n));e!==r&&e.get(t)}function Is(e,t=!1){const s=this.__v_raw,i=H(s),r=H(e);return t||(he(e,r)&&yt(i,"has",e),yt(i,"has",r)),e===r?s.has(e):s.has(e)||s.has(r)}function Vs(e,t=!1){return e=e.__v_raw,!t&&yt(H(e),"iterate",Pe),Reflect.get(e,"size",e)}function Jr(e){e=H(e);const t=H(this);return ni(t).has.call(t,e)||(t.add(e),Yt(t,"add",e,e)),this}function Kr(e,t){t=H(t);const s=H(this),{has:i,get:r}=ni(s);let n=i.call(s,e);n||(e=H(e),n=i.call(s,e));const a=r.call(s,e);return s.set(e,t),n?he(t,a)&&Yt(s,"set",e,t):Yt(s,"add",e,t),this}function Zr(e){const t=H(this),{has:s,get:i}=ni(t);let r=s.call(t,e);r||(e=H(e),r=s.call(t,e)),i&&i.call(t,e);const n=t.delete(e);return r&&Yt(t,"delete",e,void 0),n}function Qr(){const e=H(this),t=e.size!==0,s=e.clear();return t&&Yt(e,"clear",void 0,void 0),s}function ws(e,t){return function(i,r){const n=this,a=n.__v_raw,o=H(a),l=t?Cr:e?vr:gs;return!e&&yt(o,"iterate",Pe),a.forEach((u,c)=>i.call(r,l(u),l(c),n))}}function Ts(e,t,s){return function(...i){const r=this.__v_raw,n=H(r),a=is(n),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,u=r[e](...i),c=s?Cr:t?vr:gs;return!t&&yt(n,"iterate",l?zi:Pe),{next(){const{value:g,done:p}=u.next();return p?{value:g,done:p}:{value:o?[c(g[0]),c(g[1])]:c(g),done:p}},[Symbol.iterator](){return this}}}}function Jt(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function jl(){const e={get(n){return Bs(this,n)},get size(){return Vs(this)},has:Is,add:Jr,set:Kr,delete:Zr,clear:Qr,forEach:ws(!1,!1)},t={get(n){return Bs(this,n,!1,!0)},get size(){return Vs(this)},has:Is,add:Jr,set:Kr,delete:Zr,clear:Qr,forEach:ws(!1,!0)},s={get(n){return Bs(this,n,!0)},get size(){return Vs(this,!0)},has(n){return Is.call(this,n,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:ws(!0,!1)},i={get(n){return Bs(this,n,!0,!0)},get size(){return Vs(this,!0)},has(n){return Is.call(this,n,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:ws(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=Ts(n,!1,!1),s[n]=Ts(n,!0,!1),t[n]=Ts(n,!1,!0),i[n]=Ts(n,!0,!0)}),[e,s,t,i]}const[Xl,Gl,$l,Hl]=jl();function Sr(e,t){const s=t?e?Hl:$l:e?Gl:Xl;return(i,r,n)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(G(s,r)&&r in i?s:i,r,n)}const Wl={get:Sr(!1,!1)},Yl={get:Sr(!1,!0)},ql={get:Sr(!0,!1)};const Ga=new WeakMap,$a=new WeakMap,Ha=new WeakMap,Jl=new WeakMap;function Kl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Zl(e){return e.__v_skip||!Object.isExtensible(e)?0:Kl(Cl(e))}function br(e){return hs(e)?e:Mr(e,!1,Nl,Wl,Ga)}function Ql(e){return Mr(e,!1,zl,Yl,$a)}function Wa(e){return Mr(e,!0,Ul,ql,Ha)}function Mr(e,t,s,i,r){if(!it(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const n=r.get(e);if(n)return n;const a=Zl(e);if(a===0)return e;const o=new Proxy(e,a===2?i:s);return r.set(e,o),o}function ns(e){return hs(e)?ns(e.__v_raw):!!(e&&e.__v_isReactive)}function hs(e){return!!(e&&e.__v_isReadonly)}function Hs(e){return!!(e&&e.__v_isShallow)}function Ya(e){return e?!!e.__v_raw:!1}function H(e){const t=e&&e.__v_raw;return t?H(t):e}function qa(e){return Object.isExtensible(e)&&Fa(e,"__v_skip",!0),e}const gs=e=>it(e)?br(e):e,vr=e=>it(e)?Wa(e):e;class Ja{constructor(t,s,i,r){this.getter=t,this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new mr(()=>t(this._value),()=>Us(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=H(this);return(!t._cacheable||t.effect.dirty)&&he(t._value,t._value=t.effect.run())&&Us(t,4),Ka(t),t.effect._dirtyLevel>=2&&Us(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function tu(e,t,s=!1){let i,r;const n=z(e);return n?(i=e,r=vt):(i=e.get,r=e.set),new Ja(i,r,n||!r,s)}function Ka(e){var t;oe&&ve&&(e=H(e),ka(ve,(t=e.dep)!=null?t:e.dep=Ua(()=>e.dep=void 0,e instanceof Ja?e:void 0)))}function Us(e,t=4,s){e=H(e);const i=e.dep;i&&Na(i,t)}function xt(e){return!!(e&&e.__v_isRef===!0)}function eu(e){return su(e,!1)}function su(e,t){return xt(e)?e:new iu(e,t)}class iu{constructor(t,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:H(t),this._value=s?t:gs(t)}get value(){return Ka(this),this._value}set value(t){const s=this.__v_isShallow||Hs(t)||hs(t);t=s?t:H(t),he(t,this._rawValue)&&(this._rawValue=t,this._value=s?t:gs(t),Us(this,4))}}function ru(e){return xt(e)?e.value:e}const nu={get:(e,t,s)=>ru(Reflect.get(e,t,s)),set:(e,t,s,i)=>{const r=e[t];return xt(r)&&!xt(s)?(r.value=s,!0):Reflect.set(e,t,s,i)}};function Za(e){return ns(e)?e:new Proxy(e,nu)}/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function le(e,t,s,i){try{return i?e(...i):e()}catch(r){ai(r,t,s)}}function Ft(e,t,s,i){if(z(e)){const r=le(e,t,s,i);return r&&Ea(r)&&r.catch(n=>{ai(n,t,s)}),r}if(U(e)){const r=[];for(let n=0;n<e.length;n++)r.push(Ft(e[n],t,s,i));return r}}function ai(e,t,s,i=!0){const r=t?t.vnode:null;if(t){let n=t.parent;const a=t.proxy,o=`https://vuejs.org/error-reference/#runtime-${s}`;for(;n;){const u=n.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](e,a,o)===!1)return}n=n.parent}const l=t.appContext.config.errorHandler;if(l){ge(),le(l,null,10,[e,a,o]),de();return}}au(e,s,r,i)}function au(e,t,s,i=!0){console.error(e)}let ds=!1,ji=!1;const lt=[];let Ut=0;const Ue=[];let te=null,be=0;const Qa=Promise.resolve();let Pr=null;function ou(e){const t=Pr||Qa;return e?t.then(this?e.bind(this):e):t}function lu(e){let t=Ut+1,s=lt.length;for(;t<s;){const i=t+s>>>1,r=lt[i],n=fs(r);n<e||n===e&&r.pre?t=i+1:s=i}return t}function Br(e){(!lt.length||!lt.includes(e,ds&&e.allowRecurse?Ut+1:Ut))&&(e.id==null?lt.push(e):lt.splice(lu(e.id),0,e),to())}function to(){!ds&&!ji&&(ji=!0,Pr=Qa.then(so))}function uu(e){const t=lt.indexOf(e);t>Ut&&lt.splice(t,1)}function cu(e){U(e)?Ue.push(...e):(!te||!te.includes(e,e.allowRecurse?be+1:be))&&Ue.push(e),to()}function tn(e,t,s=ds?Ut+1:0){for(;s<lt.length;s++){const i=lt[s];if(i&&i.pre){if(e&&i.id!==e.uid)continue;lt.splice(s,1),s--,i()}}}function eo(e){if(Ue.length){const t=[...new Set(Ue)].sort((s,i)=>fs(s)-fs(i));if(Ue.length=0,te){te.push(...t);return}for(te=t,be=0;be<te.length;be++)te[be]();te=null,be=0}}const fs=e=>e.id==null?1/0:e.id,hu=(e,t)=>{const s=fs(e)-fs(t);if(s===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return s};function so(e){ji=!1,ds=!0,lt.sort(hu);try{for(Ut=0;Ut<lt.length;Ut++){const t=lt[Ut];t&&t.active!==!1&&le(t,null,14)}}finally{Ut=0,lt.length=0,eo(),ds=!1,Pr=null,(lt.length||Ue.length)&&so()}}function gu(e,t,...s){if(e.isUnmounted)return;const i=e.vnode.props||tt;let r=s;const n=t.startsWith("update:"),a=n&&t.slice(7);if(a&&a in i){const c=`${a==="modelValue"?"model":a}Modifiers`,{number:g,trim:p}=i[c]||tt;p&&(r=s.map(f=>ot(f)?f.trim():f)),g&&(r=s.map(vl))}let o,l=i[o=mi(t)]||i[o=mi(Ge(t))];!l&&n&&(l=i[o=mi(We(t))]),l&&Ft(l,e,6,r);const u=i[o+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Ft(u,e,6,r)}}function io(e,t,s=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const n=e.emits;let a={},o=!1;if(!z(e)){const l=u=>{const c=io(u,t,!0);c&&(o=!0,nt(a,c))};!s&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!n&&!o?(it(e)&&i.set(e,null),null):(U(n)?n.forEach(l=>a[l]=null):nt(a,n),it(e)&&i.set(e,a),a)}function oi(e,t){return!e||!si(t)?!1:(t=t.slice(2).replace(/Once$/,""),G(e,t[0].toLowerCase()+t.slice(1))||G(e,We(t))||G(e,t))}let jt=null,ro=null;function Ws(e){const t=jt;return jt=e,ro=e&&e.type.__scopeId||null,t}function du(e,t=jt,s){if(!t||e._n)return e;const i=(...r)=>{i._d&&hn(-1);const n=Ws(t);let a;try{a=e(...r)}finally{Ws(n),i._d&&hn(1)}return a};return i._n=!0,i._c=!0,i._d=!0,i}function xi(e){const{type:t,vnode:s,proxy:i,withProxy:r,propsOptions:[n],slots:a,attrs:o,emit:l,render:u,renderCache:c,props:g,data:p,setupState:f,ctx:_,inheritAttrs:x}=e,y=Ws(e);let v,M;try{if(s.shapeFlag&4){const E=r||i,F=E;v=Nt(u.call(F,E,c,g,f,p,_)),M=o}else{const E=t;v=Nt(E.length>1?E(g,{attrs:o,slots:a,emit:l}):E(g,null)),M=t.props?o:fu(o)}}catch(E){ls.length=0,ai(E,e,1),v=Be(_s)}let V=v;if(M&&x!==!1){const E=Object.keys(M),{shapeFlag:F}=V;E.length&&F&7&&(n&&E.some(gr)&&(M=_u(M,n)),V=$e(V,M,!1,!0))}return s.dirs&&(V=$e(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(s.dirs):s.dirs),s.transition&&(V.transition=s.transition),v=V,Ws(y),v}const fu=e=>{let t;for(const s in e)(s==="class"||s==="style"||si(s))&&((t||(t={}))[s]=e[s]);return t},_u=(e,t)=>{const s={};for(const i in e)(!gr(i)||!(i.slice(9)in t))&&(s[i]=e[i]);return s};function pu(e,t,s){const{props:i,children:r,component:n}=e,{props:a,children:o,patchFlag:l}=t,u=n.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return i?en(i,a,u):!!a;if(l&8){const c=t.dynamicProps;for(let g=0;g<c.length;g++){const p=c[g];if(a[p]!==i[p]&&!oi(u,p))return!0}}}else return(r||o)&&(!o||!o.$stable)?!0:i===a?!1:i?a?en(i,a,u):!0:!!a;return!1}function en(e,t,s){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const n=i[r];if(t[n]!==e[n]&&!oi(s,n))return!0}return!1}function mu({vnode:e,parent:t},s){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=s,t=t.parent;else break}}const yu=Symbol.for("v-ndc"),xu=e=>e.__isSuspense;function Cu(e,t){t&&t.pendingBranch?U(e)?t.effects.push(...e):t.effects.push(e):cu(e)}const Su=Symbol.for("v-scx"),bu=()=>js(Su),Es={};function Ci(e,t,s){return no(e,t,s)}function no(e,t,{immediate:s,deep:i,flush:r,once:n,onTrack:a,onTrigger:o}=tt){if(t&&n){const w=t;t=(...$)=>{w(...$),F()}}const l=_t,u=w=>i===!0?w:Ae(w,i===!1?1:void 0);let c,g=!1,p=!1;if(xt(e)?(c=()=>e.value,g=Hs(e)):ns(e)?(c=()=>u(e),g=!0):U(e)?(p=!0,g=e.some(w=>ns(w)||Hs(w)),c=()=>e.map(w=>{if(xt(w))return w.value;if(ns(w))return u(w);if(z(w))return le(w,l,2)})):z(e)?t?c=()=>le(e,l,2):c=()=>(f&&f(),Ft(e,l,3,[_])):c=vt,t&&i){const w=c;c=()=>Ae(w())}let f,_=w=>{f=V.onStop=()=>{le(w,l,4),f=V.onStop=void 0}},x;if(ci)if(_=vt,t?s&&Ft(t,l,3,[c(),p?[]:void 0,_]):c(),r==="sync"){const w=bu();x=w.__watcherHandles||(w.__watcherHandles=[])}else return vt;let y=p?new Array(e.length).fill(Es):Es;const v=()=>{if(!(!V.active||!V.dirty))if(t){const w=V.run();(i||g||(p?w.some(($,Z)=>he($,y[Z])):he(w,y)))&&(f&&f(),Ft(t,l,3,[w,y===Es?void 0:p&&y[0]===Es?[]:y,_]),y=w)}else V.run()};v.allowRecurse=!!t;let M;r==="sync"?M=v:r==="post"?M=()=>pt(v,l&&l.suspense):(v.pre=!0,l&&(v.id=l.uid),M=()=>Br(v));const V=new mr(c,vt,M),E=Fl(),F=()=>{V.stop(),E&&dr(E.effects,V)};return t?s?v():y=V.run():r==="post"?pt(V.run.bind(V),l&&l.suspense):V.run(),x&&x.push(F),F}function Mu(e,t,s){const i=this.proxy,r=ot(e)?e.includes(".")?ao(i,e):()=>i[e]:e.bind(i,i);let n;z(t)?n=t:(n=t.handler,s=t);const a=Ms(this),o=no(r,n.bind(i),s);return a(),o}function ao(e,t){const s=t.split(".");return()=>{let i=e;for(let r=0;r<s.length&&i;r++)i=i[s[r]];return i}}function Ae(e,t=1/0,s){if(t<=0||!it(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),t--,xt(e))Ae(e.value,t,s);else if(U(e))for(let i=0;i<e.length;i++)Ae(e[i],t,s);else if(yl(e)||is(e))e.forEach(i=>{Ae(i,t,s)});else if(Sl(e))for(const i in e)Ae(e[i],t,s);return e}function pe(e,t,s,i){const r=e.dirs,n=t&&t.dirs;for(let a=0;a<r.length;a++){const o=r[a];n&&(o.oldValue=n[a].value);let l=o.dir[i];l&&(ge(),Ft(l,s,8,[e.el,o,e,t]),de())}}/*! #__NO_SIDE_EFFECTS__ */function vu(e,t){return z(e)?nt({name:e.name},t,{setup:e}):e}const zs=e=>!!e.type.__asyncLoader,oo=e=>e.type.__isKeepAlive;function Pu(e,t){lo(e,"a",t)}function Bu(e,t){lo(e,"da",t)}function lo(e,t,s=_t){const i=e.__wdc||(e.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(li(t,i,s),s){let r=s.parent;for(;r&&r.parent;)oo(r.parent.vnode)&&Iu(i,t,s,r),r=r.parent}}function Iu(e,t,s,i){const r=li(t,e,i,!0);co(()=>{dr(i[t],r)},s)}function li(e,t,s=_t,i=!1){if(s){const r=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...a)=>{if(s.isUnmounted)return;ge();const o=Ms(s),l=Ft(t,s,e,a);return o(),de(),l});return i?r.unshift(n):r.push(n),n}}const qt=e=>(t,s=_t)=>(!ci||e==="sp")&&li(e,(...i)=>t(...i),s),Vu=qt("bm"),uo=qt("m"),wu=qt("bu"),Tu=qt("u"),Eu=qt("bum"),co=qt("um"),Ru=qt("sp"),Fu=qt("rtg"),Du=qt("rtc");function Au(e,t=_t){li("ec",e,t)}const Xi=e=>e?Bo(e)?Tr(e)||e.proxy:Xi(e.parent):null,as=nt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Xi(e.parent),$root:e=>Xi(e.root),$emit:e=>e.emit,$options:e=>Ir(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Br(e.update)}),$nextTick:e=>e.n||(e.n=ou.bind(e.proxy)),$watch:e=>Mu.bind(e)}),Si=(e,t)=>e!==tt&&!e.__isScriptSetup&&G(e,t),Lu={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:i,data:r,props:n,accessCache:a,type:o,appContext:l}=e;let u;if(t[0]!=="$"){const f=a[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return r[t];case 4:return s[t];case 3:return n[t]}else{if(Si(i,t))return a[t]=1,i[t];if(r!==tt&&G(r,t))return a[t]=2,r[t];if((u=e.propsOptions[0])&&G(u,t))return a[t]=3,n[t];if(s!==tt&&G(s,t))return a[t]=4,s[t];Gi&&(a[t]=0)}}const c=as[t];let g,p;if(c)return t==="$attrs"&&yt(e.attrs,"get",""),c(e);if((g=o.__cssModules)&&(g=g[t]))return g;if(s!==tt&&G(s,t))return a[t]=4,s[t];if(p=l.config.globalProperties,G(p,t))return p[t]},set({_:e},t,s){const{data:i,setupState:r,ctx:n}=e;return Si(r,t)?(r[t]=s,!0):i!==tt&&G(i,t)?(i[t]=s,!0):G(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(n[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:i,appContext:r,propsOptions:n}},a){let o;return!!s[a]||e!==tt&&G(e,a)||Si(t,a)||(o=n[0])&&G(o,a)||G(i,a)||G(as,a)||G(r.config.globalProperties,a)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:G(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function sn(e){return U(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let Gi=!0;function Ou(e){const t=Ir(e),s=e.proxy,i=e.ctx;Gi=!1,t.beforeCreate&&rn(t.beforeCreate,e,"bc");const{data:r,computed:n,methods:a,watch:o,provide:l,inject:u,created:c,beforeMount:g,mounted:p,beforeUpdate:f,updated:_,activated:x,deactivated:y,beforeDestroy:v,beforeUnmount:M,destroyed:V,unmounted:E,render:F,renderTracked:w,renderTriggered:$,errorCaptured:Z,serverPrefetch:X,expose:Y,inheritAttrs:ct,components:Dt,directives:we,filters:_i}=t;if(u&&ku(u,i,null),a)for(const et in a){const q=a[et];z(q)&&(i[et]=q.bind(s))}if(r){const et=r.call(s,s);it(et)&&(e.data=br(et))}if(Gi=!0,n)for(const et in n){const q=n[et],fe=z(q)?q.bind(s,s):z(q.get)?q.get.bind(s,s):vt,vs=!z(q)&&z(q.set)?q.set.bind(s):vt,_e=yc({get:fe,set:vs});Object.defineProperty(i,et,{enumerable:!0,configurable:!0,get:()=>_e.value,set:At=>_e.value=At})}if(o)for(const et in o)ho(o[et],i,s,et);if(l){const et=z(l)?l.call(s):l;Reflect.ownKeys(et).forEach(q=>{Gu(q,et[q])})}c&&rn(c,e,"c");function ht(et,q){U(q)?q.forEach(fe=>et(fe.bind(s))):q&&et(q.bind(s))}if(ht(Vu,g),ht(uo,p),ht(wu,f),ht(Tu,_),ht(Pu,x),ht(Bu,y),ht(Au,Z),ht(Du,w),ht(Fu,$),ht(Eu,M),ht(co,E),ht(Ru,X),U(Y))if(Y.length){const et=e.exposed||(e.exposed={});Y.forEach(q=>{Object.defineProperty(et,q,{get:()=>s[q],set:fe=>s[q]=fe})})}else e.exposed||(e.exposed={});F&&e.render===vt&&(e.render=F),ct!=null&&(e.inheritAttrs=ct),Dt&&(e.components=Dt),we&&(e.directives=we)}function ku(e,t,s=vt){U(e)&&(e=$i(e));for(const i in e){const r=e[i];let n;it(r)?"default"in r?n=js(r.from||i,r.default,!0):n=js(r.from||i):n=js(r),xt(n)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>n.value,set:a=>n.value=a}):t[i]=n}}function rn(e,t,s){Ft(U(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,s)}function ho(e,t,s,i){const r=i.includes(".")?ao(s,i):()=>s[i];if(ot(e)){const n=t[e];z(n)&&Ci(r,n)}else if(z(e))Ci(r,e.bind(s));else if(it(e))if(U(e))e.forEach(n=>ho(n,t,s,i));else{const n=z(e.handler)?e.handler.bind(s):t[e.handler];z(n)&&Ci(r,n,e)}}function Ir(e){const t=e.type,{mixins:s,extends:i}=t,{mixins:r,optionsCache:n,config:{optionMergeStrategies:a}}=e.appContext,o=n.get(t);let l;return o?l=o:!r.length&&!s&&!i?l=t:(l={},r.length&&r.forEach(u=>Ys(l,u,a,!0)),Ys(l,t,a)),it(t)&&n.set(t,l),l}function Ys(e,t,s,i=!1){const{mixins:r,extends:n}=t;n&&Ys(e,n,s,!0),r&&r.forEach(a=>Ys(e,a,s,!0));for(const a in t)if(!(i&&a==="expose")){const o=Nu[a]||s&&s[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const Nu={data:nn,props:an,emits:an,methods:ts,computed:ts,beforeCreate:dt,created:dt,beforeMount:dt,mounted:dt,beforeUpdate:dt,updated:dt,beforeDestroy:dt,beforeUnmount:dt,destroyed:dt,unmounted:dt,activated:dt,deactivated:dt,errorCaptured:dt,serverPrefetch:dt,components:ts,directives:ts,watch:zu,provide:nn,inject:Uu};function nn(e,t){return t?e?function(){return nt(z(e)?e.call(this,this):e,z(t)?t.call(this,this):t)}:t:e}function Uu(e,t){return ts($i(e),$i(t))}function $i(e){if(U(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function dt(e,t){return e?[...new Set([].concat(e,t))]:t}function ts(e,t){return e?nt(Object.create(null),e,t):t}function an(e,t){return e?U(e)&&U(t)?[...new Set([...e,...t])]:nt(Object.create(null),sn(e),sn(t??{})):t}function zu(e,t){if(!e)return t;if(!t)return e;const s=nt(Object.create(null),e);for(const i in t)s[i]=dt(e[i],t[i]);return s}function go(){return{app:null,config:{isNativeTag:pl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ju=0;function Xu(e,t){return function(i,r=null){z(i)||(i=nt({},i)),r!=null&&!it(r)&&(r=null);const n=go(),a=new WeakSet;let o=!1;const l=n.app={_uid:ju++,_component:i,_props:r,_container:null,_context:n,_instance:null,version:xc,get config(){return n.config},set config(u){},use(u,...c){return a.has(u)||(u&&z(u.install)?(a.add(u),u.install(l,...c)):z(u)&&(a.add(u),u(l,...c))),l},mixin(u){return n.mixins.includes(u)||n.mixins.push(u),l},component(u,c){return c?(n.components[u]=c,l):n.components[u]},directive(u,c){return c?(n.directives[u]=c,l):n.directives[u]},mount(u,c,g){if(!o){const p=Be(i,r);return p.appContext=n,g===!0?g="svg":g===!1&&(g=void 0),c&&t?t(p,u):e(p,u,g),o=!0,l._container=u,u.__vue_app__=l,Tr(p.component)||p.component.proxy}},unmount(){o&&(e(null,l._container),delete l._container.__vue_app__)},provide(u,c){return n.provides[u]=c,l},runWithContext(u){const c=os;os=l;try{return u()}finally{os=c}}};return l}}let os=null;function Gu(e,t){if(_t){let s=_t.provides;const i=_t.parent&&_t.parent.provides;i===s&&(s=_t.provides=Object.create(i)),s[e]=t}}function js(e,t,s=!1){const i=_t||jt;if(i||os){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:os._context.provides;if(r&&e in r)return r[e];if(arguments.length>1)return s&&z(t)?t.call(i&&i.proxy):t}}const fo={},_o=()=>Object.create(fo),po=e=>Object.getPrototypeOf(e)===fo;function $u(e,t,s,i=!1){const r={},n=_o();e.propsDefaults=Object.create(null),mo(e,t,r,n);for(const a in e.propsOptions[0])a in r||(r[a]=void 0);s?e.props=i?r:Ql(r):e.type.props?e.props=r:e.props=n,e.attrs=n}function Hu(e,t,s,i){const{props:r,attrs:n,vnode:{patchFlag:a}}=e,o=H(r),[l]=e.propsOptions;let u=!1;if((i||a>0)&&!(a&16)){if(a&8){const c=e.vnode.dynamicProps;for(let g=0;g<c.length;g++){let p=c[g];if(oi(e.emitsOptions,p))continue;const f=t[p];if(l)if(G(n,p))f!==n[p]&&(n[p]=f,u=!0);else{const _=Ge(p);r[_]=Hi(l,o,_,f,e,!1)}else f!==n[p]&&(n[p]=f,u=!0)}}}else{mo(e,t,r,n)&&(u=!0);let c;for(const g in o)(!t||!G(t,g)&&((c=We(g))===g||!G(t,c)))&&(l?s&&(s[g]!==void 0||s[c]!==void 0)&&(r[g]=Hi(l,o,g,void 0,e,!0)):delete r[g]);if(n!==o)for(const g in n)(!t||!G(t,g))&&(delete n[g],u=!0)}u&&Yt(e.attrs,"set","")}function mo(e,t,s,i){const[r,n]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(rs(l))continue;const u=t[l];let c;r&&G(r,c=Ge(l))?!n||!n.includes(c)?s[c]=u:(o||(o={}))[c]=u:oi(e.emitsOptions,l)||(!(l in i)||u!==i[l])&&(i[l]=u,a=!0)}if(n){const l=H(s),u=o||tt;for(let c=0;c<n.length;c++){const g=n[c];s[g]=Hi(r,l,g,u[g],e,!G(u,g))}}return a}function Hi(e,t,s,i,r,n){const a=e[s];if(a!=null){const o=G(a,"default");if(o&&i===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&z(l)){const{propsDefaults:u}=r;if(s in u)i=u[s];else{const c=Ms(r);i=u[s]=l.call(null,t),c()}}else i=l}a[0]&&(n&&!o?i=!1:a[1]&&(i===""||i===We(s))&&(i=!0))}return i}function yo(e,t,s=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const n=e.props,a={},o=[];let l=!1;if(!z(e)){const c=g=>{l=!0;const[p,f]=yo(g,t,!0);nt(a,p),f&&o.push(...f)};!s&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!n&&!l)return it(e)&&i.set(e,Ne),Ne;if(U(n))for(let c=0;c<n.length;c++){const g=Ge(n[c]);on(g)&&(a[g]=tt)}else if(n)for(const c in n){const g=Ge(c);if(on(g)){const p=n[c],f=a[g]=U(p)||z(p)?{type:p}:nt({},p);if(f){const _=cn(Boolean,f.type),x=cn(String,f.type);f[0]=_>-1,f[1]=x<0||_<x,(_>-1||G(f,"default"))&&o.push(g)}}}const u=[a,o];return it(e)&&i.set(e,u),u}function on(e){return e[0]!=="$"&&!rs(e)}function ln(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function un(e,t){return ln(e)===ln(t)}function cn(e,t){return U(t)?t.findIndex(s=>un(s,e)):z(t)&&un(t,e)?0:-1}const xo=e=>e[0]==="_"||e==="$stable",Vr=e=>U(e)?e.map(Nt):[Nt(e)],Wu=(e,t,s)=>{if(t._n)return t;const i=du((...r)=>Vr(t(...r)),s);return i._c=!1,i},Co=(e,t,s)=>{const i=e._ctx;for(const r in e){if(xo(r))continue;const n=e[r];if(z(n))t[r]=Wu(r,n,i);else if(n!=null){const a=Vr(n);t[r]=()=>a}}},So=(e,t)=>{const s=Vr(t);e.slots.default=()=>s},Yu=(e,t)=>{const s=e.slots=_o();if(e.vnode.shapeFlag&32){const i=t._;i?(nt(s,t),Fa(s,"_",i,!0)):Co(t,s)}else t&&So(e,t)},qu=(e,t,s)=>{const{vnode:i,slots:r}=e;let n=!0,a=tt;if(i.shapeFlag&32){const o=t._;o?s&&o===1?n=!1:(nt(r,t),!s&&o===1&&delete r._):(n=!t.$stable,Co(t,r)),a=t}else t&&(So(e,t),a={default:1});if(n)for(const o in r)!xo(o)&&a[o]==null&&delete r[o]};function Wi(e,t,s,i,r=!1){if(U(e)){e.forEach((p,f)=>Wi(p,t&&(U(t)?t[f]:t),s,i,r));return}if(zs(i)&&!r)return;const n=i.shapeFlag&4?Tr(i.component)||i.component.proxy:i.el,a=r?null:n,{i:o,r:l}=e,u=t&&t.r,c=o.refs===tt?o.refs={}:o.refs,g=o.setupState;if(u!=null&&u!==l&&(ot(u)?(c[u]=null,G(g,u)&&(g[u]=null)):xt(u)&&(u.value=null)),z(l))le(l,o,12,[a,c]);else{const p=ot(l),f=xt(l);if(p||f){const _=()=>{if(e.f){const x=p?G(g,l)?g[l]:c[l]:l.value;r?U(x)&&dr(x,n):U(x)?x.includes(n)||x.push(n):p?(c[l]=[n],G(g,l)&&(g[l]=c[l])):(l.value=[n],e.k&&(c[e.k]=l.value))}else p?(c[l]=a,G(g,l)&&(g[l]=a)):f&&(l.value=a,e.k&&(c[e.k]=a))};a?(_.id=-1,pt(_,s)):_()}}}const pt=Cu;function Ju(e){return Ku(e)}function Ku(e,t){const s=Da();s.__VUE__=!0;const{insert:i,remove:r,patchProp:n,createElement:a,createText:o,createComment:l,setText:u,setElementText:c,parentNode:g,nextSibling:p,setScopeId:f=vt,insertStaticContent:_}=e,x=(h,d,m,C=null,S=null,B=null,T=void 0,P=null,I=!!d.dynamicChildren)=>{if(h===d)return;h&&!Je(h,d)&&(C=Ps(h),At(h,S,B,!0),h=null),d.patchFlag===-2&&(I=!1,d.dynamicChildren=null);const{type:b,ref:R,shapeFlag:O}=d;switch(b){case ui:y(h,d,m,C);break;case _s:v(h,d,m,C);break;case Mi:h==null&&M(d,m,C,T);break;case Ht:Dt(h,d,m,C,S,B,T,P,I);break;default:O&1?F(h,d,m,C,S,B,T,P,I):O&6?we(h,d,m,C,S,B,T,P,I):(O&64||O&128)&&b.process(h,d,m,C,S,B,T,P,I,Ye)}R!=null&&S&&Wi(R,h&&h.ref,B,d||h,!d)},y=(h,d,m,C)=>{if(h==null)i(d.el=o(d.children),m,C);else{const S=d.el=h.el;d.children!==h.children&&u(S,d.children)}},v=(h,d,m,C)=>{h==null?i(d.el=l(d.children||""),m,C):d.el=h.el},M=(h,d,m,C)=>{[h.el,h.anchor]=_(h.children,d,m,C,h.el,h.anchor)},V=({el:h,anchor:d},m,C)=>{let S;for(;h&&h!==d;)S=p(h),i(h,m,C),h=S;i(d,m,C)},E=({el:h,anchor:d})=>{let m;for(;h&&h!==d;)m=p(h),r(h),h=m;r(d)},F=(h,d,m,C,S,B,T,P,I)=>{d.type==="svg"?T="svg":d.type==="math"&&(T="mathml"),h==null?w(d,m,C,S,B,T,P,I):X(h,d,S,B,T,P,I)},w=(h,d,m,C,S,B,T,P)=>{let I,b;const{props:R,shapeFlag:O,transition:A,dirs:N}=h;if(I=h.el=a(h.type,B,R&&R.is,R),O&8?c(I,h.children):O&16&&Z(h.children,I,null,C,S,bi(h,B),T,P),N&&pe(h,null,C,"created"),$(I,h,h.scopeId,T,C),R){for(const W in R)W!=="value"&&!rs(W)&&n(I,W,null,R[W],B,h.children,C,S,Gt);"value"in R&&n(I,"value",null,R.value,B),(b=R.onVnodeBeforeMount)&&Ot(b,C,h)}N&&pe(h,null,C,"beforeMount");const j=Zu(S,A);j&&A.beforeEnter(I),i(I,d,m),((b=R&&R.onVnodeMounted)||j||N)&&pt(()=>{b&&Ot(b,C,h),j&&A.enter(I),N&&pe(h,null,C,"mounted")},S)},$=(h,d,m,C,S)=>{if(m&&f(h,m),C)for(let B=0;B<C.length;B++)f(h,C[B]);if(S){let B=S.subTree;if(d===B){const T=S.vnode;$(h,T,T.scopeId,T.slotScopeIds,S.parent)}}},Z=(h,d,m,C,S,B,T,P,I=0)=>{for(let b=I;b<h.length;b++){const R=h[b]=P?ee(h[b]):Nt(h[b]);x(null,R,d,m,C,S,B,T,P)}},X=(h,d,m,C,S,B,T)=>{const P=d.el=h.el;let{patchFlag:I,dynamicChildren:b,dirs:R}=d;I|=h.patchFlag&16;const O=h.props||tt,A=d.props||tt;let N;if(m&&me(m,!1),(N=A.onVnodeBeforeUpdate)&&Ot(N,m,d,h),R&&pe(d,h,m,"beforeUpdate"),m&&me(m,!0),b?Y(h.dynamicChildren,b,P,m,C,bi(d,S),B):T||q(h,d,P,null,m,C,bi(d,S),B,!1),I>0){if(I&16)ct(P,d,O,A,m,C,S);else if(I&2&&O.class!==A.class&&n(P,"class",null,A.class,S),I&4&&n(P,"style",O.style,A.style,S),I&8){const j=d.dynamicProps;for(let W=0;W<j.length;W++){const Q=j[W],rt=O[Q],Bt=A[Q];(Bt!==rt||Q==="value")&&n(P,Q,rt,Bt,S,h.children,m,C,Gt)}}I&1&&h.children!==d.children&&c(P,d.children)}else!T&&b==null&&ct(P,d,O,A,m,C,S);((N=A.onVnodeUpdated)||R)&&pt(()=>{N&&Ot(N,m,d,h),R&&pe(d,h,m,"updated")},C)},Y=(h,d,m,C,S,B,T)=>{for(let P=0;P<d.length;P++){const I=h[P],b=d[P],R=I.el&&(I.type===Ht||!Je(I,b)||I.shapeFlag&70)?g(I.el):m;x(I,b,R,null,C,S,B,T,!0)}},ct=(h,d,m,C,S,B,T)=>{if(m!==C){if(m!==tt)for(const P in m)!rs(P)&&!(P in C)&&n(h,P,m[P],null,T,d.children,S,B,Gt);for(const P in C){if(rs(P))continue;const I=C[P],b=m[P];I!==b&&P!=="value"&&n(h,P,b,I,T,d.children,S,B,Gt)}"value"in C&&n(h,"value",m.value,C.value,T)}},Dt=(h,d,m,C,S,B,T,P,I)=>{const b=d.el=h?h.el:o(""),R=d.anchor=h?h.anchor:o("");let{patchFlag:O,dynamicChildren:A,slotScopeIds:N}=d;N&&(P=P?P.concat(N):N),h==null?(i(b,m,C),i(R,m,C),Z(d.children||[],m,R,S,B,T,P,I)):O>0&&O&64&&A&&h.dynamicChildren?(Y(h.dynamicChildren,A,m,S,B,T,P),(d.key!=null||S&&d===S.subTree)&&bo(h,d,!0)):q(h,d,m,R,S,B,T,P,I)},we=(h,d,m,C,S,B,T,P,I)=>{d.slotScopeIds=P,h==null?d.shapeFlag&512?S.ctx.activate(d,m,C,T,I):_i(d,m,C,S,B,T,I):kr(h,d,I)},_i=(h,d,m,C,S,B,T)=>{const P=h.component=gc(h,C,S);if(oo(h)&&(P.ctx.renderer=Ye),dc(P),P.asyncDep){if(S&&S.registerDep(P,ht),!h.el){const I=P.subTree=Be(_s);v(null,I,d,m)}}else ht(P,h,d,m,S,B,T)},kr=(h,d,m)=>{const C=d.component=h.component;if(pu(h,d,m))if(C.asyncDep&&!C.asyncResolved){et(C,d,m);return}else C.next=d,uu(C.update),C.effect.dirty=!0,C.update();else d.el=h.el,C.vnode=d},ht=(h,d,m,C,S,B,T)=>{const P=()=>{if(h.isMounted){let{next:R,bu:O,u:A,parent:N,vnode:j}=h;{const Te=Mo(h);if(Te){R&&(R.el=j.el,et(h,R,T)),Te.asyncDep.then(()=>{h.isUnmounted||P()});return}}let W=R,Q;me(h,!1),R?(R.el=j.el,et(h,R,T)):R=j,O&&yi(O),(Q=R.props&&R.props.onVnodeBeforeUpdate)&&Ot(Q,N,R,j),me(h,!0);const rt=xi(h),Bt=h.subTree;h.subTree=rt,x(Bt,rt,g(Bt.el),Ps(Bt),h,S,B),R.el=rt.el,W===null&&mu(h,rt.el),A&&pt(A,S),(Q=R.props&&R.props.onVnodeUpdated)&&pt(()=>Ot(Q,N,R,j),S)}else{let R;const{el:O,props:A}=d,{bm:N,m:j,parent:W}=h,Q=zs(d);if(me(h,!1),N&&yi(N),!Q&&(R=A&&A.onVnodeBeforeMount)&&Ot(R,W,d),me(h,!0),O&&jr){const rt=()=>{h.subTree=xi(h),jr(O,h.subTree,h,S,null)};Q?d.type.__asyncLoader().then(()=>!h.isUnmounted&&rt()):rt()}else{const rt=h.subTree=xi(h);x(null,rt,m,C,h,S,B),d.el=rt.el}if(j&&pt(j,S),!Q&&(R=A&&A.onVnodeMounted)){const rt=d;pt(()=>Ot(R,W,rt),S)}(d.shapeFlag&256||W&&zs(W.vnode)&&W.vnode.shapeFlag&256)&&h.a&&pt(h.a,S),h.isMounted=!0,d=m=C=null}},I=h.effect=new mr(P,vt,()=>Br(b),h.scope),b=h.update=()=>{I.dirty&&I.run()};b.id=h.uid,me(h,!0),b()},et=(h,d,m)=>{d.component=h;const C=h.vnode.props;h.vnode=d,h.next=null,Hu(h,d.props,C,m),qu(h,d.children,m),ge(),tn(h),de()},q=(h,d,m,C,S,B,T,P,I=!1)=>{const b=h&&h.children,R=h?h.shapeFlag:0,O=d.children,{patchFlag:A,shapeFlag:N}=d;if(A>0){if(A&128){vs(b,O,m,C,S,B,T,P,I);return}else if(A&256){fe(b,O,m,C,S,B,T,P,I);return}}N&8?(R&16&&Gt(b,S,B),O!==b&&c(m,O)):R&16?N&16?vs(b,O,m,C,S,B,T,P,I):Gt(b,S,B,!0):(R&8&&c(m,""),N&16&&Z(O,m,C,S,B,T,P,I))},fe=(h,d,m,C,S,B,T,P,I)=>{h=h||Ne,d=d||Ne;const b=h.length,R=d.length,O=Math.min(b,R);let A;for(A=0;A<O;A++){const N=d[A]=I?ee(d[A]):Nt(d[A]);x(h[A],N,m,null,S,B,T,P,I)}b>R?Gt(h,S,B,!0,!1,O):Z(d,m,C,S,B,T,P,I,O)},vs=(h,d,m,C,S,B,T,P,I)=>{let b=0;const R=d.length;let O=h.length-1,A=R-1;for(;b<=O&&b<=A;){const N=h[b],j=d[b]=I?ee(d[b]):Nt(d[b]);if(Je(N,j))x(N,j,m,null,S,B,T,P,I);else break;b++}for(;b<=O&&b<=A;){const N=h[O],j=d[A]=I?ee(d[A]):Nt(d[A]);if(Je(N,j))x(N,j,m,null,S,B,T,P,I);else break;O--,A--}if(b>O){if(b<=A){const N=A+1,j=N<R?d[N].el:C;for(;b<=A;)x(null,d[b]=I?ee(d[b]):Nt(d[b]),m,j,S,B,T,P,I),b++}}else if(b>A)for(;b<=O;)At(h[b],S,B,!0),b++;else{const N=b,j=b,W=new Map;for(b=j;b<=A;b++){const Ct=d[b]=I?ee(d[b]):Nt(d[b]);Ct.key!=null&&W.set(Ct.key,b)}let Q,rt=0;const Bt=A-j+1;let Te=!1,Xr=0;const qe=new Array(Bt);for(b=0;b<Bt;b++)qe[b]=0;for(b=N;b<=O;b++){const Ct=h[b];if(rt>=Bt){At(Ct,S,B,!0);continue}let Lt;if(Ct.key!=null)Lt=W.get(Ct.key);else for(Q=j;Q<=A;Q++)if(qe[Q-j]===0&&Je(Ct,d[Q])){Lt=Q;break}Lt===void 0?At(Ct,S,B,!0):(qe[Lt-j]=b+1,Lt>=Xr?Xr=Lt:Te=!0,x(Ct,d[Lt],m,null,S,B,T,P,I),rt++)}const Gr=Te?Qu(qe):Ne;for(Q=Gr.length-1,b=Bt-1;b>=0;b--){const Ct=j+b,Lt=d[Ct],$r=Ct+1<R?d[Ct+1].el:C;qe[b]===0?x(null,Lt,m,$r,S,B,T,P,I):Te&&(Q<0||b!==Gr[Q]?_e(Lt,m,$r,2):Q--)}}},_e=(h,d,m,C,S=null)=>{const{el:B,type:T,transition:P,children:I,shapeFlag:b}=h;if(b&6){_e(h.component.subTree,d,m,C);return}if(b&128){h.suspense.move(d,m,C);return}if(b&64){T.move(h,d,m,Ye);return}if(T===Ht){i(B,d,m);for(let O=0;O<I.length;O++)_e(I[O],d,m,C);i(h.anchor,d,m);return}if(T===Mi){V(h,d,m);return}if(C!==2&&b&1&&P)if(C===0)P.beforeEnter(B),i(B,d,m),pt(()=>P.enter(B),S);else{const{leave:O,delayLeave:A,afterLeave:N}=P,j=()=>i(B,d,m),W=()=>{O(B,()=>{j(),N&&N()})};A?A(B,j,W):W()}else i(B,d,m)},At=(h,d,m,C=!1,S=!1)=>{const{type:B,props:T,ref:P,children:I,dynamicChildren:b,shapeFlag:R,patchFlag:O,dirs:A}=h;if(P!=null&&Wi(P,null,m,h,!0),R&256){d.ctx.deactivate(h);return}const N=R&1&&A,j=!zs(h);let W;if(j&&(W=T&&T.onVnodeBeforeUnmount)&&Ot(W,d,h),R&6)dl(h.component,m,C);else{if(R&128){h.suspense.unmount(m,C);return}N&&pe(h,null,d,"beforeUnmount"),R&64?h.type.remove(h,d,m,S,Ye,C):b&&(B!==Ht||O>0&&O&64)?Gt(b,d,m,!1,!0):(B===Ht&&O&384||!S&&R&16)&&Gt(I,d,m),C&&Nr(h)}(j&&(W=T&&T.onVnodeUnmounted)||N)&&pt(()=>{W&&Ot(W,d,h),N&&pe(h,null,d,"unmounted")},m)},Nr=h=>{const{type:d,el:m,anchor:C,transition:S}=h;if(d===Ht){gl(m,C);return}if(d===Mi){E(h);return}const B=()=>{r(m),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(h.shapeFlag&1&&S&&!S.persisted){const{leave:T,delayLeave:P}=S,I=()=>T(m,B);P?P(h.el,B,I):I()}else B()},gl=(h,d)=>{let m;for(;h!==d;)m=p(h),r(h),h=m;r(d)},dl=(h,d,m)=>{const{bum:C,scope:S,update:B,subTree:T,um:P}=h;C&&yi(C),S.stop(),B&&(B.active=!1,At(T,h,d,m)),P&&pt(P,d),pt(()=>{h.isUnmounted=!0},d),d&&d.pendingBranch&&!d.isUnmounted&&h.asyncDep&&!h.asyncResolved&&h.suspenseId===d.pendingId&&(d.deps--,d.deps===0&&d.resolve())},Gt=(h,d,m,C=!1,S=!1,B=0)=>{for(let T=B;T<h.length;T++)At(h[T],d,m,C,S)},Ps=h=>h.shapeFlag&6?Ps(h.component.subTree):h.shapeFlag&128?h.suspense.next():p(h.anchor||h.el);let pi=!1;const Ur=(h,d,m)=>{h==null?d._vnode&&At(d._vnode,null,null,!0):x(d._vnode||null,h,d,null,null,null,m),pi||(pi=!0,tn(),eo(),pi=!1),d._vnode=h},Ye={p:x,um:At,m:_e,r:Nr,mt:_i,mc:Z,pc:q,pbc:Y,n:Ps,o:e};let zr,jr;return{render:Ur,hydrate:zr,createApp:Xu(Ur,zr)}}function bi({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function me({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function Zu(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function bo(e,t,s=!1){const i=e.children,r=t.children;if(U(i)&&U(r))for(let n=0;n<i.length;n++){const a=i[n];let o=r[n];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=r[n]=ee(r[n]),o.el=a.el),s||bo(a,o)),o.type===ui&&(o.el=a.el)}}function Qu(e){const t=e.slice(),s=[0];let i,r,n,a,o;const l=e.length;for(i=0;i<l;i++){const u=e[i];if(u!==0){if(r=s[s.length-1],e[r]<u){t[i]=r,s.push(i);continue}for(n=0,a=s.length-1;n<a;)o=n+a>>1,e[s[o]]<u?n=o+1:a=o;u<e[s[n]]&&(n>0&&(t[i]=s[n-1]),s[n]=i)}}for(n=s.length,a=s[n-1];n-- >0;)s[n]=a,a=t[a];return s}function Mo(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Mo(t)}const tc=e=>e.__isTeleport,Ht=Symbol.for("v-fgt"),ui=Symbol.for("v-txt"),_s=Symbol.for("v-cmt"),Mi=Symbol.for("v-stc"),ls=[];let Rt=null;function ec(e=!1){ls.push(Rt=e?null:[])}function sc(){ls.pop(),Rt=ls[ls.length-1]||null}let ps=1;function hn(e){ps+=e}function ic(e){return e.dynamicChildren=ps>0?Rt||Ne:null,sc(),ps>0&&Rt&&Rt.push(e),e}function rc(e,t,s,i,r,n){return ic(Po(e,t,s,i,r,n,!0))}function nc(e){return e?e.__v_isVNode===!0:!1}function Je(e,t){return e.type===t.type&&e.key===t.key}const vo=({key:e})=>e??null,Xs=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?ot(e)||xt(e)||z(e)?{i:jt,r:e,k:t,f:!!s}:e:null);function Po(e,t=null,s=null,i=0,r=null,n=e===Ht?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&vo(t),ref:t&&Xs(t),scopeId:ro,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:jt};return o?(wr(l,s),n&128&&e.normalize(l)):s&&(l.shapeFlag|=ot(s)?8:16),ps>0&&!a&&Rt&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Rt.push(l),l}const Be=ac;function ac(e,t=null,s=null,i=0,r=null,n=!1){if((!e||e===yu)&&(e=_s),nc(e)){const o=$e(e,t,!0);return s&&wr(o,s),ps>0&&!n&&Rt&&(o.shapeFlag&6?Rt[Rt.indexOf(e)]=o:Rt.push(o)),o.patchFlag|=-2,o}if(mc(e)&&(e=e.__vccOpts),t){t=oc(t);let{class:o,style:l}=t;o&&!ot(o)&&(t.class=pr(o)),it(l)&&(Ya(l)&&!U(l)&&(l=nt({},l)),t.style=_r(l))}const a=ot(e)?1:xu(e)?128:tc(e)?64:it(e)?4:z(e)?2:0;return Po(e,t,s,i,r,a,n,!0)}function oc(e){return e?Ya(e)||po(e)?nt({},e):e:null}function $e(e,t,s=!1,i=!1){const{props:r,ref:n,patchFlag:a,children:o,transition:l}=e,u=t?uc(r||{},t):r,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&vo(u),ref:t&&t.ref?s&&n?U(n)?n.concat(Xs(t)):[n,Xs(t)]:Xs(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ht?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&$e(e.ssContent),ssFallback:e.ssFallback&&$e(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&(c.transition=l.clone(c)),c}function lc(e=" ",t=0){return Be(ui,null,e,t)}function Nt(e){return e==null||typeof e=="boolean"?Be(_s):U(e)?Be(Ht,null,e.slice()):typeof e=="object"?ee(e):Be(ui,null,String(e))}function ee(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:$e(e)}function wr(e,t){let s=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(U(t))s=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),wr(e,r()),r._c&&(r._d=!0));return}else{s=32;const r=t._;!r&&!po(t)?t._ctx=jt:r===3&&jt&&(jt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else z(t)?(t={default:t,_ctx:jt},s=32):(t=String(t),i&64?(s=16,t=[lc(t)]):s=8);e.children=t,e.shapeFlag|=s}function uc(...e){const t={};for(let s=0;s<e.length;s++){const i=e[s];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=pr([t.class,i.class]));else if(r==="style")t.style=_r([t.style,i.style]);else if(si(r)){const n=t[r],a=i[r];a&&n!==a&&!(U(n)&&n.includes(a))&&(t[r]=n?[].concat(n,a):a)}else r!==""&&(t[r]=i[r])}return t}function Ot(e,t,s,i=null){Ft(e,t,7,[s,i])}const cc=go();let hc=0;function gc(e,t,s){const i=e.type,r=(t?t.appContext:e.appContext)||cc,n={uid:hc++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new El(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yo(i,r),emitsOptions:io(i,r),emit:null,emitted:null,propsDefaults:tt,inheritAttrs:i.inheritAttrs,ctx:tt,data:tt,props:tt,attrs:tt,slots:tt,refs:tt,setupState:tt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=gu.bind(null,n),e.ce&&e.ce(n),n}let _t=null,qs,Yi;{const e=Da(),t=(s,i)=>{let r;return(r=e[s])||(r=e[s]=[]),r.push(i),n=>{r.length>1?r.forEach(a=>a(n)):r[0](n)}};qs=t("__VUE_INSTANCE_SETTERS__",s=>_t=s),Yi=t("__VUE_SSR_SETTERS__",s=>ci=s)}const Ms=e=>{const t=_t;return qs(e),e.scope.on(),()=>{e.scope.off(),qs(t)}},gn=()=>{_t&&_t.scope.off(),qs(null)};function Bo(e){return e.vnode.shapeFlag&4}let ci=!1;function dc(e,t=!1){t&&Yi(t);const{props:s,children:i}=e.vnode,r=Bo(e);$u(e,s,r,t),Yu(e,i);const n=r?fc(e,t):void 0;return t&&Yi(!1),n}function fc(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Lu);const{setup:i}=s;if(i){const r=e.setupContext=i.length>1?pc(e):null,n=Ms(e);ge();const a=le(i,e,0,[e.props,r]);if(de(),n(),Ea(a)){if(a.then(gn,gn),t)return a.then(o=>{dn(e,o,t)}).catch(o=>{ai(o,e,0)});e.asyncDep=a}else dn(e,a,t)}else Io(e,t)}function dn(e,t,s){z(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:it(t)&&(e.setupState=Za(t)),Io(e,s)}let fn;function Io(e,t,s){const i=e.type;if(!e.render){if(!t&&fn&&!i.render){const r=i.template||Ir(e).template;if(r){const{isCustomElement:n,compilerOptions:a}=e.appContext.config,{delimiters:o,compilerOptions:l}=i,u=nt(nt({isCustomElement:n,delimiters:o},a),l);i.render=fn(r,u)}}e.render=i.render||vt}{const r=Ms(e);ge();try{Ou(e)}finally{de(),r()}}}const _c={get(e,t){return yt(e,"get",""),e[t]}};function pc(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,_c),slots:e.slots,emit:e.emit,expose:t}}function Tr(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Za(qa(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in as)return as[s](e)},has(t,s){return s in t||s in as}}))}function mc(e){return z(e)&&"__vccOpts"in e}const yc=(e,t)=>tu(e,t,ci),xc="3.4.27";/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Cc="http://www.w3.org/2000/svg",Sc="http://www.w3.org/1998/Math/MathML",se=typeof document<"u"?document:null,_n=se&&se.createElement("template"),bc={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,i)=>{const r=t==="svg"?se.createElementNS(Cc,e):t==="mathml"?se.createElementNS(Sc,e):se.createElement(e,s?{is:s}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>se.createTextNode(e),createComment:e=>se.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>se.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,i,r,n){const a=s?s.previousSibling:t.lastChild;if(r&&(r===n||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),s),!(r===n||!(r=r.nextSibling)););else{_n.innerHTML=i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e;const o=_n.content;if(i==="svg"||i==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,s)}return[a?a.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},Mc=Symbol("_vtc");function vc(e,t,s){const i=e[Mc];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const pn=Symbol("_vod"),Pc=Symbol("_vsh"),Bc=Symbol(""),Ic=/(^|;)\s*display\s*:/;function Vc(e,t,s){const i=e.style,r=ot(s);let n=!1;if(s&&!r){if(t)if(ot(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();s[o]==null&&Gs(i,o,"")}else for(const a in t)s[a]==null&&Gs(i,a,"");for(const a in s)a==="display"&&(n=!0),Gs(i,a,s[a])}else if(r){if(t!==s){const a=i[Bc];a&&(s+=";"+a),i.cssText=s,n=Ic.test(s)}}else t&&e.removeAttribute("style");pn in e&&(e[pn]=n?i.display:"",e[Pc]&&(i.display="none"))}const mn=/\s*!important$/;function Gs(e,t,s){if(U(s))s.forEach(i=>Gs(e,t,i));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const i=wc(e,t);mn.test(s)?e.setProperty(We(i),s.replace(mn,""),"important"):e[i]=s}}const yn=["Webkit","Moz","ms"],vi={};function wc(e,t){const s=vi[t];if(s)return s;let i=Ge(t);if(i!=="filter"&&i in e)return vi[t]=i;i=Ra(i);for(let r=0;r<yn.length;r++){const n=yn[r]+i;if(n in e)return vi[t]=n}return t}const xn="http://www.w3.org/1999/xlink";function Tc(e,t,s,i,r){if(i&&t.startsWith("xlink:"))s==null?e.removeAttributeNS(xn,t.slice(6,t.length)):e.setAttributeNS(xn,t,s);else{const n=Tl(t);s==null||n&&!Aa(s)?e.removeAttribute(t):e.setAttribute(t,n?"":s)}}function Ec(e,t,s,i,r,n,a){if(t==="innerHTML"||t==="textContent"){i&&a(i,r,n),e[t]=s??"";return}const o=e.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){const u=o==="OPTION"?e.getAttribute("value")||"":e.value,c=s??"";(u!==c||!("_value"in e))&&(e.value=c),s==null&&e.removeAttribute(t),e._value=s;return}let l=!1;if(s===""||s==null){const u=typeof e[t];u==="boolean"?s=Aa(s):s==null&&u==="string"?(s="",l=!0):u==="number"&&(s=0,l=!0)}try{e[t]=s}catch{}l&&e.removeAttribute(t)}function Rc(e,t,s,i){e.addEventListener(t,s,i)}function Fc(e,t,s,i){e.removeEventListener(t,s,i)}const Cn=Symbol("_vei");function Dc(e,t,s,i,r=null){const n=e[Cn]||(e[Cn]={}),a=n[t];if(i&&a)a.value=i;else{const[o,l]=Ac(t);if(i){const u=n[t]=kc(i,r);Rc(e,o,u,l)}else a&&(Fc(e,o,a,l),n[t]=void 0)}}const Sn=/(?:Once|Passive|Capture)$/;function Ac(e){let t;if(Sn.test(e)){t={};let i;for(;i=e.match(Sn);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):We(e.slice(2)),t]}let Pi=0;const Lc=Promise.resolve(),Oc=()=>Pi||(Lc.then(()=>Pi=0),Pi=Date.now());function kc(e,t){const s=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=s.attached)return;Ft(Nc(i,s.value),t,5,[i])};return s.value=e,s.attached=Oc(),s}function Nc(e,t){if(U(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const bn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Uc=(e,t,s,i,r,n,a,o,l)=>{const u=r==="svg";t==="class"?vc(e,i,u):t==="style"?Vc(e,s,i):si(t)?gr(t)||Dc(e,t,s,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):zc(e,t,i,u))?Ec(e,t,i,n,a,o,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Tc(e,t,i,u))};function zc(e,t,s,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&bn(t)&&z(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return bn(t)&&ot(s)?!1:t in e}const jc=nt({patchProp:Uc},bc);let Mn;function Xc(){return Mn||(Mn=Ju(jc))}const Gc=(...e)=>{const t=Xc().createApp(...e),{mount:s}=t;return t.mount=i=>{const r=Hc(i);if(!r)return;const n=t._component;!z(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.innerHTML="";const a=s(r,!1,$c(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t};function $c(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Hc(e){return ot(e)?document.querySelector(e):e}class Vo{constructor(){gt(this,"angleX",0);gt(this,"angleY",0);gt(this,"angleZ",0);gt(this,"angleEyeX",0);gt(this,"angleEyeY",0);gt(this,"mouseDistance",0);gt(this,"autoBlink",!1)}}const us=class us{constructor(t=0){t<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(t),this._capacity=t,this._size=0)}at(t){return this._ptr[t]}set(t,s){this._ptr[t]=s}get(t=0){const s=new Array;for(let i=t;i<this._size;i++)s.push(this._ptr[i]);return s}pushBack(t){this._size>=this._capacity&&this.prepareCapacity(this._capacity==0?us.DefaultSize:this._capacity*2),this._ptr[this._size++]=t}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(t,s){this._size<t&&this.prepareCapacity(t);for(let r=0;r<t;r++)this._ptr[r]=s;this._size=t}resize(t,s=null){this.updateSize(t,s,!0)}updateSize(t,s=null,i=!0){if(this._size<t)if(this.prepareCapacity(t),i)for(let n=this._size;n<t;n++)typeof s=="function"?this._ptr[n]=JSON.parse(JSON.stringify(new s)):this._ptr[n]=s;else for(let n=this._size;n<t;n++)this._ptr[n]=s;else{const n=this._size-t;this._ptr.splice(this._size-n,n)}this._size=t}insert(t,s,i){let r=t._index;const n=s._index,a=i._index,o=a-n;this.prepareCapacity(this._size+o);const l=this._size-r;if(l>0)for(let u=0;u<l;u++)this._ptr.splice(r+u,0,null);for(let u=n;u<a;u++,r++)this._ptr[r]=s._vector._ptr[u];this._size=this._size+o}remove(t){return t<0||this._size<=t?!1:(this._ptr.splice(t,1),--this._size,!0)}erase(t){const s=t._index;return s<0||this._size<=s?t:(this._ptr.splice(s,1),--this._size,new $s(this,s))}prepareCapacity(t){t>this._capacity&&(this._capacity==0?(this._ptr=new Array(t),this._capacity=t):(this._ptr.length=t,this._capacity=t))}begin(){return this._size==0?this.end():new $s(this,0)}end(){return new $s(this,this._size)}getOffset(t){const s=new us;return s._ptr=this.get(t),s._size=this.get(t).length,s._capacity=this.get(t).length,s}};us.DefaultSize=10;let L=us,$s=class qi{constructor(t,s){this._vector=t??null,this._index=s??0}set(t){return this._index=t._index,this._vector=t._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new qi(this._vector,this._index++)}decrement(){return new qi(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(t){return this._index=t._index,this._vector=t._vector,this}notEqual(t){return this._index!=t._index||this._vector!=t._vector}};var Ji;(e=>{e.csmVector=L,e.iterator=$s})(Ji||(Ji={}));class Pt{append(t,s){return this.s+=s!==void 0?t.substr(0,s):t,this}expansion(t,s){for(let i=0;i<t;i++)this.append(s);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(t){return this.s<t.s}isGreat(t){return this.s>t.s}isEqual(t){return this.s==t}isEmpty(){return this.s.length==0}constructor(t){this.s=t}}var vn;(e=>{e.csmString=Pt})(vn||(vn={}));class ze{static createIdInternal(t){return new ze(t)}getString(){return this._id}isEqual(t){return typeof t=="string"?this._id.isEqual(t):t instanceof Pt?this._id.isEqual(t.s):t instanceof ze?this._id.isEqual(t._id.s):!1}isNotEqual(t){return typeof t=="string"?!this._id.isEqual(t):t instanceof Pt?!this._id.isEqual(t.s):t instanceof ze?!this._id.isEqual(t._id.s):!1}constructor(t){if(typeof t=="string"){this._id=new Pt(t);return}this._id=t}}var Pn;(e=>{e.CubismId=ze})(Pn||(Pn={}));class wo{constructor(){this._ids=new L}release(){for(let t=0;t<this._ids.getSize();++t)this._ids.set(t,void 0);this._ids=null}registerIds(t){for(let s=0;s<t.length;s++)this.registerId(t[s])}registerId(t){let s=null;if(typeof t=="string"){if((s=this.findId(t))!=null)return s;s=ze.createIdInternal(t),this._ids.pushBack(s)}else return this.registerId(t.s);return s}getId(t){return this.registerId(t)}isExist(t){return typeof t=="string"?this.findId(t)!=null:this.isExist(t.s)}findId(t){for(let s=0;s<this._ids.getSize();++s)if(this._ids.at(s).getString().isEqual(t))return this._ids.at(s);return null}}var Bn;(e=>{e.CubismIdManager=wo})(Bn||(Bn={}));let ue=class es{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,s,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=4;for(let a=0;a<n;++a)for(let o=0;o<n;++o)for(let l=0;l<n;++l)r[o+a*4]+=t[l+a*4]*s[o+l*4];for(let a=0;a<16;++a)i[a]=r[a]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let s=0;s<16;++s)this._tr[s]=t[s]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,s){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,s,0,1]);es.multiply(i,this._tr,this._tr)}translate(t,s){this._tr[12]=t,this._tr[13]=s}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,s){const i=new Float32Array([t,0,0,0,0,s,0,0,0,0,1,0,0,0,0,1]);es.multiply(i,this._tr,this._tr)}scale(t,s){this._tr[0]=t,this._tr[5]=s}multiplyByMatrix(t){es.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new es;for(let s=0;s<this._tr.length;s++)t._tr[s]=this._tr[s];return t}};var Ki;(e=>{e.CubismMatrix44=ue})(Ki||(Ki={}));class Js{constructor(t,s,i,r){this.x=t,this.y=s,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,s){this.x-=t,this.y-=s,this.width+=t*2,this.height+=s*2}}var In;(e=>{e.csmRect=Js})(In||(In={}));class hi{static create(){return null}static delete(t){}initialize(t){this._model=t}drawModel(){this.getModel()!=null&&(this.saveProfile(),this.doDrawModel(),this.restoreProfile())}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,s,i,r){t<0?t=0:t>1&&(t=1),s<0?s=0:s>1&&(s=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.r=t,this._modelColor.g=s,this._modelColor.b=i,this._modelColor.a=r}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}getModelColorWithOpacity(t){const s=this.getModelColor();return s.a*=t,this.isPremultipliedAlpha()&&(s.r*=s.a,s.g*=s.a,s.b*=s.a),s}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisotropy=t}getAnisotropy(){return this._anisotropy}getModel(){return this._model}useHighPrecisionMask(t){this._useHighPrecisionMask=t}isUsingHighPrecisionMask(){return this._useHighPrecisionMask}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisotropy=0,this._model=null,this._modelColor=new mt,this._useHighPrecisionMask=!1,this._mvpMatrix4x4=new ue,this._mvpMatrix4x4.loadIdentity()}}var ce=(e=>(e[e.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",e[e.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",e[e.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",e))(ce||{});class mt{constructor(t=1,s=1,i=1,r=1){this.r=t,this.g=s,this.b=i,this.a=r}}class Wc{constructor(t,s){this._clippingIdList=t,this._clippingIdCount=s,this._allClippedDrawRect=new Js,this._layoutBounds=new Js,this._clippedDrawableIndexList=[],this._matrixForMask=new ue,this._matrixForDraw=new ue,this._bufferIndex=0}release(){this._layoutBounds!=null&&(this._layoutBounds=null),this._allClippedDrawRect!=null&&(this._allClippedDrawRect=null),this._clippedDrawableIndexList!=null&&(this._clippedDrawableIndexList=null)}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}}var Vn;(e=>{e.CubismBlendMode=ce,e.CubismRenderer=hi,e.CubismTextureColor=mt})(Vn||(Vn={}));const Yc=(e,t,s)=>{Er.print(e,"[CSM]"+t,s)},Rs=(e,t,s)=>{Yc(e,t+`
`,s)},zt=e=>{console.assert(e)};let ms,re,ne,st;ms=(e,...t)=>{Rs(Le.LogLevel_Debug,"[D]"+e,t)},re=(e,...t)=>{Rs(Le.LogLevel_Info,"[I]"+e,t)},ne=(e,...t)=>{Rs(Le.LogLevel_Warning,"[W]"+e,t)},st=(e,...t)=>{Rs(Le.LogLevel_Error,"[E]"+e,t)};class Er{static print(t,s,i){if(t<J.getLoggingLevel())return;const r=J.coreLogFunction;if(!r)return;const n=s.replace(/\{(\d+)\}/g,(a,o)=>i[o]);r(n)}static dumpBytes(t,s,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(t,`
`):r%8==0&&r>0&&this.print(t,"  "),this.print(t,"{0} ",[s[r]&255]);this.print(t,`
`)}constructor(){}}var wn;(e=>{e.CubismDebug=Er})(wn||(wn={}));class To{constructor(t,s){this.first=t??null,this.second=s??null}}const cs=class cs{constructor(t){t!=null?t<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(t),this._size=t):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(t){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new To(t),this._size+=1}getValue(t){let s=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){s=i;break}return s>=0?this._keyValues[s].second:(this.appendKey(t),this._keyValues[this._size-1].second)}setValue(t,s){let i=-1;for(let r=0;r<this._size;r++)if(this._keyValues[r].first==t){i=r;break}i>=0?this._keyValues[i].second=s:(this.appendKey(t),this._keyValues[this._size-1].second=s)}isExist(t){for(let s=0;s<this._size;s++)if(this._keyValues[s].first==t)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(t,s){t>this._keyValues.length&&(this._keyValues.length==0?(!s&&t<cs.DefaultSize&&(t=cs.DefaultSize),this._keyValues.length=t):(!s&&t<this._keyValues.length*2&&(t=this._keyValues.length*2),this._keyValues.length=t))}begin(){return new Ie(this,0)}end(){return new Ie(this,this._size)}erase(t){const s=t._index;return s<0||this._size<=s?t:(this._keyValues.splice(s,1),--this._size,new Ie(this,s))}dumpAsInt(){for(let t=0;t<this._size;t++)ms("{0} ,",this._keyValues[t]),ms(`
`)}};cs.DefaultSize=10;let Xt=cs;class Ie{constructor(t,s){this._map=t??new Xt,this._index=s??0}set(t){return this._index=t._index,this._map=t._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new Ie(this._map,this._index++)}decrement(){const t=new Ie(this._map,this._index);return this._map=t._map,this._index=t._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(t){return this._index!=t._index||this._map!=t._map}}var Tn;(e=>{e.csmMap=Xt,e.csmPair=To,e.iterator=Ie})(Tn||(Tn={}));class Ks{static parseJsonObject(t,s){return Object.keys(t).forEach(i=>{if(typeof t[i]=="boolean"){const r=!!t[i];s.put(i,new Et(r))}else if(typeof t[i]=="string"){const r=String(t[i]);s.put(i,new He(r))}else if(typeof t[i]=="number"){const r=Number(t[i]);s.put(i,new Qs(r))}else t[i]instanceof Array?s.put(i,Ks.parseJsonArray(t[i])):t[i]instanceof Object?s.put(i,Ks.parseJsonObject(t[i],new Xe)):t[i]==null?s.put(i,new je):s.put(i,t[i])}),s}static parseJsonArray(t){const s=new Rr;return Object.keys(t).forEach(i=>{if(typeof Number(i)=="number")if(typeof t[i]=="boolean"){const n=!!t[i];s.add(new Et(n))}else if(typeof t[i]=="string"){const n=String(t[i]);s.add(new He(n))}else if(typeof t[i]=="number"){const n=Number(t[i]);s.add(new Qs(n))}else t[i]instanceof Array?s.add(this.parseJsonArray(t[i])):t[i]instanceof Object?s.add(this.parseJsonObject(t[i],new Xe)):t[i]==null?s.add(new je):s.add(t[i]);else if(t[i]instanceof Array)s.add(this.parseJsonArray(t[i]));else if(t[i]instanceof Object)s.add(this.parseJsonObject(t[i],new Xe));else if(t[i]==null)s.add(new je);else{const n=Array(t[i]);for(let a=0;a<n.length;a++)s.add(n[a])}}),s}}const Zs="Error: type mismatch",qc="Error: index out of bounds";let ut=class kt{constructor(){}getRawString(t,s){return this.getString(t,s)}toInt(t=0){return t}toFloat(t=0){return t}toBoolean(t=!1){return t}getSize(){return 0}getArray(t=null){return t}getVector(t=new L){return t}getMap(t){return t}getValueByIndex(t){return kt.errorValue.setErrorNotForClientCall(Zs)}getValueByString(t){return kt.nullValue.setErrorNotForClientCall(Zs)}getKeys(){return kt.dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(t){return!1}isStatic(){return!1}setErrorNotForClientCall(t){return ys.errorValue}static staticInitializeNotForClientCall(){Et.trueValue=new Et(!0),Et.falseValue=new Et(!1),kt.errorValue=new ys("ERROR",!0),kt.nullValue=new je,kt.dummyKeys=new L}static staticReleaseNotForClientCall(){Et.trueValue=null,Et.falseValue=null,kt.errorValue=null,kt.nullValue=null,kt.dummyKeys=null}};class at{constructor(t,s){this._parseCallback=Ks.parseJsonObject,this._error=null,this._lineCount=0,this._root=null,t!=null&&this.parseBytes(t,s,this._parseCallback)}static create(t,s){const i=new at;return i.parseBytes(t,s,i._parseCallback)?i:(at.delete(i),null)}static delete(t){}getRoot(){return this._root}static arrayBufferToString(t){const s=new Uint8Array(t);let i="";for(let r=0,n=s.length;r<n;++r)i+="%"+this.pad(s[r].toString(16));return i=decodeURIComponent(i),i}static pad(t){return t.length<2?"0"+t:t}parseBytes(t,s,i){const r=new Array(1),n=at.arrayBufferToString(t);if(i==null?this._root=this.parseValue(n,s,0,r):this._root=i(JSON.parse(n),new Xe),this._error){let a="\0";return a="Json parse error : @line "+(this._lineCount+1)+`
`,this._root=new He(a),re("{0}",this._root.getRawString()),!1}else if(this._root==null)return this._root=new ys(new Pt(this._error),!1),!1;return!0}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(t,s,i,r){if(this._error)return null;let n=null,a=i,o;for(;a<s;a++)switch(t[a]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const u=new Array(1);return o=Jc(t.slice(a),u),r[0]=t.indexOf(u[0]),new Qs(o)}case'"':return new He(this.parseString(t,s,a+1,r));case"[":return n=this.parseArray(t,s,a+1,r),n;case"{":return n=this.parseObject(t,s,a+1,r),n;case"n":return a+3<s?(n=new je,r[0]=a+4):this._error="parse null",n;case"t":return a+3<s?(n=Et.trueValue,r[0]=a+4):this._error="parse true",n;case"f":return a+4<s?(n=Et.falseValue,r[0]=a+5):this._error="illegal ',' position",n;case",":return this._error="illegal ',' position",null;case"]":return r[0]=a,null;case`
`:this._lineCount++}return this._error="illegal end of value",null}parseString(t,s,i,r){if(this._error)return null;if(!t)return this._error="string is null",null;let n=i,a,o;const l=new Pt("");let u=i;for(;n<s;n++)switch(a=t[n],a){case'"':return r[0]=n+1,l.append(t.slice(u),n-u),l.s;case"//":if(n++,n-1>u&&l.append(t.slice(u),n-u),u=n+1,n<s)switch(o=t[n],o){case"\\":l.expansion(1,"\\");break;case'"':l.expansion(1,'"');break;case"/":l.expansion(1,"/");break;case"b":l.expansion(1,"\b");break;case"f":l.expansion(1,"\f");break;case"n":l.expansion(1,`
`);break;case"r":l.expansion(1,"\r");break;case"t":l.expansion(1,"	");break;case"u":this._error="parse string/unicord escape not supported";break}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(t,s,i,r){if(this._error)return null;if(!t)return this._error="buffer is null",null;const n=new Xe;let a="",o=i,l="";const u=Array(1);let c=!1;for(;o<s;o++){t:for(;o<s;o++)switch(l=t[o],l){case'"':if(a=this.parseString(t,s,o+1,u),this._error)return null;o=u[0],c=!0;break t;case"}":return r[0]=o+1,n;case":":this._error="illegal ':' position";break;case`
`:this._lineCount++}if(!c)return this._error="key not found",null;c=!1;t:for(;o<s;o++)switch(l=t[o],l){case":":c=!0,o++;break t;case"}":this._error="illegal '}' position";break;case`
`:this._lineCount++}if(!c)return this._error="':' not found",null;const g=this.parseValue(t,s,o,u);if(this._error)return null;o=u[0],n.put(a,g);t:for(;o<s;o++)switch(l=t[o],l){case",":break t;case"}":return r[0]=o+1,n;case`
`:this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(t,s,i,r){if(this._error)return null;if(!t)return this._error="buffer is null",null;let n=new Rr,a=i,o;const l=new Array(1);for(;a<s;a++){const u=this.parseValue(t,s,a,l);if(this._error)return null;a=l[0],u&&n.add(u);t:for(;a<s;a++)switch(o=t[a],o){case",":break t;case"]":return r[0]=a+1,n;case`
`:++this._lineCount}}return n=void 0,this._error="illegal end of parseObject",null}}class Qs extends ut{constructor(t){super(),this._value=t}isFloat(){return!0}getString(t,s){const i="\0";return this._value=parseFloat(i),this._stringBuffer=i,this._stringBuffer}toInt(t=0){return parseInt(this._value.toString())}toFloat(t=0){return this._value}equals(t){return typeof t=="number"?Math.round(t)?!1:t==this._value:!1}}class Et extends ut{isBool(){return!0}toBoolean(t=!1){return this._boolValue}getString(t,s){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(t){return typeof t=="boolean"?t==this._boolValue:!1}isStatic(){return!0}constructor(t){super(),this._boolValue=t}}class He extends ut{constructor(t){super(),typeof t=="string"&&(this._stringBuffer=t),t instanceof Pt&&(this._stringBuffer=t.s)}isString(){return!0}getString(t,s){return this._stringBuffer}equals(t){return typeof t=="string"?this._stringBuffer==t:t instanceof Pt?this._stringBuffer==t.s:!1}}class ys extends He{isStatic(){return this._isStatic}setErrorNotForClientCall(t){return this._stringBuffer=t,this}constructor(t,s){typeof t=="string"?super(t):super(t),this._isStatic=s}isError(){return!0}}class je extends ut{isNull(){return!0}getString(t,s){return this._stringBuffer}isStatic(){return!0}setErrorNotForClientCall(t){return this._stringBuffer=t,ys.nullValue}constructor(){super(),this._stringBuffer="NullValue"}}class Rr extends ut{constructor(){super(),this._array=new L}release(){for(let t=this._array.begin();t.notEqual(this._array.end());t.preIncrement()){let s=t.ptr();s&&!s.isStatic()&&(s=void 0,s=null)}}isArray(){return!0}getValueByIndex(t){if(t<0||this._array.getSize()<=t)return ut.errorValue.setErrorNotForClientCall(qc);const s=this._array.at(t);return s??ut.nullValue}getValueByString(t){return ut.errorValue.setErrorNotForClientCall(Zs)}getString(t,s){const i=s+`[
`;for(let r=this._array.begin();r.notEqual(this._array.end());r.increment()){const n=r.ptr();this._stringBuffer+=s+""+n.getString(s+" ")+`
`}return this._stringBuffer=i+s+`]
`,this._stringBuffer}add(t){this._array.pushBack(t)}getVector(t=null){return this._array}getSize(){return this._array.getSize()}}class Xe extends ut{constructor(){super(),this._map=new Xt}release(){const t=this._map.begin();for(;t.notEqual(this._map.end());){let s=t.ptr().second;s&&!s.isStatic()&&(s=void 0,s=null),t.preIncrement()}}isMap(){return!0}getValueByString(t){if(t instanceof Pt){const s=this._map.getValue(t.s);return s??ut.nullValue}for(let s=this._map.begin();s.notEqual(this._map.end());s.preIncrement())if(s.ptr().first==t)return s.ptr().second==null?ut.nullValue:s.ptr().second;return ut.nullValue}getValueByIndex(t){return ut.errorValue.setErrorNotForClientCall(Zs)}getString(t,s){this._stringBuffer=s+`{
`;const i=this._map.begin();for(;i.notEqual(this._map.end());){const r=i.ptr().first,n=i.ptr().second;this._stringBuffer+=s+" "+r+" : "+n.getString(s+"   ")+` 
`,i.preIncrement()}return this._stringBuffer+=s+`}
`,this._stringBuffer}getMap(t){return this._map}put(t,s){this._map.setValue(t,s)}getKeys(){if(!this._keys){this._keys=new L;const t=this._map.begin();for(;t.notEqual(this._map.end());){const s=t.ptr().first;this._keys.pushBack(s),t.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}var En;(e=>{e.CubismJson=at,e.JsonArray=Rr,e.JsonBoolean=Et,e.JsonError=ys,e.JsonFloat=Qs,e.JsonMap=Xe,e.JsonNullvalue=je,e.JsonString=He,e.Value=ut})(En||(En={}));function Jc(e,t){let s=0;for(let r=1;;r++){const n=e.slice(r-1,r);if(n=="e"||n=="-"||n=="E")continue;const a=e.substring(0,r),o=Number(a);if(isNaN(o))break;s=r}let i=parseFloat(e);return isNaN(i)&&(i=NaN),t[0]=e.slice(s),i}let It=!1,Ee=!1,Re=null,Ke=null;const ae=Object.freeze({vertexOffset:0,vertexStep:2});function ss(e){e&&(e=void 0)}let J=class{static startUp(t=null){if(It)return re("CubismFramework.startUp() is already done."),It;if(Re=t,Re!=null&&Live2DCubismCore.Logging.csmSetLogFunction(Re.logFunction),It=!0,It){const s=Live2DCubismCore.Version.csmGetVersion(),i=(s&4278190080)>>24,r=(s&16711680)>>16,n=s&65535,a=s;re("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+i).slice(-2),("00"+r).slice(-2),("0000"+n).slice(-4),a)}return re("CubismFramework.startUp() is complete."),It}static cleanUp(){It=!1,Ee=!1,Re=null,Ke=null}static initialize(t=0){if(zt(It),!It){ne("CubismFramework is not started.");return}if(Ee){ne("CubismFramework.initialize() skipped, already initialized.");return}ut.staticInitializeNotForClientCall(),Ke=new wo,Live2DCubismCore.Memory.initializeAmountOfMemory(t),Ee=!0,re("CubismFramework.initialize() is complete.")}static dispose(){if(zt(It),!It){ne("CubismFramework is not started.");return}if(!Ee){ne("CubismFramework.dispose() skipped, not initialized.");return}ut.staticReleaseNotForClientCall(),Ke.release(),Ke=null,hi.staticRelease(),Ee=!1,re("CubismFramework.dispose() is complete.")}static isStarted(){return It}static isInitialized(){return Ee}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return Re!=null?Re.loggingLevel:5}static getIdManager(){return Ke}constructor(){}};var Le=(e=>(e[e.LogLevel_Verbose=0]="LogLevel_Verbose",e[e.LogLevel_Debug=1]="LogLevel_Debug",e[e.LogLevel_Info=2]="LogLevel_Info",e[e.LogLevel_Warning=3]="LogLevel_Warning",e[e.LogLevel_Error=4]="LogLevel_Error",e[e.LogLevel_Off=5]="LogLevel_Off",e))(Le||{}),Rn;(e=>{e.Constant=ae,e.csmDelete=ss,e.CubismFramework=J})(Rn||(Rn={}));let Eo=class{};var Zi;(e=>{e.ICubismModelSetting=Eo})(Zi||(Zi={}));const Kt="FileReferences",Kc="Groups",Zc="Layout",Qc="HitAreas",th="Moc",eh="Textures",sh="Physics",ih="Pose",rh="Expressions",nh="Motions",Fn="UserData",Zt="Name",Dn="File",ah="Id",Fs="Ids",An="Sound",Ln="FadeInTime",On="FadeOutTime",Bi="LipSync",Ii="EyeBlink";let oh=class extends Eo{constructor(t,s){super(),this._json=at.create(t,s),this.getJson()&&(this._jsonValue=new L,this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kc)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(th)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(nh)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(rh)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(eh)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(sh)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Kt).getValueByString(ih)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(Qc)))}release(){at.delete(this._json),this._jsonValue=null}getJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(1).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(4).getSize():0}getTextureDirectory(){const s=this._jsonValue.at(4).getValueByIndex(0).getRawString().split("/"),i=s.length-1;let r="";for(let n=0;n<i;n++)r+=s[n],n<i-1&&(r+="/");return r}getTextureFileName(t){return this._jsonValue.at(4).getValueByIndex(t).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(7).getSize():0}getHitAreaId(t){return J.getIdManager().getId(this._jsonValue.at(7).getValueByIndex(t).getValueByString(ah).getRawString())}getHitAreaName(t){return this._jsonValue.at(7).getValueByIndex(t).getValueByString(Zt).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(5).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(6).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(3).getSize():0}getExpressionName(t){return this._jsonValue.at(3).getValueByIndex(t).getValueByString(Zt).getRawString()}getExpressionFileName(t){return this._jsonValue.at(3).getValueByIndex(t).getValueByString(Dn).getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().getSize():0}getMotionGroupName(t){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().at(t):null}getMotionCount(t){return this.isExistMotionGroupName(t)?this._jsonValue.at(2).getValueByString(t).getSize():0}getMotionFileName(t,s){return this.isExistMotionGroupName(t)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(Dn).getRawString():""}getMotionSoundFileName(t,s){return this.isExistMotionSoundFile(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(An).getRawString():""}getMotionFadeInTimeValue(t,s){return this.isExistMotionFadeIn(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(Ln).toFloat():-1}getMotionFadeOutTimeValue(t,s){return this.isExistMotionFadeOut(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(On).toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this.getJson().getRoot().getValueByString(Kt).getValueByString(Fn).getRawString():""}getLayoutMap(t){const s=this.getJson().getRoot().getValueByString(Zc).getMap();if(s==null)return!1;let i=!1;for(const r=s.begin();r.notEqual(s.end());r.preIncrement())t.setValue(r.ptr().first,r.ptr().second.toFloat()),i=!0;return i}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(Zt).getRawString()==Ii){t=i.getValueByString(Fs).getVector().getSize();break}}return t}getEyeBlinkParameterId(t){if(!this.isExistEyeBlinkParameters())return null;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(Zt).getRawString()==Ii)return J.getIdManager().getId(i.getValueByString(Fs).getValueByIndex(t).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(Zt).getRawString()==Bi){t=i.getValueByString(Fs).getVector().getSize();break}}return t}getLipSyncParameterId(t){if(!this.isExistLipSyncParameters())return null;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(Zt).getRawString()==Bi)return J.getIdManager().getId(i.getValueByString(Fs).getValueByIndex(t).getRawString())}return null}isExistModelFile(){const t=this._jsonValue.at(1);return!t.isNull()&&!t.isError()}isExistTextureFiles(){const t=this._jsonValue.at(4);return!t.isNull()&&!t.isError()}isExistHitAreas(){const t=this._jsonValue.at(7);return!t.isNull()&&!t.isError()}isExistPhysicsFile(){const t=this._jsonValue.at(5);return!t.isNull()&&!t.isError()}isExistPoseFile(){const t=this._jsonValue.at(6);return!t.isNull()&&!t.isError()}isExistExpressionFile(){const t=this._jsonValue.at(3);return!t.isNull()&&!t.isError()}isExistMotionGroups(){const t=this._jsonValue.at(2);return!t.isNull()&&!t.isError()}isExistMotionGroupName(t){const s=this._jsonValue.at(2).getValueByString(t);return!s.isNull()&&!s.isError()}isExistMotionSoundFile(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(An);return!i.isNull()&&!i.isError()}isExistMotionFadeIn(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(Ln);return!i.isNull()&&!i.isError()}isExistMotionFadeOut(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(On);return!i.isNull()&&!i.isError()}isExistUserDataFile(){const t=this.getJson().getRoot().getValueByString(Kt).getValueByString(Fn);return!t.isNull()&&!t.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let t=0;t<this._jsonValue.at(0).getSize();++t)if(this._jsonValue.at(0).getValueByIndex(t).getValueByString(Zt).getRawString()==Ii)return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let t=0;t<this._jsonValue.at(0).getSize();++t)if(this._jsonValue.at(0).getValueByIndex(t).getValueByString(Zt).getRawString()==Bi)return!0;return!1}};var Qi;(e=>{e.CubismModelSettingJson=oh})(Qi||(Qi={}));class gi{static create(){return new gi}static delete(t){}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,s){this._currentTime+=s;const i=this._currentTime*2*3.14159;for(let r=0;r<this._breathParameters.getSize();++r){const n=this._breathParameters.at(r);t.addParameterValueById(n.parameterId,n.offset+n.peak*Math.sin(i/n.cycle),n.weight)}}constructor(){this._currentTime=0}}class lh{constructor(t,s,i,r,n){this.parameterId=t??null,this.offset=s??0,this.peak=i??0,this.cycle=r??0,this.weight=n??0}}var kn;(e=>{e.BreathParameterData=lh,e.CubismBreath=gi})(kn||(kn={}));var Ve;let Ro=(Ve=class{static create(t=null){return new Ve(t)}static delete(t){}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,s,i){this._closingSeconds=t,this._closedSeconds=s,this._openingSeconds=i}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,s){this._userTimeSeconds+=s;let i,r=0;switch(this._blinkingState){case 2:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,r>=1&&(r=1,this._blinkingState=3,this._stateStartTimeSeconds=this._userTimeSeconds),i=1-r;break;case 3:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,r>=1&&(this._blinkingState=4,this._stateStartTimeSeconds=this._userTimeSeconds),i=0;break;case 4:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,r>=1&&(r=1,this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming()),i=r;break;case 1:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=2,this._stateStartTimeSeconds=this._userTimeSeconds),i=1;break;case 0:default:this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming(),i=1;break}Ve.CloseIfZero||(i=-i);for(let a=0;a<this._parameterIds.getSize();++a)t.setParameterValueById(this._parameterIds.at(a),i)}constructor(t){if(this._blinkingState=0,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new L,t!=null)for(let s=0;s<t.getEyeBlinkParameterCount();++s)this._parameterIds.pushBack(t.getEyeBlinkParameterId(s))}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}},Ve.CloseIfZero=!0,Ve);var Fo=(e=>(e[e.EyeState_First=0]="EyeState_First",e[e.EyeState_Interval=1]="EyeState_Interval",e[e.EyeState_Closing=2]="EyeState_Closing",e[e.EyeState_Closed=3]="EyeState_Closed",e[e.EyeState_Opening=4]="EyeState_Opening",e))(Fo||{}),tr;(e=>{e.CubismEyeBlink=Ro,e.EyeState=Fo})(tr||(tr={}));const uh=.001,Vi=.5,Nn="FadeInTime",Un="Link",ch="Groups",hh="Id";class xs{static create(t,s){const i=at.create(t,s);if(!i)return null;const r=new xs,n=i.getRoot();n.getValueByString(Nn).isNull()||(r._fadeTimeSeconds=n.getValueByString(Nn).toFloat(Vi),r._fadeTimeSeconds<=0&&(r._fadeTimeSeconds=Vi));const a=n.getValueByString(ch),o=a.getSize();for(let l=0;l<o;++l){const u=a.getValueByIndex(l),c=u.getSize();let g=0;for(let p=0;p<c;++p){const f=u.getValueByIndex(p),_=new Cs,x=J.getIdManager().getId(f.getValueByString(hh).getRawString());if(_.partId=x,!f.getValueByString(Un).isNull()){const y=f.getValueByString(Un),v=y.getSize();for(let M=0;M<v;++M){const V=new Cs,E=J.getIdManager().getId(y.getValueByIndex(M).getString());V.partId=E,_.link.pushBack(V)}}r._partGroups.pushBack(_.clone()),++g}r._partGroupCounts.pushBack(g)}return at.delete(i),r}static delete(t){}updateParameters(t,s){t!=this._lastModel&&this.reset(t),this._lastModel=t,s<0&&(s=0);let i=0;for(let r=0;r<this._partGroupCounts.getSize();r++){const n=this._partGroupCounts.at(r);this.doFade(t,s,i,n),i+=n}this.copyPartOpacities(t)}reset(t){let s=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const r=this._partGroupCounts.at(i);for(let n=s;n<s+r;++n){this._partGroups.at(n).initialize(t);const a=this._partGroups.at(n).partIndex,o=this._partGroups.at(n).parameterIndex;if(!(a<0)){t.setPartOpacityByIndex(a,n==s?1:0),t.setParameterValueByIndex(o,n==s?1:0);for(let l=0;l<this._partGroups.at(n).link.getSize();++l)this._partGroups.at(n).link.at(l).initialize(t)}}s+=r}}copyPartOpacities(t){for(let s=0;s<this._partGroups.getSize();++s){const i=this._partGroups.at(s);if(i.link.getSize()==0)continue;const r=this._partGroups.at(s).partIndex,n=t.getPartOpacityByIndex(r);for(let a=0;a<i.link.getSize();++a){const l=i.link.at(a).partIndex;l<0||t.setPartOpacityByIndex(l,n)}}}doFade(t,s,i,r){let n=-1,a=1;const o=.5,l=.15;for(let u=i;u<i+r;++u){const c=this._partGroups.at(u).partIndex,g=this._partGroups.at(u).parameterIndex;if(t.getParameterValueByIndex(g)>uh){if(n>=0)break;n=u,a=t.getPartOpacityByIndex(c),a+=s/this._fadeTimeSeconds,a>1&&(a=1)}}n<0&&(n=0,a=1);for(let u=i;u<i+r;++u){const c=this._partGroups.at(u).partIndex;if(n==u)t.setPartOpacityByIndex(c,a);else{let g=t.getPartOpacityByIndex(c),p;a<o?p=a*(o-1)/o+1:p=(1-a)*o/(1-o),(1-p)*(1-a)>l&&(p=1-l/(1-a)),g>p&&(g=p),t.setPartOpacityByIndex(c,g)}}}constructor(){this._fadeTimeSeconds=Vi,this._lastModel=null,this._partGroups=new L,this._partGroupCounts=new L}}class Cs{constructor(t){if(this.parameterIndex=0,this.partIndex=0,this.link=new L,t!=null){this.partId=t.partId;for(const s=t.link.begin();s.notEqual(t.link.end());s.preIncrement())this.link.pushBack(s.ptr().clone())}}assignment(t){this.partId=t.partId;for(const s=t.link.begin();s.notEqual(t.link.end());s.preIncrement())this.link.pushBack(s.ptr().clone());return this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new Cs;t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=new L;for(let s=this.link.begin();s.notEqual(this.link.end());s.increment())t.link.pushBack(s.ptr().clone());return t}}var zn;(e=>{e.CubismPose=xs,e.PartData=Cs})(zn||(zn={}));class Do extends ue{constructor(t,s){super(),this._width=t!==void 0?t:0,this._height=s!==void 0?s:0,this.setHeight(2)}setWidth(t){const s=t/this._width,i=s;this.scale(s,i)}setHeight(t){const s=t/this._height,i=s;this.scale(s,i)}setPosition(t,s){this.translate(t,s)}setCenterPosition(t,s){this.centerX(t),this.centerY(s)}top(t){this.setY(t)}bottom(t){const s=this._height*this.getScaleY();this.translateY(t-s)}left(t){this.setX(t)}right(t){const s=this._width*this.getScaleX();this.translateX(t-s)}centerX(t){const s=this._width*this.getScaleX();this.translateX(t-s/2)}setX(t){this.translateX(t)}centerY(t){const s=this._height*this.getScaleY();this.translateY(t-s/2)}setY(t){this.translateY(t)}setupFromLayout(t){const s="width",i="height",r="x",n="y",a="center_x",o="center_y",l="top",u="bottom",c="left",g="right";for(const p=t.begin();p.notEqual(t.end());p.preIncrement()){const f=p.ptr().first,_=p.ptr().second;f==s?this.setWidth(_):f==i&&this.setHeight(_)}for(const p=t.begin();p.notEqual(t.end());p.preIncrement()){const f=p.ptr().first,_=p.ptr().second;f==r?this.setX(_):f==n?this.setY(_):f==a?this.centerX(_):f==o?this.centerY(_):f==l?this.top(_):f==u?this.bottom(_):f==c?this.left(_):f==g&&this.right(_)}}}var jn;(e=>{e.CubismModelMatrix=Do})(jn||(jn={}));class D{constructor(t,s){this.x=t,this.y=s,this.x=t??0,this.y=s??0}add(t){const s=new D(0,0);return s.x=this.x+t.x,s.y=this.y+t.y,s}substract(t){const s=new D(0,0);return s.x=this.x-t.x,s.y=this.y-t.y,s}multiply(t){const s=new D(0,0);return s.x=this.x*t.x,s.y=this.y*t.y,s}multiplyByScaler(t){return this.multiply(new D(t,t))}division(t){const s=new D(0,0);return s.x=this.x/t.x,s.y=this.y/t.y,s}divisionByScalar(t){return this.division(new D(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}var Xn;(e=>{e.CubismVector2=D})(Xn||(Xn={}));const ke=class ke{static range(t,s,i){return t<s?t=s:t>i&&(t=i),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static cbrt(t){if(t===0)return t;let s=t;const i=s<0;i&&(s=-s);let r;return s===1/0?r=1/0:(r=Math.exp(Math.log(s)/3),r=(s/(r*r)+2*r)/3),i?-r:r}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,s){return t>s?t:s}static min(t,s){return t>s?s:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return t*180/Math.PI}static directionToRadian(t,s){const i=Math.atan2(s.y,s.x),r=Math.atan2(t.y,t.x);let n=i-r;for(;n<-Math.PI;)n+=Math.PI*2;for(;n>Math.PI;)n-=Math.PI*2;return n}static directionToDegrees(t,s){const i=this.directionToRadian(t,s);let r=this.radianToDegrees(i);return s.x-t.x>0&&(r=-r),r}static radianToDirection(t){const s=new D;return s.x=this.sin(t),s.y=this.cos(t),s}static quadraticEquation(t,s,i){return this.abs(t)<ke.Epsilon?this.abs(s)<ke.Epsilon?-i:-i/s:-(s+this.sqrt(s*s-4*t*i))/(2*t)}static cardanoAlgorithmForBezier(t,s,i,r){if(this.sqrt(t)<ke.Epsilon)return this.range(this.quadraticEquation(s,i,r),0,1);const n=s/t,a=i/t,o=r/t,l=(3*a-n*n)/3,u=l/3,c=(2*n*n*n-9*n*a+27*o)/27,g=c/2,p=g*g+u*u*u,f=.5,_=f+.01;if(p<0){const V=-l/3,E=V*V*V,F=this.sqrt(E),w=-c/(2*F),$=this.range(w,-1,1),Z=Math.acos($),Y=2*this.cbrt(F),ct=Y*this.cos(Z/3)-n/3;if(this.abs(ct-f)<_)return this.range(ct,0,1);const Dt=Y*this.cos((Z+2*Math.PI)/3)-n/3;if(this.abs(Dt-f)<_)return this.range(Dt,0,1);const we=Y*this.cos((Z+4*Math.PI)/3)-n/3;return this.range(we,0,1)}if(p==0){let V;g<0?V=this.cbrt(-g):V=-this.cbrt(g);const E=2*V-n/3;if(this.abs(E-f)<_)return this.range(E,0,1);const F=-V-n/3;return this.range(F,0,1)}const x=this.sqrt(p),y=this.cbrt(x-g),v=this.cbrt(x+g),M=y-v-n/3;return this.range(M,0,1)}static mod(t,s){if(!isFinite(t)||s===0||isNaN(t)||isNaN(s))return console.warn(`divided: ${t}, divisor: ${s} mod() returns 'NaN'.`),NaN;const i=Math.abs(t),r=Math.abs(s);let n=i-Math.floor(i/r)*r;return n*=Math.sign(t),n}constructor(){}};ke.Epsilon=1e-5;let k=ke;var Gn;(e=>{e.CubismMath=k})(Gn||(Gn={}));const wi=30,$n=.01;class Ao{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(t){this._userTimeSeconds+=t;const i=40/10*1/wi;if(this._lastTimeSeconds==0){this._lastTimeSeconds=this._userTimeSeconds;return}const r=(this._userTimeSeconds-this._lastTimeSeconds)*wi;this._lastTimeSeconds=this._userTimeSeconds;const a=.15*wi,o=r*i/a,l=this._faceTargetX-this._faceX,u=this._faceTargetY-this._faceY;if(k.abs(l)<=$n&&k.abs(u)<=$n)return;const c=k.sqrt(l*l+u*u),g=i*l/c,p=i*u/c;let f=g-this._faceVX,_=p-this._faceVY;const x=k.sqrt(f*f+_*_);(x<-o||x>o)&&(f*=o/x,_*=o/x),this._faceVX+=f,this._faceVY+=_;{const y=.5*(k.sqrt(o*o+16*o*c-8*o*c)-o),v=k.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);v>y&&(this._faceVX*=y/v,this._faceVY*=y/v)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(t,s){this._faceTargetX=t,this._faceTargetY=s}}var Hn;(e=>{e.CubismTargetPoint=Ao})(Hn||(Hn={}));let di=class{constructor(){this.setFinishedMotionHandler=t=>this._onFinishedMotion=t,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new L}static delete(t){t.release(),t=null}release(){this._weight=0}updateParameters(t,s,i){if(!s.isAvailable()||s.isFinished())return;this.setupMotionQueueEntry(s,i);const r=this.updateFadeWeight(s,i);this.doUpdateParameters(t,i,r,s),s.getEndTime()>0&&s.getEndTime()<i&&s.setIsFinished(!0)}setupMotionQueueEntry(t,s){if(t==null||t.isStarted()||!t.isAvailable())return;t.setIsStarted(!0),t.setStartTime(s-this._offsetSeconds),t.setFadeInStartTime(s);const i=this.getDuration();t.getEndTime()<0&&t.setEndTime(i<=0?-1:t.getStartTime()+i)}updateFadeWeight(t,s){t==null&&Er.print(Le.LogLevel_Error,"motionQueueEntry is null.");let i=this._weight;const r=this._fadeInSeconds==0?1:k.getEasingSine((s-t.getFadeInStartTime())/this._fadeInSeconds),n=this._fadeOutSeconds==0||t.getEndTime()<0?1:k.getEasingSine((t.getEndTime()-s)/this._fadeOutSeconds);return i=i*r*n,t.setState(s,i),zt(0<=i&&i<=1),i}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}getFiredEvent(t,s){return this._firedEventValues}isExistModelOpacity(){return!1}getModelOpacityIndex(){return-1}getModelOpacityId(t){return null}getModelOpacityValue(){return 1}};var er;(e=>{e.ACubismMotion=di})(er||(er={}));const gh="FadeInTime",dh="FadeOutTime",Wn="Parameters",fh="Id",_h="Value",Ds="Blend",ph="Add",mh="Multiply",yh="Overwrite",Yn=1;var ft;let Oe=(ft=class extends di{static create(t,s){const i=new ft;return i.parse(t,s),i}doUpdateParameters(t,s,i,r){for(let n=0;n<this._parameters.getSize();++n){const a=this._parameters.at(n);switch(a.blendType){case 0:{t.addParameterValueById(a.parameterId,a.value,i);break}case 1:{t.multiplyParameterValueById(a.parameterId,a.value,i);break}case 2:{t.setParameterValueById(a.parameterId,a.value,i);break}}}}calculateExpressionParameters(t,s,i,r,n,a){if(!(i==null||r==null)&&i.isAvailable()){this._fadeWeight=this.updateFadeWeight(i,s);for(let o=0;o<r.getSize();++o){const l=r.at(o);if(l.parameterId==null)continue;const u=l.overwriteValue=t.getParameterValueById(l.parameterId),c=this.getExpressionParameters();let g=-1;for(let y=0;y<c.getSize();++y)if(l.parameterId==c.at(y).parameterId){g=y;break}if(g<0){n==0?(l.additiveValue=ft.DefaultAdditiveValue,l.multiplyValue=ft.DefaultMultiplyValue,l.overwriteValue=u):(l.additiveValue=this.calculateValue(l.additiveValue,ft.DefaultAdditiveValue,a),l.multiplyValue=this.calculateValue(l.multiplyValue,ft.DefaultMultiplyValue,a),l.overwriteValue=this.calculateValue(l.overwriteValue,u,a));continue}const p=c.at(g).value;let f,_,x;switch(c.at(g).blendType){case 0:f=p,_=ft.DefaultMultiplyValue,x=u;break;case 1:f=ft.DefaultAdditiveValue,_=p,x=u;break;case 2:f=ft.DefaultAdditiveValue,_=ft.DefaultMultiplyValue,x=p;break;default:return}n==0?(l.additiveValue=f,l.multiplyValue=_,l.overwriteValue=x):(l.additiveValue=l.additiveValue*(1-a)+f*a,l.multiplyValue=l.multiplyValue*(1-a)+_*a,l.overwriteValue=l.overwriteValue*(1-a)+x*a)}}}getExpressionParameters(){return this._parameters}getFadeWeight(){return this._fadeWeight}parse(t,s){const i=at.create(t,s);if(!i)return;const r=i.getRoot();this.setFadeInTime(r.getValueByString(gh).toFloat(Yn)),this.setFadeOutTime(r.getValueByString(dh).toFloat(Yn));const n=r.getValueByString(Wn).getSize();this._parameters.prepareCapacity(n);for(let a=0;a<n;++a){const o=r.getValueByString(Wn).getValueByIndex(a),l=J.getIdManager().getId(o.getValueByString(fh).getRawString()),u=o.getValueByString(_h).toFloat();let c;o.getValueByString(Ds).isNull()||o.getValueByString(Ds).getString()==ph?c=0:o.getValueByString(Ds).getString()==mh?c=1:o.getValueByString(Ds).getString()==yh?c=2:c=0;const g=new Oo;g.parameterId=l,g.blendType=c,g.value=u,this._parameters.pushBack(g)}at.delete(i)}calculateValue(t,s,i){return t*(1-i)+s*i}constructor(){super(),this._parameters=new L,this._fadeWeight=0}},ft.DefaultAdditiveValue=0,ft.DefaultMultiplyValue=1,ft);var Lo=(e=>(e[e.Additive=0]="Additive",e[e.Multiply=1]="Multiply",e[e.Overwrite=2]="Overwrite",e))(Lo||{});class Oo{}var sr;(e=>{e.CubismExpressionMotion=Oe,e.ExpressionBlendType=Lo,e.ExpressionParameter=Oo})(sr||(sr={}));class ko{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&di.delete(this._motion)}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,s){const i=s+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,s){this._stateTimeSeconds=t,this._stateWeight=s}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}getCubismMotion(){return this._motion}}var qn;(e=>{e.CubismMotionQueueEntry=ko})(qn||(qn={}));class Fr{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new L}release(){for(let t=0;t<this._motions.getSize();++t)this._motions.at(t)&&(this._motions.at(t).release(),this._motions.set(t,null));this._motions=null}startMotion(t,s,i){if(t==null)return No;let r=null;for(let n=0;n<this._motions.getSize();++n)r=this._motions.at(n),r!=null&&r.setFadeOut(r._motion.getFadeOutTime());return r=new ko,r._autoDelete=s,r._motion=t,this._motions.pushBack(r),r._motionQueueEntryHandle}isFinished(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let s=t.ptr();if(s==null){t=this._motions.erase(t);continue}if(s._motion==null){s.release(),s=null,t=this._motions.erase(t);continue}if(s.isFinished())t.preIncrement();else return!1}return!0}isFinishedByHandle(t){for(let s=this._motions.begin();s.notEqual(this._motions.end());s.increment()){const i=s.ptr();if(i!=null&&i._motionQueueEntryHandle==t&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let s=t.ptr();if(s==null){t=this._motions.erase(t);continue}s.release(),s=null,t=this._motions.erase(t)}}getCubismMotionQueueEntries(){return this._motions}getCubismMotionQueueEntry(t){for(let s=this._motions.begin();s.notEqual(this._motions.end());s.preIncrement()){const i=s.ptr();if(i!=null&&i._motionQueueEntryHandle==t)return i}return null}setEventCallback(t,s=null){this._eventCallBack=t,this._eventCustomData=s}doUpdateMotion(t,s){let i=!1;for(let r=this._motions.begin();r.notEqual(this._motions.end());){let n=r.ptr();if(n==null){r=this._motions.erase(r);continue}const a=n._motion;if(a==null){n.release(),n=null,r=this._motions.erase(r);continue}a.updateParameters(t,n,s),i=!0;const o=a.getFiredEvent(n.getLastCheckEventSeconds()-n.getStartTime(),s-n.getStartTime());for(let l=0;l<o.getSize();++l)this._eventCallBack(this,o.at(l),this._eventCustomData);n.setLastCheckEventSeconds(s),n.isFinished()?(n.release(),n=null,r=this._motions.erase(r)):(n.isTriggeredFadeOut()&&n.startFadeOut(n.getFadeOutSeconds(),s),r.preIncrement())}return i}}const No=-1;var Jn;(e=>{e.CubismMotionQueueManager=Fr,e.InvalidMotionQueueEntryHandleValue=No})(Jn||(Jn={}));class xh{}class Uo extends Fr{constructor(){super(),this._currentPriority=0,this._reservePriority=0,this._expressionParameterValues=new L,this._fadeWeights=new L}release(){this._expressionParameterValues&&(ss(this._expressionParameterValues),this._expressionParameterValues=null),this._fadeWeights&&(ss(this._fadeWeights),this._fadeWeights=null)}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}getFadeWeight(t){return this._fadeWeights.at(t)}setReservePriority(t){this._reservePriority=t}startMotionPriority(t,s,i){return i==this.getReservePriority()&&this.setReservePriority(0),this._currentPriority=i,this._fadeWeights.pushBack(0),this.startMotion(t,s)}updateMotion(t,s){this._userTimeSeconds+=s;let i=!1;const r=this.getCubismMotionQueueEntries();let n=0,a=0;for(let o=this._motions.begin();o.notEqual(this._motions.end());){const l=o.ptr();if(l==null){o=r.erase(o);continue}const u=l.getCubismMotion();if(u==null){ss(l),o=r.erase(o);continue}const c=u.getExpressionParameters();if(l.isAvailable())for(let g=0;g<c.getSize();++g){if(c.at(g).parameterId==null)continue;let p=-1;for(let _=0;_<this._expressionParameterValues.getSize();++_)if(this._expressionParameterValues.at(_).parameterId==c.at(g).parameterId){p=_;break}if(p>=0)continue;const f=new xh;f.parameterId=c.at(g).parameterId,f.additiveValue=Oe.DefaultAdditiveValue,f.multiplyValue=Oe.DefaultMultiplyValue,f.overwriteValue=t.getParameterValueById(f.parameterId),this._expressionParameterValues.pushBack(f)}u.setupMotionQueueEntry(l,this._userTimeSeconds),this._fadeWeights.set(a,u.updateFadeWeight(l,this._userTimeSeconds)),u.calculateExpressionParameters(t,this._userTimeSeconds,l,this._expressionParameterValues,a,this._fadeWeights.at(a)),n+=u.getFadeInTime()==0?1:k.getEasingSine((this._userTimeSeconds-l.getFadeInStartTime())/u.getFadeInTime()),i=!0,l.isTriggeredFadeOut()&&l.startFadeOut(l.getFadeOutSeconds(),this._userTimeSeconds),o.preIncrement(),++a}if(r.getSize()>1&&(r.at(r.getSize()-1).getCubismMotion(),this._fadeWeights.at(this._fadeWeights.getSize()-1)>=1))for(let l=r.getSize()-2;l>=0;--l){const u=r.at(l);ss(u),r.remove(l),this._fadeWeights.remove(l)}n>1&&(n=1);for(let o=0;o<this._expressionParameterValues.getSize();++o){const l=this._expressionParameterValues.at(o);t.setParameterValueById(l.parameterId,(l.overwriteValue+l.additiveValue)*l.multiplyValue,n),l.additiveValue=Oe.DefaultAdditiveValue,l.multiplyValue=Oe.DefaultMultiplyValue}return i}}var Kn;(e=>{e.CubismExpressionMotionManager=Uo})(Kn||(Kn={}));var wt=(e=>(e[e.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",e[e.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",e[e.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",e))(wt||{}),Tt=(e=>(e[e.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",e[e.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",e[e.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",e[e.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",e))(Tt||{});class Dr{constructor(){this.time=0,this.value=0}}class zo{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}}class jo{constructor(){this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class Xo{constructor(){this.fireTime=0}}class Go{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new L,this.segments=new L,this.points=new L,this.events=new L}}var Zn;(e=>{e.CubismMotionCurve=jo,e.CubismMotionCurveTarget=wt,e.CubismMotionData=Go,e.CubismMotionEvent=Xo,e.CubismMotionPoint=Dr,e.CubismMotionSegment=zo,e.CubismMotionSegmentType=Tt})(Zn||(Zn={}));const St="Meta",Ch="Duration",Sh="Loop",bh="AreBeziersRestricted",Mh="CurveCount",vh="Fps",Ph="TotalSegmentCount",Bh="TotalPointCount",Qt="Curves",Ih="Target",Vh="Id",As="FadeInTime",Ls="FadeOutTime",Qn="Segments",ta="UserData",wh="UserDataCount",Th="TotalUserDataSize",Eh="Time",Rh="Value";class $o{constructor(t,s){this._json=at.create(t,s)}release(){at.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(St).getValueByString(Ch).toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(St).getValueByString(Sh).toBoolean()}getEvaluationOptionFlag(t){return t==0?this._json.getRoot().getValueByString(St).getValueByString(bh).toBoolean():!1}getMotionCurveCount(){return this._json.getRoot().getValueByString(St).getValueByString(Mh).toInt()}getMotionFps(){return this._json.getRoot().getValueByString(St).getValueByString(vh).toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(St).getValueByString(Ph).toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(St).getValueByString(Bh).toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(St).getValueByString(As).isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(St).getValueByString(Ls).isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(St).getValueByString(As).toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(St).getValueByString(Ls).toFloat()}getMotionCurveTarget(t){return this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Ih).getRawString()}getMotionCurveId(t){return J.getIdManager().getId(this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Vh).getRawString())}isExistMotionCurveFadeInTime(t){return!this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(As).isNull()}isExistMotionCurveFadeOutTime(t){return!this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Ls).isNull()}getMotionCurveFadeInTime(t){return this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(As).toFloat()}getMotionCurveFadeOutTime(t){return this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Ls).toFloat()}getMotionCurveSegmentCount(t){return this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Qn).getVector().getSize()}getMotionCurveSegment(t,s){return this._json.getRoot().getValueByString(Qt).getValueByIndex(t).getValueByString(Qn).getValueByIndex(s).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(St).getValueByString(wh).toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(St).getValueByString(Th).toInt()}getEventTime(t){return this._json.getRoot().getValueByString(ta).getValueByIndex(t).getValueByString(Eh).toFloat()}getEventValue(t){return new Pt(this._json.getRoot().getValueByString(ta).getValueByIndex(t).getValueByString(Rh).getRawString())}}var Ho=(e=>(e[e.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",e))(Ho||{}),ea;(e=>{e.CubismMotionJson=$o})(ea||(ea={}));const Fh="EyeBlink",Dh="LipSync",Ah="Model",Lh="Parameter",Oh="PartOpacity",Os="Opacity",kh=!1;function Mt(e,t,s){const i=new Dr;return i.time=e.time+(t.time-e.time)*s,i.value=e.value+(t.value-e.value)*s,i}function Nh(e,t){let s=(t-e[0].time)/(e[1].time-e[0].time);return s<0&&(s=0),e[0].value+(e[1].value-e[0].value)*s}function Uh(e,t){let s=(t-e[0].time)/(e[3].time-e[0].time);s<0&&(s=0);const i=Mt(e[0],e[1],s),r=Mt(e[1],e[2],s),n=Mt(e[2],e[3],s),a=Mt(i,r,s),o=Mt(r,n,s);return Mt(a,o,s).value}function zh(e,t){const s=t,i=e[0].time,r=e[3].time,n=e[1].time,a=e[2].time,o=r-3*a+3*n-i,l=3*a-6*n+3*i,u=3*n-3*i,c=i-s,g=k.cardanoAlgorithmForBezier(o,l,u,c),p=Mt(e[0],e[1],g),f=Mt(e[1],e[2],g),_=Mt(e[2],e[3],g),x=Mt(p,f,g),y=Mt(f,_,g);return Mt(x,y,g).value}function jh(e,t){return e[0].value}function Xh(e,t){return e[1].value}function Ti(e,t,s){const i=e.curves.at(t);let r=-1;const n=i.baseSegmentIndex+i.segmentCount;let a=0;for(let l=i.baseSegmentIndex;l<n;++l)if(a=e.segments.at(l).basePointIndex+(e.segments.at(l).segmentType==Tt.CubismMotionSegmentType_Bezier?3:1),e.points.at(a).time>s){r=l;break}if(r==-1)return e.points.at(a).value;const o=e.segments.at(r);return o.evaluate(e.points.get(o.basePointIndex),s)}let Wo=class Yo extends di{static create(t,s,i){const r=new Yo;return r.parse(t,s),r._sourceFrameRate=r._motionData.fps,r._loopDurationSeconds=r._motionData.duration,r._onFinishedMotion=i,r}doUpdateParameters(t,s,i,r){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=J.getIdManager().getId(Fh)),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=J.getIdManager().getId(Dh)),this._modelCurveIdOpacity==null&&(this._modelCurveIdOpacity=J.getIdManager().getId(Os));let n=s-r.getStartTime();n<0&&(n=0);let a=Number.MAX_VALUE,o=Number.MAX_VALUE;const l=64;let u=0,c=0;this._eyeBlinkParameterIds.getSize()>l&&ms("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>l&&ms("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const g=this._fadeInSeconds<=0?1:k.getEasingSine((s-r.getFadeInStartTime())/this._fadeInSeconds),p=this._fadeOutSeconds<=0||r.getEndTime()<0?1:k.getEasingSine((r.getEndTime()-s)/this._fadeOutSeconds);let f,_,x,y=n;if(this._isLoop)for(;y>this._motionData.duration;)y-=this._motionData.duration;const v=this._motionData.curves;for(_=0;_<this._motionData.curveCount&&v.at(_).type==wt.CubismMotionCurveTarget_Model;++_)f=Ti(this._motionData,_,y),v.at(_).id==this._modelCurveIdEyeBlink?o=f:v.at(_).id==this._modelCurveIdLipSync?a=f:v.at(_).id==this._modelCurveIdOpacity&&(this._modelOpacity=f,t.setModelOapcity(this.getModelOpacityValue()));for(;_<this._motionData.curveCount&&v.at(_).type==wt.CubismMotionCurveTarget_Parameter;++_){if(x=t.getParameterIndex(v.at(_).id),x==-1)continue;const M=t.getParameterValueByIndex(x);if(f=Ti(this._motionData,_,y),o!=Number.MAX_VALUE){for(let E=0;E<this._eyeBlinkParameterIds.getSize()&&E<l;++E)if(this._eyeBlinkParameterIds.at(E)==v.at(_).id){f*=o,c|=1<<E;break}}if(a!=Number.MAX_VALUE){for(let E=0;E<this._lipSyncParameterIds.getSize()&&E<l;++E)if(this._lipSyncParameterIds.at(E)==v.at(_).id){f+=a,u|=1<<E;break}}let V;if(v.at(_).fadeInTime<0&&v.at(_).fadeOutTime<0)V=M+(f-M)*i;else{let E,F;v.at(_).fadeInTime<0?E=g:E=v.at(_).fadeInTime==0?1:k.getEasingSine((s-r.getFadeInStartTime())/v.at(_).fadeInTime),v.at(_).fadeOutTime<0?F=p:F=v.at(_).fadeOutTime==0||r.getEndTime()<0?1:k.getEasingSine((r.getEndTime()-s)/v.at(_).fadeOutTime);const w=this._weight*E*F;V=M+(f-M)*w}t.setParameterValueByIndex(x,V,1)}{if(o!=Number.MAX_VALUE)for(let M=0;M<this._eyeBlinkParameterIds.getSize()&&M<l;++M){const V=t.getParameterValueById(this._eyeBlinkParameterIds.at(M));if(c>>M&1)continue;const E=V+(o-V)*i;t.setParameterValueById(this._eyeBlinkParameterIds.at(M),E)}if(a!=Number.MAX_VALUE)for(let M=0;M<this._lipSyncParameterIds.getSize()&&M<l;++M){const V=t.getParameterValueById(this._lipSyncParameterIds.at(M));if(u>>M&1)continue;const E=V+(a-V)*i;t.setParameterValueById(this._lipSyncParameterIds.at(M),E)}}for(;_<this._motionData.curveCount&&v.at(_).type==wt.CubismMotionCurveTarget_PartOpacity;++_)x=t.getParameterIndex(v.at(_).id),x!=-1&&(f=Ti(this._motionData,_,y),t.setParameterValueByIndex(x,f));n>=this._motionData.duration&&(this._isLoop?(r.setStartTime(s),this._isLoopFadeIn&&r.setFadeInStartTime(s)):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(t){this._isLoop=t}isLoop(){return this._isLoop}setIsLoopFadeIn(t){this._isLoopFadeIn=t}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(t,s){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id){i.at(r).fadeInTime=s;return}}setParameterFadeOutTime(t,s){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id){i.at(r).fadeOutTime=s;return}}getParameterFadeInTime(t){const s=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==s.at(i).id)return s.at(i).fadeInTime;return-1}getParameterFadeOutTime(t){const s=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==s.at(i).id)return s.at(i).fadeOutTime;return-1}setEffectIds(t,s){this._eyeBlinkParameterIds=t,this._lipSyncParameterIds=s}constructor(){super(),this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._modelCurveIdOpacity=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null,this._modelOpacity=1}release(){this._motionData=void 0,this._motionData=null}parse(t,s){this._motionData=new Go;let i=new $o(t,s);if(!i){i.release(),i=void 0;return}this._motionData.duration=i.getMotionDuration(),this._motionData.loop=i.isMotionLoop(),this._motionData.curveCount=i.getMotionCurveCount(),this._motionData.fps=i.getMotionFps(),this._motionData.eventCount=i.getEventCount();const r=i.getEvaluationOptionFlag(Ho.EvaluationOptionFlag_AreBeziersRistricted);i.isExistMotionFadeInTime()?this._fadeInSeconds=i.getMotionFadeInTime()<0?1:i.getMotionFadeInTime():this._fadeInSeconds=1,i.isExistMotionFadeOutTime()?this._fadeOutSeconds=i.getMotionFadeOutTime()<0?1:i.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,jo,!0),this._motionData.segments.updateSize(i.getMotionTotalSegmentCount(),zo,!0),this._motionData.points.updateSize(i.getMotionTotalPointCount(),Dr,!0),this._motionData.events.updateSize(this._motionData.eventCount,Xo,!0);let n=0,a=0;for(let o=0;o<this._motionData.curveCount;++o){i.getMotionCurveTarget(o)==Ah?this._motionData.curves.at(o).type=wt.CubismMotionCurveTarget_Model:i.getMotionCurveTarget(o)==Lh?this._motionData.curves.at(o).type=wt.CubismMotionCurveTarget_Parameter:i.getMotionCurveTarget(o)==Oh?this._motionData.curves.at(o).type=wt.CubismMotionCurveTarget_PartOpacity:ne('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!'),this._motionData.curves.at(o).id=i.getMotionCurveId(o),this._motionData.curves.at(o).baseSegmentIndex=a,this._motionData.curves.at(o).fadeInTime=i.isExistMotionCurveFadeInTime(o)?i.getMotionCurveFadeInTime(o):-1,this._motionData.curves.at(o).fadeOutTime=i.isExistMotionCurveFadeOutTime(o)?i.getMotionCurveFadeOutTime(o):-1;for(let l=0;l<i.getMotionCurveSegmentCount(o);){switch(l==0?(this._motionData.segments.at(a).basePointIndex=n,this._motionData.points.at(n).time=i.getMotionCurveSegment(o,l),this._motionData.points.at(n).value=i.getMotionCurveSegment(o,l+1),n+=1,l+=2):this._motionData.segments.at(a).basePointIndex=n-1,i.getMotionCurveSegment(o,l)){case Tt.CubismMotionSegmentType_Linear:{this._motionData.segments.at(a).segmentType=Tt.CubismMotionSegmentType_Linear,this._motionData.segments.at(a).evaluate=Nh,this._motionData.points.at(n).time=i.getMotionCurveSegment(o,l+1),this._motionData.points.at(n).value=i.getMotionCurveSegment(o,l+2),n+=1,l+=3;break}case Tt.CubismMotionSegmentType_Bezier:{this._motionData.segments.at(a).segmentType=Tt.CubismMotionSegmentType_Bezier,r||kh?this._motionData.segments.at(a).evaluate=Uh:this._motionData.segments.at(a).evaluate=zh,this._motionData.points.at(n).time=i.getMotionCurveSegment(o,l+1),this._motionData.points.at(n).value=i.getMotionCurveSegment(o,l+2),this._motionData.points.at(n+1).time=i.getMotionCurveSegment(o,l+3),this._motionData.points.at(n+1).value=i.getMotionCurveSegment(o,l+4),this._motionData.points.at(n+2).time=i.getMotionCurveSegment(o,l+5),this._motionData.points.at(n+2).value=i.getMotionCurveSegment(o,l+6),n+=3,l+=7;break}case Tt.CubismMotionSegmentType_Stepped:{this._motionData.segments.at(a).segmentType=Tt.CubismMotionSegmentType_Stepped,this._motionData.segments.at(a).evaluate=jh,this._motionData.points.at(n).time=i.getMotionCurveSegment(o,l+1),this._motionData.points.at(n).value=i.getMotionCurveSegment(o,l+2),n+=1,l+=3;break}case Tt.CubismMotionSegmentType_InverseStepped:{this._motionData.segments.at(a).segmentType=Tt.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(a).evaluate=Xh,this._motionData.points.at(n).time=i.getMotionCurveSegment(o,l+1),this._motionData.points.at(n).value=i.getMotionCurveSegment(o,l+2),n+=1,l+=3;break}default:{zt(0);break}}++this._motionData.curves.at(o).segmentCount,++a}}for(let o=0;o<i.getEventCount();++o)this._motionData.events.at(o).fireTime=i.getEventTime(o),this._motionData.events.at(o).value=i.getEventValue(o);i.release(),i=void 0,i=null}getFiredEvent(t,s){this._firedEventValues.updateSize(0);for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events.at(i).fireTime>t&&this._motionData.events.at(i).fireTime<=s&&this._firedEventValues.pushBack(new Pt(this._motionData.events.at(i).value.s));return this._firedEventValues}isExistModelOpacity(){for(let t=0;t<this._motionData.curveCount;t++){const s=this._motionData.curves.at(t);if(s.type==wt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(Os)==0)return!0}return!1}getModelOpacityIndex(){if(this.isExistModelOpacity())for(let t=0;t<this._motionData.curveCount;t++){const s=this._motionData.curves.at(t);if(s.type==wt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(Os)==0)return t}return-1}getModelOpacityId(t){if(t!=-1){const s=this._motionData.curves.at(t);if(s.type==wt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(Os)==0)return J.getIdManager().getId(s.id.getString().s)}return null}getModelOpacityValue(){return this._modelOpacity}};var ir;(e=>{e.CubismMotion=Wo})(ir||(ir={}));let qo=class extends Fr{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(t){this._reservePriority=t}startMotionPriority(t,s,i){return i==this._reservePriority&&(this._reservePriority=0),this._currentPriority=i,super.startMotion(t,s)}updateMotion(t,s){this._userTimeSeconds+=s;const i=super.doUpdateMotion(t,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),i}reserveMotion(t){return t<=this._reservePriority||t<=this._currentPriority?!1:(this._reservePriority=t,!0)}};var rr;(e=>{e.CubismMotionManager=qo})(rr||(rr={}));var ti=(e=>(e[e.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",e))(ti||{}),ie=(e=>(e[e.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",e[e.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",e[e.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",e))(ie||{});class Gh{constructor(){this.gravity=new D(0,0),this.wind=new D(0,0)}}class Ar{}class nr{}class Jo{constructor(){this.initialPosition=new D(0,0),this.position=new D(0,0),this.lastPosition=new D(0,0),this.lastGravity=new D(0,0),this.force=new D(0,0),this.velocity=new D(0,0)}}class Ko{constructor(){this.normalizationPosition=new nr,this.normalizationAngle=new nr}}class Zo{constructor(){this.source=new Ar}}class Qo{constructor(){this.destination=new Ar,this.translationScale=new D(0,0)}}class tl{constructor(){this.settings=new L,this.inputs=new L,this.outputs=new L,this.particles=new L,this.gravity=new D(0,0),this.wind=new D(0,0),this.fps=0}}var sa;(e=>{e.CubismPhysicsInput=Zo,e.CubismPhysicsNormalization=nr,e.CubismPhysicsOutput=Qo,e.CubismPhysicsParameter=Ar,e.CubismPhysicsParticle=Jo,e.CubismPhysicsRig=tl,e.CubismPhysicsSource=ie,e.CubismPhysicsSubRig=Ko,e.CubismPhysicsTargetType=ti,e.PhysicsJsonEffectiveForces=Gh})(sa||(sa={}));const Ze="Position",Ei="X",Ri="Y",Fi="Angle",ia="Type",ra="Id",$t="Meta",ks="EffectiveForces",$h="TotalInputCount",Hh="TotalOutputCount",Wh="PhysicsSettingCount",na="Gravity",aa="Wind",Yh="VertexCount",qh="Fps",K="PhysicsSettings",Fe="Normalization",oa="Minimum",la="Maximum",ua="Default",ca="Reflect",ha="Weight",Qe="Input",Jh="Source",ye="Output",Kh="Scale",Zh="VertexIndex",Qh="Destination",xe="Vertices",tg="Mobility",eg="Delay",sg="Radius",ig="Acceleration";class el{constructor(t,s){this._json=at.create(t,s)}release(){at.delete(this._json)}getGravity(){const t=new D(0,0);return t.x=this._json.getRoot().getValueByString($t).getValueByString(ks).getValueByString(na).getValueByString(Ei).toFloat(),t.y=this._json.getRoot().getValueByString($t).getValueByString(ks).getValueByString(na).getValueByString(Ri).toFloat(),t}getWind(){const t=new D(0,0);return t.x=this._json.getRoot().getValueByString($t).getValueByString(ks).getValueByString(aa).getValueByString(Ei).toFloat(),t.y=this._json.getRoot().getValueByString($t).getValueByString(ks).getValueByString(aa).getValueByString(Ri).toFloat(),t}getFps(){return this._json.getRoot().getValueByString($t).getValueByString(qh).toFloat(0)}getSubRigCount(){return this._json.getRoot().getValueByString($t).getValueByString(Wh).toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString($t).getValueByString($h).toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString($t).getValueByString(Hh).toInt()}getVertexCount(){return this._json.getRoot().getValueByString($t).getValueByString(Yh).toInt()}getNormalizationPositionMinimumValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Ze).getValueByString(oa).toFloat()}getNormalizationPositionMaximumValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Ze).getValueByString(la).toFloat()}getNormalizationPositionDefaultValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Ze).getValueByString(ua).toFloat()}getNormalizationAngleMinimumValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Fi).getValueByString(oa).toFloat()}getNormalizationAngleMaximumValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Fi).getValueByString(la).toFloat()}getNormalizationAngleDefaultValue(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Fe).getValueByString(Fi).getValueByString(ua).toFloat()}getInputCount(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Qe).getVector().getSize()}getInputWeight(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Qe).getValueByIndex(s).getValueByString(ha).toFloat()}getInputReflect(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Qe).getValueByIndex(s).getValueByString(ca).toBoolean()}getInputType(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Qe).getValueByIndex(s).getValueByString(ia).getRawString()}getInputSourceId(t,s){return J.getIdManager().getId(this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(Qe).getValueByIndex(s).getValueByString(Jh).getValueByString(ra).getRawString())}getOutputCount(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getVector().getSize()}getOutputVertexIndex(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(Zh).toInt()}getOutputAngleScale(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(Kh).toFloat()}getOutputWeight(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(ha).toFloat()}getOutputDestinationId(t,s){return J.getIdManager().getId(this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(Qh).getValueByString(ra).getRawString())}getOutputType(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(ia).getRawString()}getOutputReflect(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(ye).getValueByIndex(s).getValueByString(ca).toBoolean()}getParticleCount(t){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getVector().getSize()}getParticleMobility(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(tg).toFloat()}getParticleDelay(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(eg).toFloat()}getParticleAcceleration(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(ig).toFloat()}getParticleRadius(t,s){return this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(sg).toFloat()}getParticlePosition(t,s){const i=new D(0,0);return i.x=this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(Ze).getValueByString(Ei).toFloat(),i.y=this._json.getRoot().getValueByString(K).getValueByIndex(t).getValueByString(xe).getValueByIndex(s).getValueByString(Ze).getValueByString(Ri).toFloat(),i}}var ga;(e=>{e.CubismPhysicsJson=el})(ga||(ga={}));const da="X",fa="Y",_a="Angle",rg=5,ar=100,pa=.001,ng=5;let or=class sl{static create(t,s){const i=new sl;return i.parse(t,s),i._physicsRig.gravity.y=0,i}static delete(t){t!=null&&(t.release(),t=null)}parse(t,s){this._physicsRig=new tl;let i=new el(t,s);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.fps=i.getFps(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,Ko,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),Zo,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),Qo,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),Jo,!0),this._currentRigOutputs.clear(),this._previousRigOutputs.clear();let r=0,n=0,a=0;for(let o=0;o<this._physicsRig.settings.getSize();++o){this._physicsRig.settings.at(o).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(o),this._physicsRig.settings.at(o).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(o),this._physicsRig.settings.at(o).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(o),this._physicsRig.settings.at(o).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(o),this._physicsRig.settings.at(o).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(o),this._physicsRig.settings.at(o).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(o),this._physicsRig.settings.at(o).inputCount=i.getInputCount(o),this._physicsRig.settings.at(o).baseInputIndex=r;for(let c=0;c<this._physicsRig.settings.at(o).inputCount;++c)this._physicsRig.inputs.at(r+c).sourceParameterIndex=-1,this._physicsRig.inputs.at(r+c).weight=i.getInputWeight(o,c),this._physicsRig.inputs.at(r+c).reflect=i.getInputReflect(o,c),i.getInputType(o,c)==da?(this._physicsRig.inputs.at(r+c).type=ie.CubismPhysicsSource_X,this._physicsRig.inputs.at(r+c).getNormalizedParameterValue=og):i.getInputType(o,c)==fa?(this._physicsRig.inputs.at(r+c).type=ie.CubismPhysicsSource_Y,this._physicsRig.inputs.at(r+c).getNormalizedParameterValue=lg):i.getInputType(o,c)==_a&&(this._physicsRig.inputs.at(r+c).type=ie.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(r+c).getNormalizedParameterValue=ug),this._physicsRig.inputs.at(r+c).source.targetType=ti.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(r+c).source.id=i.getInputSourceId(o,c);r+=this._physicsRig.settings.at(o).inputCount,this._physicsRig.settings.at(o).outputCount=i.getOutputCount(o),this._physicsRig.settings.at(o).baseOutputIndex=n;const l=new ma;l.outputs.resize(this._physicsRig.settings.at(o).outputCount);const u=new ma;u.outputs.resize(this._physicsRig.settings.at(o).outputCount);for(let c=0;c<this._physicsRig.settings.at(o).outputCount;++c)l.outputs.set(c,0),u.outputs.set(c,0),this._physicsRig.outputs.at(n+c).destinationParameterIndex=-1,this._physicsRig.outputs.at(n+c).vertexIndex=i.getOutputVertexIndex(o,c),this._physicsRig.outputs.at(n+c).angleScale=i.getOutputAngleScale(o,c),this._physicsRig.outputs.at(n+c).weight=i.getOutputWeight(o,c),this._physicsRig.outputs.at(n+c).destination.targetType=ti.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(n+c).destination.id=i.getOutputDestinationId(o,c),i.getOutputType(o,c)==da?(this._physicsRig.outputs.at(n+c).type=ie.CubismPhysicsSource_X,this._physicsRig.outputs.at(n+c).getValue=cg,this._physicsRig.outputs.at(n+c).getScale=_g):i.getOutputType(o,c)==fa?(this._physicsRig.outputs.at(n+c).type=ie.CubismPhysicsSource_Y,this._physicsRig.outputs.at(n+c).getValue=hg,this._physicsRig.outputs.at(n+c).getScale=pg):i.getOutputType(o,c)==_a&&(this._physicsRig.outputs.at(n+c).type=ie.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(n+c).getValue=gg,this._physicsRig.outputs.at(n+c).getScale=mg),this._physicsRig.outputs.at(n+c).reflect=i.getOutputReflect(o,c);this._currentRigOutputs.pushBack(l),this._previousRigOutputs.pushBack(u),n+=this._physicsRig.settings.at(o).outputCount,this._physicsRig.settings.at(o).particleCount=i.getParticleCount(o),this._physicsRig.settings.at(o).baseParticleIndex=a;for(let c=0;c<this._physicsRig.settings.at(o).particleCount;++c)this._physicsRig.particles.at(a+c).mobility=i.getParticleMobility(o,c),this._physicsRig.particles.at(a+c).delay=i.getParticleDelay(o,c),this._physicsRig.particles.at(a+c).acceleration=i.getParticleAcceleration(o,c),this._physicsRig.particles.at(a+c).radius=i.getParticleRadius(o,c),this._physicsRig.particles.at(a+c).position=i.getParticlePosition(o,c);a+=this._physicsRig.settings.at(o).particleCount}this.initialize(),i.release(),i=void 0,i=null}stabilization(t){var x,y;let s,i,r,n;const a=new D;let o,l,u,c;const g=t.getModel().parameters.values,p=t.getModel().parameters.maximumValues,f=t.getModel().parameters.minimumValues,_=t.getModel().parameters.defaultValues;(((x=this._parameterCaches)==null?void 0:x.length)??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(((y=this._parameterInputCaches)==null?void 0:y.length)??0)<t.getParameterCount()&&(this._parameterInputCaches=new Float32Array(t.getParameterCount()));for(let v=0;v<t.getParameterCount();++v)this._parameterCaches[v]=g[v],this._parameterInputCaches[v]=g[v];for(let v=0;v<this._physicsRig.subRigCount;++v){s={angle:0},a.x=0,a.y=0,o=this._physicsRig.settings.at(v),l=this._physicsRig.inputs.get(o.baseInputIndex),u=this._physicsRig.outputs.get(o.baseOutputIndex),c=this._physicsRig.particles.get(o.baseParticleIndex);for(let M=0;M<o.inputCount;++M)i=l[M].weight/ar,l[M].sourceParameterIndex==-1&&(l[M].sourceParameterIndex=t.getParameterIndex(l[M].source.id)),l[M].getNormalizedParameterValue(a,s,g[l[M].sourceParameterIndex],f[l[M].sourceParameterIndex],p[l[M].sourceParameterIndex],_[l[M].sourceParameterIndex],o.normalizationPosition,o.normalizationAngle,l[M].reflect,i),this._parameterCaches[l[M].sourceParameterIndex]=g[l[M].sourceParameterIndex];r=k.degreesToRadian(-s.angle),a.x=a.x*k.cos(r)-a.y*k.sin(r),a.y=a.x*k.sin(r)+a.y*k.cos(r),xg(c,o.particleCount,a,s.angle,this._options.wind,pa*o.normalizationPosition.maximum);for(let M=0;M<o.outputCount;++M){const V=u[M].vertexIndex;if(u[M].destinationParameterIndex==-1&&(u[M].destinationParameterIndex=t.getParameterIndex(u[M].destination.id)),V<1||V>=o.particleCount)continue;let E=new D;E=c[V].position.substract(c[V-1].position),n=u[M].getValue(E,c,V,u[M].reflect,this._options.gravity),this._currentRigOutputs.at(v).outputs.set(M,n),this._previousRigOutputs.at(v).outputs.set(M,n);const F=u[M].destinationParameterIndex,w=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(g.subarray(F))):g.slice(F);Di(w,f[F],p[F],n,u[M]);for(let $=F,Z=0;$<this._parameterCaches.length;$++,Z++)g[$]=this._parameterCaches[$]=w[Z]}}}evaluate(t,s){var M,V;let i,r,n,a;const o=new D;let l,u,c,g;if(0>=s)return;const p=t.getModel().parameters.values,f=t.getModel().parameters.maximumValues,_=t.getModel().parameters.minimumValues,x=t.getModel().parameters.defaultValues;let y;if(this._currentRemainTime+=s,this._currentRemainTime>ng&&(this._currentRemainTime=0),(((M=this._parameterCaches)==null?void 0:M.length)??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(((V=this._parameterInputCaches)==null?void 0:V.length)??0)<t.getParameterCount()){this._parameterInputCaches=new Float32Array(t.getParameterCount());for(let E=0;E<t.getParameterCount();++E)this._parameterInputCaches[E]=p[E]}for(this._physicsRig.fps>0?y=1/this._physicsRig.fps:y=s;this._currentRemainTime>=y;){for(let F=0;F<this._physicsRig.subRigCount;++F){l=this._physicsRig.settings.at(F),c=this._physicsRig.outputs.get(l.baseOutputIndex);for(let w=0;w<l.outputCount;++w)this._previousRigOutputs.at(F).outputs.set(w,this._currentRigOutputs.at(F).outputs.at(w))}const E=y/this._currentRemainTime;for(let F=0;F<t.getParameterCount();++F)this._parameterCaches[F]=this._parameterInputCaches[F]*(1-E)+p[F]*E,this._parameterInputCaches[F]=this._parameterCaches[F];for(let F=0;F<this._physicsRig.subRigCount;++F){i={angle:0},o.x=0,o.y=0,l=this._physicsRig.settings.at(F),u=this._physicsRig.inputs.get(l.baseInputIndex),c=this._physicsRig.outputs.get(l.baseOutputIndex),g=this._physicsRig.particles.get(l.baseParticleIndex);for(let w=0;w<l.inputCount;++w)r=u[w].weight/ar,u[w].sourceParameterIndex==-1&&(u[w].sourceParameterIndex=t.getParameterIndex(u[w].source.id)),u[w].getNormalizedParameterValue(o,i,this._parameterCaches[u[w].sourceParameterIndex],_[u[w].sourceParameterIndex],f[u[w].sourceParameterIndex],x[u[w].sourceParameterIndex],l.normalizationPosition,l.normalizationAngle,u[w].reflect,r);n=k.degreesToRadian(-i.angle),o.x=o.x*k.cos(n)-o.y*k.sin(n),o.y=o.x*k.sin(n)+o.y*k.cos(n),yg(g,l.particleCount,o,i.angle,this._options.wind,pa*l.normalizationPosition.maximum,y,rg);for(let w=0;w<l.outputCount;++w){const $=c[w].vertexIndex;if(c[w].destinationParameterIndex==-1&&(c[w].destinationParameterIndex=t.getParameterIndex(c[w].destination.id)),$<1||$>=l.particleCount)continue;const Z=new D;Z.x=g[$].position.x-g[$-1].position.x,Z.y=g[$].position.y-g[$-1].position.y,a=c[w].getValue(Z,g,$,c[w].reflect,this._options.gravity),this._currentRigOutputs.at(F).outputs.set(w,a);const X=c[w].destinationParameterIndex,Y=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(this._parameterCaches.subarray(X))):this._parameterCaches.slice(X);Di(Y,_[X],f[X],a,c[w]);for(let ct=X,Dt=0;ct<this._parameterCaches.length;ct++,Dt++)this._parameterCaches[ct]=Y[Dt]}}this._currentRemainTime-=y}const v=this._currentRemainTime/y;this.interpolate(t,v)}interpolate(t,s){let i,r;const n=t.getModel().parameters.values,a=t.getModel().parameters.maximumValues,o=t.getModel().parameters.minimumValues;for(let l=0;l<this._physicsRig.subRigCount;++l){r=this._physicsRig.settings.at(l),i=this._physicsRig.outputs.get(r.baseOutputIndex);for(let u=0;u<r.outputCount;++u){if(i[u].destinationParameterIndex==-1)continue;const c=i[u].destinationParameterIndex,g=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(n.subarray(c))):n.slice(c);Di(g,o[c],a[c],this._previousRigOutputs.at(l).outputs.at(u)*(1-s)+this._currentRigOutputs.at(l).outputs.at(u)*s,i[u]);for(let p=c,f=0;p<n.length;p++,f++)n[p]=g[f]}}}setOptions(t){this._options=t}getOption(){return this._options}constructor(){this._physicsRig=null,this._options=new il,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0,this._currentRigOutputs=new L,this._previousRigOutputs=new L,this._currentRemainTime=0,this._parameterCaches=null,this._parameterInputCaches=null}release(){this._physicsRig=void 0,this._physicsRig=null}initialize(){let t,s,i;for(let r=0;r<this._physicsRig.subRigCount;++r){s=this._physicsRig.settings.at(r),t=this._physicsRig.particles.get(s.baseParticleIndex),t[0].initialPosition=new D(0,0),t[0].lastPosition=new D(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new D(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new D(0,0),t[0].force=new D(0,0);for(let n=1;n<s.particleCount;++n)i=new D(0,0),i.y=t[n].radius,t[n].initialPosition=new D(t[n-1].initialPosition.x+i.x,t[n-1].initialPosition.y+i.y),t[n].position=new D(t[n].initialPosition.x,t[n].initialPosition.y),t[n].lastPosition=new D(t[n].initialPosition.x,t[n].initialPosition.y),t[n].lastGravity=new D(0,-1),t[n].lastGravity.y*=-1,t[n].velocity=new D(0,0),t[n].force=new D(0,0)}}};class il{constructor(){this.gravity=new D(0,0),this.wind=new D(0,0)}}class ma{constructor(){this.outputs=new L(0)}}function ag(e){let t=0;return e>0?t=1:e<0&&(t=-1),t}function og(e,t,s,i,r,n,a,o,l,u){e.x+=Lr(s,i,r,n,a.minimum,a.maximum,a.defalut,l)*u}function lg(e,t,s,i,r,n,a,o,l,u){e.y+=Lr(s,i,r,n,a.minimum,a.maximum,a.defalut,l)*u}function ug(e,t,s,i,r,n,a,o,l,u){t.angle+=Lr(s,i,r,n,o.minimum,o.maximum,o.defalut,l)*u}function cg(e,t,s,i,r){let n=e.x;return i&&(n*=-1),n}function hg(e,t,s,i,r){let n=e.y;return i&&(n*=-1),n}function gg(e,t,s,i,r){let n;return s>=2?r=t[s-1].position.substract(t[s-2].position):r=r.multiplyByScaler(-1),n=k.directionToRadian(r,e),i&&(n*=-1),n}function dg(e,t){const s=k.max(e,t),i=k.min(e,t);return k.abs(s-i)}function fg(e,t){return k.min(e,t)+dg(e,t)/2}function _g(e,t){return JSON.parse(JSON.stringify(e.x))}function pg(e,t){return JSON.parse(JSON.stringify(e.y))}function mg(e,t){return JSON.parse(JSON.stringify(t))}function yg(e,t,s,i,r,n,a,o){let l,u,c=new D(0,0),g=new D(0,0),p=new D(0,0),f=new D(0,0);e[0].position=new D(s.x,s.y);const _=k.degreesToRadian(i),x=k.radianToDirection(_);x.normalize();for(let y=1;y<t;++y)e[y].force=x.multiplyByScaler(e[y].acceleration).add(r),e[y].lastPosition=new D(e[y].position.x,e[y].position.y),l=e[y].delay*a*30,c=e[y].position.substract(e[y-1].position),u=k.directionToRadian(e[y].lastGravity,x)/o,c.x=k.cos(u)*c.x-c.y*k.sin(u),c.y=k.sin(u)*c.x+c.y*k.cos(u),e[y].position=e[y-1].position.add(c),g=e[y].velocity.multiplyByScaler(l),p=e[y].force.multiplyByScaler(l).multiplyByScaler(l),e[y].position=e[y].position.add(g).add(p),f=e[y].position.substract(e[y-1].position),f.normalize(),e[y].position=e[y-1].position.add(f.multiplyByScaler(e[y].radius)),k.abs(e[y].position.x)<n&&(e[y].position.x=0),l!=0&&(e[y].velocity=e[y].position.substract(e[y].lastPosition),e[y].velocity=e[y].velocity.divisionByScalar(l),e[y].velocity=e[y].velocity.multiplyByScaler(e[y].mobility)),e[y].force=new D(0,0),e[y].lastGravity=new D(x.x,x.y)}function xg(e,t,s,i,r,n){let a=new D(0,0);e[0].position=new D(s.x,s.y);const o=k.degreesToRadian(i),l=k.radianToDirection(o);l.normalize();for(let u=1;u<t;++u)e[u].force=l.multiplyByScaler(e[u].acceleration).add(r),e[u].lastPosition=new D(e[u].position.x,e[u].position.y),e[u].velocity=new D(0,0),a=e[u].force,a.normalize(),a=a.multiplyByScaler(e[u].radius),e[u].position=e[u-1].position.add(a),k.abs(e[u].position.x)<n&&(e[u].position.x=0),e[u].force=new D(0,0),e[u].lastGravity=new D(l.x,l.y)}function Di(e,t,s,i,r){let n;const a=r.getScale(r.translationScale,r.angleScale);n=i*a,n<t?(n<r.valueBelowMinimum&&(r.valueBelowMinimum=n),n=t):n>s&&(n>r.valueExceededMaximum&&(r.valueExceededMaximum=n),n=s);const o=r.weight/ar;o>=1||(n=e[0]*(1-o)+n*o),e[0]=n}function Lr(e,t,s,i,r,n,a,o){let l=0;const u=k.max(s,t);u<e&&(e=u);const c=k.min(s,t);c>e&&(e=c);const g=k.min(r,n),p=k.max(r,n),f=a,_=fg(c,u),x=e-_;switch(ag(x)){case 1:{const y=p-f,v=u-_;v!=0&&(l=x*(y/v),l+=f);break}case-1:{const y=g-f,v=c-_;v!=0&&(l=x*(y/v),l+=f);break}case 0:{l=f;break}}return o?l:l*-1}var lr;(e=>{e.CubismPhysics=or,e.Options=il})(lr||(lr={}));const Ai=4,Cg=36,Sg=32;class bg{constructor(t){this._renderTextureCount=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new L,this._clippingContextListForDraw=new L,this._channelColors=new L,this._tmpBoundsOnModel=new Js,this._tmpMatrix=new ue,this._tmpMatrixForMask=new ue,this._tmpMatrixForDraw=new ue,this._clippingContexttConstructor=t;let s=new mt;s.r=1,s.g=0,s.b=0,s.a=0,this._channelColors.pushBack(s),s=new mt,s.r=0,s.g=1,s.b=0,s.a=0,this._channelColors.pushBack(s),s=new mt,s.r=0,s.g=0,s.b=1,s.a=0,this._channelColors.pushBack(s),s=new mt,s.r=0,s.g=0,s.b=0,s.a=1,this._channelColors.pushBack(s)}release(){for(let t=0;t<this._clippingContextListForMask.getSize();t++)this._clippingContextListForMask.at(t)&&(this._clippingContextListForMask.at(t).release(),this._clippingContextListForMask.set(t,void 0)),this._clippingContextListForMask.set(t,null);this._clippingContextListForMask=null;for(let t=0;t<this._clippingContextListForDraw.getSize();t++)this._clippingContextListForDraw.set(t,null);this._clippingContextListForDraw=null;for(let t=0;t<this._channelColors.getSize();t++)this._channelColors.set(t,null);this._channelColors=null,this._clearedFrameBufferFlags!=null&&this._clearedFrameBufferFlags.clear(),this._clearedFrameBufferFlags=null}initialize(t,s){s%1!=0&&(ne("The number of render textures must be specified as an integer. The decimal point is rounded down and corrected to an integer."),s=~~s),s<1&&ne("The number of render textures must be an integer greater than or equal to 1. Set the number of render textures to 1."),this._renderTextureCount=s<1?1:s,this._clearedFrameBufferFlags=new L(this._renderTextureCount);for(let i=0;i<t.getDrawableCount();i++){if(t.getDrawableMaskCounts()[i]<=0){this._clippingContextListForDraw.pushBack(null);continue}let r=this.findSameClip(t.getDrawableMasks()[i],t.getDrawableMaskCounts()[i]);r==null&&(r=new this._clippingContexttConstructor(this,t.getDrawableMasks()[i],t.getDrawableMaskCounts()[i]),this._clippingContextListForMask.pushBack(r)),r.addClippedDrawable(i),this._clippingContextListForDraw.pushBack(r)}}findSameClip(t,s){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),n=r._clippingIdCount;if(n!=s)continue;let a=0;for(let o=0;o<n;o++){const l=r._clippingIdList[o];for(let u=0;u<n;u++)if(t[u]==l){a++;break}}if(a==n)return r}return null}setupMatrixForHighPrecision(t,s){let i=0;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r);this.calcClippedDrawTotalBounds(t,n),n._isUsing&&i++}if(i>0){if(this.setupLayoutBounds(0),this._clearedFrameBufferFlags.getSize()!=this._renderTextureCount){this._clearedFrameBufferFlags.clear();for(let r=0;r<this._renderTextureCount;r++)this._clearedFrameBufferFlags.pushBack(!1)}else for(let r=0;r<this._renderTextureCount;r++)this._clearedFrameBufferFlags.set(r,!1);for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r),a=n._allClippedDrawRect,o=n._layoutBounds,l=.05;let u=0,c=0;const g=t.getPixelsPerUnit(),p=n.getClippingManager().getClippingMaskBufferSize(),f=o.width*p,_=o.height*p;this._tmpBoundsOnModel.setRect(a),this._tmpBoundsOnModel.width*g>f?(this._tmpBoundsOnModel.expand(a.width*l,0),u=o.width/this._tmpBoundsOnModel.width):u=g/f,this._tmpBoundsOnModel.height*g>_?(this._tmpBoundsOnModel.expand(0,a.height*l),c=o.height/this._tmpBoundsOnModel.height):c=g/_,this.createMatrixForMask(s,o,u,c),n._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),n._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray())}}}createMatrixForMask(t,s,i,r){this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(s.x,s.y),this._tmpMatrix.scaleRelative(i,r),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(s.x,s.y*(t?-1:1)),this._tmpMatrix.scaleRelative(i,r*(t?-1:1)),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray())}setupLayoutBounds(t){const s=this._renderTextureCount<=1?Cg:Sg*this._renderTextureCount;if(t<=0||t>s){t>s&&st(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-s,this._renderTextureCount,t);for(let u=0;u<this._clippingContextListForMask.getSize();u++){const c=this._clippingContextListForMask.at(u);c._layoutChannelIndex=0,c._layoutBounds.x=0,c._layoutBounds.y=0,c._layoutBounds.width=1,c._layoutBounds.height=1,c._bufferIndex=0}return}const i=this._renderTextureCount<=1?9:8;let r=t/this._renderTextureCount;const n=t%this._renderTextureCount;r=Math.ceil(r);let a=r/Ai;const o=r%Ai;a=~~a;let l=0;for(let u=0;u<this._renderTextureCount;u++)for(let c=0;c<Ai;c++){let g=a+(c<o?1:0);const p=o+(a<1?-1:0);if(c==p&&n>0&&(g-=u<n?0:1),g!=0)if(g==1){const f=this._clippingContextListForMask.at(l++);f._layoutChannelIndex=c,f._layoutBounds.x=0,f._layoutBounds.y=0,f._layoutBounds.width=1,f._layoutBounds.height=1,f._bufferIndex=u}else if(g==2)for(let f=0;f<g;f++){let _=f%2;_=~~_;const x=this._clippingContextListForMask.at(l++);x._layoutChannelIndex=c,x._layoutBounds.x=_*.5,x._layoutBounds.y=0,x._layoutBounds.width=.5,x._layoutBounds.height=1,x._bufferIndex=u}else if(g<=4)for(let f=0;f<g;f++){let _=f%2,x=f/2;_=~~_,x=~~x;const y=this._clippingContextListForMask.at(l++);y._layoutChannelIndex=c,y._layoutBounds.x=_*.5,y._layoutBounds.y=x*.5,y._layoutBounds.width=.5,y._layoutBounds.height=.5,y._bufferIndex=u}else if(g<=i)for(let f=0;f<g;f++){let _=f%3,x=f/3;_=~~_,x=~~x;const y=this._clippingContextListForMask.at(l++);y._layoutChannelIndex=c,y._layoutBounds.x=_/3,y._layoutBounds.y=x/3,y._layoutBounds.width=1/3,y._layoutBounds.height=1/3,y._bufferIndex=u}else{st(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-s,this._renderTextureCount,t);for(let f=0;f<g;f++){const _=this._clippingContextListForMask.at(l++);_._layoutChannelIndex=0,_._layoutBounds.x=0,_._layoutBounds.y=0,_._layoutBounds.width=1,_._layoutBounds.height=1,_._bufferIndex=0}}}}calcClippedDrawTotalBounds(t,s){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,a=Number.MIN_VALUE;const o=s._clippedDrawableIndexList.length;for(let l=0;l<o;l++){const u=s._clippedDrawableIndexList[l],c=t.getDrawableVertexCount(u),g=t.getDrawableVertices(u);let p=Number.MAX_VALUE,f=Number.MAX_VALUE,_=-Number.MAX_VALUE,x=-Number.MAX_VALUE;const y=c*ae.vertexStep;for(let v=ae.vertexOffset;v<y;v+=ae.vertexStep){const M=g[v],V=g[v+1];M<p&&(p=M),M>_&&(_=M),V<f&&(f=V),V>x&&(x=V)}if(p!=Number.MAX_VALUE)if(p<i&&(i=p),f<r&&(r=f),_>n&&(n=_),x>a&&(a=x),i==Number.MAX_VALUE)s._allClippedDrawRect.x=0,s._allClippedDrawRect.y=0,s._allClippedDrawRect.width=0,s._allClippedDrawRect.height=0,s._isUsing=!1;else{s._isUsing=!0;const v=n-i,M=a-r;s._allClippedDrawRect.x=i,s._allClippedDrawRect.y=r,s._allClippedDrawRect.width=v,s._allClippedDrawRect.height=M}}}getClippingContextListForDraw(){return this._clippingContextListForDraw}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}getRenderTextureCount(){return this._renderTextureCount}getChannelFlagAsColor(t){return this._channelColors.at(t)}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}}let Ce;const Mg=10;class Me{static getInstance(){return Ce==null&&(Ce=new Me),Ce}static deleteInstance(){Ce&&(Ce.release(),Ce=null)}constructor(){this._shaderSets=new L}release(){this.releaseShaderProgram()}setupShaderProgramForDraw(t,s,i){t.isPremultipliedAlpha()||st("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders();let r,n,a,o;const l=t.getClippingContextBufferForDraw()!=null,u=s.getDrawableInvertedMaskBit(i),c=l?u?2:1:0;let g;switch(s.getDrawableBlendMode(i)){case ce.CubismBlendMode_Normal:default:g=this._shaderSets.at(1+c),r=this.gl.ONE,n=this.gl.ONE_MINUS_SRC_ALPHA,a=this.gl.ONE,o=this.gl.ONE_MINUS_SRC_ALPHA;break;case ce.CubismBlendMode_Additive:g=this._shaderSets.at(4+c),r=this.gl.ONE,n=this.gl.ONE,a=this.gl.ZERO,o=this.gl.ONE;break;case ce.CubismBlendMode_Multiplicative:g=this._shaderSets.at(7+c),r=this.gl.DST_COLOR,n=this.gl.ONE_MINUS_SRC_ALPHA,a=this.gl.ZERO,o=this.gl.ONE;break}this.gl.useProgram(g.shaderProgram),t._bufferData.vertex==null&&(t._bufferData.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.vertex);const p=s.getDrawableVertices(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,p,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(g.attributePositionLocation),this.gl.vertexAttribPointer(g.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const f=s.getDrawableVertexUvs(i);if(this.gl.bufferData(this.gl.ARRAY_BUFFER,f,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(g.attributeTexCoordLocation),this.gl.vertexAttribPointer(g.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),l){this.gl.activeTexture(this.gl.TEXTURE1);const F=t.getClippingContextBufferForDraw().getClippingManager().getColorBuffer().at(t.getClippingContextBufferForDraw()._bufferIndex);this.gl.bindTexture(this.gl.TEXTURE_2D,F),this.gl.uniform1i(g.samplerTexture1Location,1),this.gl.uniformMatrix4fv(g.uniformClipMatrixLocation,!1,t.getClippingContextBufferForDraw()._matrixForDraw.getArray());const w=t.getClippingContextBufferForDraw()._layoutChannelIndex,$=t.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(w);this.gl.uniform4f(g.uniformChannelFlagLocation,$.r,$.g,$.b,$.a)}const _=s.getDrawableTextureIndex(i),x=t.getBindedTextures().getValue(_);this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,x),this.gl.uniform1i(g.samplerTexture0Location,0);const y=t.getMvpMatrix();this.gl.uniformMatrix4fv(g.uniformMatrixLocation,!1,y.getArray());const v=t.getModelColorWithOpacity(s.getDrawableOpacity(i)),M=s.getMultiplyColor(i),V=s.getScreenColor(i);this.gl.uniform4f(g.uniformBaseColorLocation,v.r,v.g,v.b,v.a),this.gl.uniform4f(g.uniformMultiplyColorLocation,M.r,M.g,M.b,M.a),this.gl.uniform4f(g.uniformScreenColorLocation,V.r,V.g,V.b,V.a),t._bufferData.index==null&&(t._bufferData.index=this.gl.createBuffer());const E=s.getDrawableVertexIndices(i);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t._bufferData.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,E,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(r,n,a,o)}setupShaderProgramForMask(t,s,i){t.isPremultipliedAlpha()||st("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders();const r=this._shaderSets.at(0);this.gl.useProgram(r.shaderProgram),t._bufferData.vertex==null&&(t._bufferData.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.vertex);const n=s.getDrawableVertices(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(r.attributePositionLocation),this.gl.vertexAttribPointer(r.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const a=s.getDrawableTextureIndex(i),o=t.getBindedTextures().getValue(a);this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.uniform1i(r.samplerTexture0Location,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const l=s.getDrawableVertexUvs(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,l,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(r.attributeTexCoordLocation),this.gl.vertexAttribPointer(r.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),t.getClippingContextBufferForMask();const u=t.getClippingContextBufferForMask()._layoutChannelIndex,c=t.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(u);this.gl.uniform4f(r.uniformChannelFlagLocation,c.r,c.g,c.b,c.a),this.gl.uniformMatrix4fv(r.uniformClipMatrixLocation,!1,t.getClippingContextBufferForMask()._matrixForMask.getArray());const g=t.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(r.uniformBaseColorLocation,g.x*2-1,g.y*2-1,g.getRight()*2-1,g.getBottom()*2-1);const p=s.getMultiplyColor(i),f=s.getScreenColor(i);this.gl.uniform4f(r.uniformMultiplyColorLocation,p.r,p.g,p.b,p.a),this.gl.uniform4f(r.uniformScreenColorLocation,f.r,f.g,f.b,f.a);const _=this.gl.ZERO,x=this.gl.ONE_MINUS_SRC_COLOR,y=this.gl.ZERO,v=this.gl.ONE_MINUS_SRC_ALPHA;t._bufferData.index==null&&(t._bufferData.index=this.gl.createBuffer());const M=s.getDrawableVertexIndices(i);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t._bufferData.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,M,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(_,x,y,v)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.getSize();t++)this.gl.deleteProgram(this._shaderSets.at(t).shaderProgram),this._shaderSets.at(t).shaderProgram=0,this._shaderSets.set(t,void 0),this._shaderSets.set(t,null)}generateShaders(){for(let t=0;t<Mg;t++)this._shaderSets.pushBack(new rl);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(vg,Pg),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(Bg,Ig),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(ya,Vg),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(ya,wg),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(0).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_multiplyColor"),this._shaderSets.at(0).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_screenColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(1).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_multiplyColor"),this._shaderSets.at(1).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_screenColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(2).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_multiplyColor"),this._shaderSets.at(2).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_screenColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(3).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_multiplyColor"),this._shaderSets.at(3).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_screenColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(4).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_multiplyColor"),this._shaderSets.at(4).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_screenColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(5).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_multiplyColor"),this._shaderSets.at(5).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_screenColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(6).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_multiplyColor"),this._shaderSets.at(6).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_screenColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(7).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_multiplyColor"),this._shaderSets.at(7).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_screenColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(8).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_multiplyColor"),this._shaderSets.at(8).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_screenColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor"),this._shaderSets.at(9).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_multiplyColor"),this._shaderSets.at(9).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_screenColor")}loadShaderProgram(t,s){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!r)return st("Vertex shader compile error!"),0;let n=this.compileShaderSource(this.gl.FRAGMENT_SHADER,s);return n?(this.gl.attachShader(i,r),this.gl.attachShader(i,n),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(n),i):(st("Failed to link program: {0}",i),this.gl.deleteShader(r),r=0,this.gl.deleteShader(n),n=0,i&&(this.gl.deleteProgram(i),i=0),0)):(st("Vertex shader compile error!"),0)}compileShaderSource(t,s){const i=s,r=this.gl.createShader(t);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const a=this.gl.getShaderInfoLog(r);st("Shader compile log: {0} ",a)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(t){this.gl=t}}class rl{}var nl=(e=>(e[e.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",e[e.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",e[e.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",e[e.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",e[e.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",e[e.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",e))(nl||{});const vg="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Pg="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",Bg="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",ya="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Ig="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 color = texColor * u_baseColor;   gl_FragColor = vec4(color.rgb, color.a);}",Vg="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",wg="precision mediump float;varying vec2      v_texCoord;varying vec4      v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4      u_channelFlag;uniform vec4      u_baseColor;uniform vec4      u_multiplyColor;uniform vec4      u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * (1.0 - maskVal);   gl_FragColor = col_formask;}";var xa;(e=>{e.CubismShaderSet=rl,e.CubismShader_WebGL=Me,e.ShaderNames=nl})(xa||(xa={}));let Wt,ei;class ur extends bg{getMaskRenderTexture(){if(this._maskTexture&&this._maskTexture.textures!=null)this._maskTexture.frameNo=this._currentFrameNo;else{this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=new L,this._maskColorBuffers!=null&&this._maskColorBuffers.clear(),this._maskColorBuffers=new L;const t=this._clippingMaskBufferSize;for(let s=0;s<this._renderTextureCount;s++)this._maskColorBuffers.pushBack(this.gl.createTexture()),this.gl.bindTexture(this.gl.TEXTURE_2D,this._maskColorBuffers.at(s)),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this._maskRenderTextures.pushBack(this.gl.createFramebuffer()),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTextures.at(s)),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._maskColorBuffers.at(s),0);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ei),this._maskTexture=new al(this._currentFrameNo,this._maskRenderTextures)}return this._maskTexture.textures}setGL(t){this.gl=t}constructor(){super(ol)}setupClippingContext(t,s){this._currentFrameNo++;let i=0;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r);this.calcClippedDrawTotalBounds(t,n),n._isUsing&&i++}if(i>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._currentMaskRenderTexture=this.getMaskRenderTexture().at(0),s.preDraw(),this.setupLayoutBounds(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture),this._clearedFrameBufferFlags.getSize()!=this._renderTextureCount&&(this._clearedFrameBufferFlags.clear(),this._clearedFrameBufferFlags=new L(this._renderTextureCount));for(let r=0;r<this._clearedFrameBufferFlags.getSize();r++)this._clearedFrameBufferFlags.set(r,!1);for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r),a=n._allClippedDrawRect,o=n._layoutBounds,l=.05;let u=0,c=0;const g=this.getMaskRenderTexture().at(n._bufferIndex);this._currentMaskRenderTexture!=g&&(this._currentMaskRenderTexture=g,s.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),this._tmpBoundsOnModel.setRect(a),this._tmpBoundsOnModel.expand(a.width*l,a.height*l),u=o.width/this._tmpBoundsOnModel.width,c=o.height/this._tmpBoundsOnModel.height,this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(u,c),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),n._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),n._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const p=n._clippingIdCount;for(let f=0;f<p;f++){const _=n._clippingIdList[f];t.getDrawableDynamicFlagVertexPositionsDidChange(_)&&(s.setIsCulling(t.getDrawableCulling(_)!=!1),this._clearedFrameBufferFlags.at(n._bufferIndex)||(this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this._clearedFrameBufferFlags.set(n._bufferIndex,!0)),s.setClippingContextBufferForMask(n),s.drawMeshWebGL(t,_))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ei),s.setClippingContextBufferForMask(null),this.gl.viewport(Wt[0],Wt[1],Wt[2],Wt[3])}}getColorBuffer(){return this._maskColorBuffers}getClippingMaskCount(){return this._clippingContextListForMask.getSize()}}class al{constructor(t,s){this.frameNo=t,this.textures=s}}class ol extends Wc{constructor(t,s,i){super(s,i),this._owner=t}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}class Tg{setGlEnable(t,s){s?this.gl.enable(t):this.gl.disable(t)}setGlEnableVertexAttribArray(t,s){s?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)}save(){if(this.gl==null){st(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._lastArrayBufferBinding=this.gl.getParameter(this.gl.ARRAY_BUFFER_BINDING),this._lastElementArrayBufferBinding=this.gl.getParameter(this.gl.ELEMENT_ARRAY_BUFFER_BINDING),this._lastProgram=this.gl.getParameter(this.gl.CURRENT_PROGRAM),this._lastActiveTexture=this.gl.getParameter(this.gl.ACTIVE_TEXTURE),this.gl.activeTexture(this.gl.TEXTURE1),this._lastTexture1Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this.gl.activeTexture(this.gl.TEXTURE0),this._lastTexture0Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._lastVertexAttribArrayEnabled[0]=this.gl.getVertexAttrib(0,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[1]=this.gl.getVertexAttrib(1,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[2]=this.gl.getVertexAttrib(2,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[3]=this.gl.getVertexAttrib(3,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastScissorTest=this.gl.isEnabled(this.gl.SCISSOR_TEST),this._lastStencilTest=this.gl.isEnabled(this.gl.STENCIL_TEST),this._lastDepthTest=this.gl.isEnabled(this.gl.DEPTH_TEST),this._lastCullFace=this.gl.isEnabled(this.gl.CULL_FACE),this._lastBlend=this.gl.isEnabled(this.gl.BLEND),this._lastFrontFace=this.gl.getParameter(this.gl.FRONT_FACE),this._lastColorMask=this.gl.getParameter(this.gl.COLOR_WRITEMASK),this._lastBlending[0]=this.gl.getParameter(this.gl.BLEND_SRC_RGB),this._lastBlending[1]=this.gl.getParameter(this.gl.BLEND_DST_RGB),this._lastBlending[2]=this.gl.getParameter(this.gl.BLEND_SRC_ALPHA),this._lastBlending[3]=this.gl.getParameter(this.gl.BLEND_DST_ALPHA),this._lastFBO=this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING),this._lastViewport=this.gl.getParameter(this.gl.VIEWPORT)}restore(){if(this.gl==null){st(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this.gl.useProgram(this._lastProgram),this.setGlEnableVertexAttribArray(0,this._lastVertexAttribArrayEnabled[0]),this.setGlEnableVertexAttribArray(1,this._lastVertexAttribArrayEnabled[1]),this.setGlEnableVertexAttribArray(2,this._lastVertexAttribArrayEnabled[2]),this.setGlEnableVertexAttribArray(3,this._lastVertexAttribArrayEnabled[3]),this.setGlEnable(this.gl.SCISSOR_TEST,this._lastScissorTest),this.setGlEnable(this.gl.STENCIL_TEST,this._lastStencilTest),this.setGlEnable(this.gl.DEPTH_TEST,this._lastDepthTest),this.setGlEnable(this.gl.CULL_FACE,this._lastCullFace),this.setGlEnable(this.gl.BLEND,this._lastBlend),this.gl.frontFace(this._lastFrontFace),this.gl.colorMask(this._lastColorMask[0],this._lastColorMask[1],this._lastColorMask[2],this._lastColorMask[3]),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._lastArrayBufferBinding),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this._lastElementArrayBufferBinding),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture1Binding2D),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture0Binding2D),this.gl.activeTexture(this._lastActiveTexture),this.gl.blendFuncSeparate(this._lastBlending[0],this._lastBlending[1],this._lastBlending[2],this._lastBlending[3])}setGl(t){this.gl=t}constructor(){this._lastVertexAttribArrayEnabled=new Array(4),this._lastColorMask=new Array(4),this._lastBlending=new Array(4),this._lastViewport=new Array(4)}}class Or extends hi{initialize(t,s=1){t.isUsingMasking()&&(this._clippingManager=new ur,this._clippingManager.initialize(t,s)),this._sortedDrawableIndexList.resize(t.getDrawableCount(),0),super.initialize(t)}bindTexture(t,s){this._textures.setValue(t,s)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(t){if(!this._model.isUsingMasking())return;const s=this._clippingManager.getRenderTextureCount();this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new ur,this._clippingManager.setClippingMaskBufferSize(t),this._clippingManager.initialize(this.getModel(),s)}getClippingMaskBufferSize(){return this._model.isUsingMasking()?this._clippingManager.getClippingMaskBufferSize():-1}getRenderTextureCount(){return this._model.isUsingMasking()?this._clippingManager.getRenderTextureCount():-1}constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._rendererProfile=new Tg,this.firstDraw=!0,this._textures=new Xt,this._sortedDrawableIndexList=new L,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}release(){this._clippingManager&&(this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null),this.gl!=null&&(this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null)}doDrawModel(){if(this.gl==null){st(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._clippingManager!=null&&(this.preDraw(),this.isUsingHighPrecisionMask()?this._clippingManager.setupMatrixForHighPrecision(this.getModel(),!1):this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const t=this.getModel().getDrawableCount(),s=this.getModel().getDrawableRenderOrders();for(let i=0;i<t;++i){const r=s[i];this._sortedDrawableIndexList.set(r,i)}for(let i=0;i<t;++i){const r=this._sortedDrawableIndexList.at(i);if(!this.getModel().getDrawableDynamicFlagIsVisible(r))continue;const n=this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw().at(r):null;if(n!=null&&this.isUsingHighPrecisionMask()){n._isUsing&&(this.gl.viewport(0,0,this._clippingManager.getClippingMaskBufferSize(),this._clippingManager.getClippingMaskBufferSize()),this.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,n.getClippingManager().getMaskRenderTexture().at(n._bufferIndex)),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));{const a=n._clippingIdCount;for(let o=0;o<a;o++){const l=n._clippingIdList[o];this._model.getDrawableDynamicFlagVertexPositionsDidChange(l)&&(this.setIsCulling(this._model.getDrawableCulling(l)!=!1),this.setClippingContextBufferForMask(n),this.drawMeshWebGL(this._model,l))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ei),this.setClippingContextBufferForMask(null),this.gl.viewport(Wt[0],Wt[1],Wt[2],Wt[3]),this.preDraw()}this.setClippingContextBufferForDraw(n),this.setIsCulling(this.getModel().getDrawableCulling(r)),this.drawMeshWebGL(this._model,r)}}drawMeshWebGL(t,s){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW),this.isGeneratingMask()?Me.getInstance().setupShaderProgramForMask(this,t,s):Me.getInstance().setupShaderProgramForDraw(this,t,s);{const i=t.getDrawableVertexIndexCount(s);this.gl.drawElements(this.gl.TRIANGLES,i,this.gl.UNSIGNED_SHORT,0)}this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}saveProfile(){this._rendererProfile.save()}restoreProfile(){this._rendererProfile.restore()}static doStaticRelease(){Me.deleteInstance()}setRenderState(t,s){ei=t,Wt=s}preDraw(){if(this.firstDraw&&(this.firstDraw=!1),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.getAnisotropy()>0&&this._extension)for(let t=0;t<this._textures.getSize();++t)this.gl.bindTexture(this.gl.TEXTURE_2D,this._textures.getValue(t)),this.gl.texParameterf(this.gl.TEXTURE_2D,this._extension.TEXTURE_MAX_ANISOTROPY_EXT,this.getAnisotropy())}setClippingContextBufferForMask(t){this._clippingContextBufferForMask=t}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(t){this._clippingContextBufferForDraw=t}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}isGeneratingMask(){return this.getClippingContextBufferForMask()!=null}startUp(t){this.gl=t,this._clippingManager&&this._clippingManager.setGL(t),Me.getInstance().setGl(t),this._rendererProfile.setGl(t),this._extension=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")}}hi.staticRelease=()=>{Or.doStaticRelease()};var Ca;(e=>{e.CubismClippingContext=ol,e.CubismClippingManager_WebGL=ur,e.CubismRenderTextureResource=al,e.CubismRenderer_WebGL=Or})(Ca||(Ca={}));class Sa{constructor(t=!1,s=new mt){this.isOverwritten=t,this.color=s}}class ba{constructor(t=!1,s=new mt){this.isOverwritten=t,this.color=s}}class Eg{constructor(t=!1,s=!1){this.isOverwritten=t,this.isCulling=s}}class ll{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getPixelsPerUnit(){return this._model==null?0:this._model.canvasinfo.PixelsPerUnit}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,s=this._savedParameters.getSize();for(let i=0;i<t;++i)i<s?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getMultiplyColor(t){return this.getOverwriteFlagForModelMultiplyColors()||this.getOverwriteFlagForDrawableMultiplyColors(t)?this._userMultiplyColors.at(t).color:this.getDrawableMultiplyColor(t)}getScreenColor(t){return this.getOverwriteFlagForModelScreenColors()||this.getOverwriteFlagForDrawableScreenColors(t)?this._userScreenColors.at(t).color:this.getDrawableScreenColor(t)}setMultiplyColorByTextureColor(t,s){this.setMultiplyColorByRGBA(t,s.r,s.g,s.b,s.a)}setMultiplyColorByRGBA(t,s,i,r,n=1){this._userMultiplyColors.at(t).color.r=s,this._userMultiplyColors.at(t).color.g=i,this._userMultiplyColors.at(t).color.b=r,this._userMultiplyColors.at(t).color.a=n}setScreenColorByTextureColor(t,s){this.setScreenColorByRGBA(t,s.r,s.g,s.b,s.a)}setScreenColorByRGBA(t,s,i,r,n=1){this._userScreenColors.at(t).color.r=s,this._userScreenColors.at(t).color.g=i,this._userScreenColors.at(t).color.b=r,this._userScreenColors.at(t).color.a=n}getPartMultiplyColor(t){return this._userPartMultiplyColors.at(t).color}getPartScreenColor(t){return this._userPartScreenColors.at(t).color}setPartColor(t,s,i,r,n,a,o){if(a.at(t).color.r=s,a.at(t).color.g=i,a.at(t).color.b=r,a.at(t).color.a=n,a.at(t).isOverwritten)for(let l=0;l<this._partChildDrawables.at(t).getSize();++l){const u=this._partChildDrawables.at(t).at(l);o.at(u).color.r=s,o.at(u).color.g=i,o.at(u).color.b=r,o.at(u).color.a=n}}setPartMultiplyColorByTextureColor(t,s){this.setPartMultiplyColorByRGBA(t,s.r,s.g,s.b,s.a)}setPartMultiplyColorByRGBA(t,s,i,r,n){this.setPartColor(t,s,i,r,n,this._userPartMultiplyColors,this._userMultiplyColors)}setPartScreenColorByTextureColor(t,s){this.setPartScreenColorByRGBA(t,s.r,s.g,s.b,s.a)}setPartScreenColorByRGBA(t,s,i,r,n){this.setPartColor(t,s,i,r,n,this._userPartScreenColors,this._userScreenColors)}getOverwriteFlagForModelMultiplyColors(){return this._isOverwrittenModelMultiplyColors}getOverwriteFlagForModelScreenColors(){return this._isOverwrittenModelScreenColors}setOverwriteFlagForModelMultiplyColors(t){this._isOverwrittenModelMultiplyColors=t}setOverwriteFlagForModelScreenColors(t){this._isOverwrittenModelScreenColors=t}getOverwriteFlagForDrawableMultiplyColors(t){return this._userMultiplyColors.at(t).isOverwritten}getOverwriteFlagForDrawableScreenColors(t){return this._userScreenColors.at(t).isOverwritten}setOverwriteFlagForDrawableMultiplyColors(t,s){this._userMultiplyColors.at(t).isOverwritten=s}setOverwriteFlagForDrawableScreenColors(t,s){this._userScreenColors.at(t).isOverwritten=s}getOverwriteColorForPartMultiplyColors(t){return this._userPartMultiplyColors.at(t).isOverwritten}getOverwriteColorForPartScreenColors(t){return this._userPartScreenColors.at(t).isOverwritten}setOverwriteColorForPartColors(t,s,i,r){i.at(t).isOverwritten=s;for(let n=0;n<this._partChildDrawables.at(t).getSize();++n){const a=this._partChildDrawables.at(t).at(n);r.at(a).isOverwritten=s,s&&(r.at(a).color.r=i.at(t).color.r,r.at(a).color.g=i.at(t).color.g,r.at(a).color.b=i.at(t).color.b,r.at(a).color.a=i.at(t).color.a)}}setOverwriteColorForPartMultiplyColors(t,s){this._userPartMultiplyColors.at(t).isOverwritten=s,this.setOverwriteColorForPartColors(t,s,this._userPartMultiplyColors,this._userMultiplyColors)}setOverwriteColorForPartScreenColors(t,s){this._userPartScreenColors.at(t).isOverwritten=s,this.setOverwriteColorForPartColors(t,s,this._userPartScreenColors,this._userScreenColors)}getDrawableCulling(t){if(this.getOverwriteFlagForModelCullings()||this.getOverwriteFlagForDrawableCullings(t))return this._userCullings.at(t).isCulling;const s=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(s[t])}setDrawableCulling(t,s){this._userCullings.at(t).isCulling=s}getOverwriteFlagForModelCullings(){return this._isOverwrittenCullings}setOverwriteFlagForModelCullings(t){this._isOverwrittenCullings=t}getOverwriteFlagForDrawableCullings(t){return this._userCullings.at(t).isOverwritten}setOverwriteFlagForDrawableCullings(t,s){this._userCullings.at(t).isOverwritten=s}getModelOapcity(){return this._modelOpacity}setModelOapcity(t){this._modelOpacity=t}getModel(){return this._model}getPartIndex(t){let s;const i=this._model.parts.count;for(s=0;s<i;++s)if(t==this._partIds.at(s))return s;return this._notExistPartId.isExist(t)?this._notExistPartId.getValue(t):(s=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(t,s),this._notExistPartOpacities.appendKey(s),s)}getPartId(t){const s=this._model.parts.ids[t];return J.getIdManager().getId(s)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(t,s){if(this._notExistPartOpacities.isExist(t)){this._notExistPartOpacities.setValue(t,s);return}zt(0<=t&&t<this.getPartCount()),this._partOpacities[t]=s}setPartOpacityById(t,s){const i=this.getPartIndex(t);i<0||this.setPartOpacityByIndex(i,s)}getPartOpacityByIndex(t){return this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.getValue(t):(zt(0<=t&&t<this.getPartCount()),this._partOpacities[t])}getPartOpacityById(t){const s=this.getPartIndex(t);return s<0?0:this.getPartOpacityByIndex(s)}getParameterIndex(t){let s;const i=this._model.parameters.count;for(s=0;s<i;++s)if(t==this._parameterIds.at(s))return s;return this._notExistParameterId.isExist(t)?this._notExistParameterId.getValue(t):(s=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(t,s),this._notExistParameterValues.appendKey(s),s)}getParameterCount(){return this._model.parameters.count}getParameterType(t){return this._model.parameters.types[t]}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterId(t){return J.getIdManager().getId(this._model.parameters.ids[t])}getParameterValueByIndex(t){return this._notExistParameterValues.isExist(t)?this._notExistParameterValues.getValue(t):(zt(0<=t&&t<this.getParameterCount()),this._parameterValues[t])}getParameterValueById(t){const s=this.getParameterIndex(t);return this.getParameterValueByIndex(s)}setParameterValueByIndex(t,s,i=1){if(this._notExistParameterValues.isExist(t)){this._notExistParameterValues.setValue(t,i==1?s:this._notExistParameterValues.getValue(t)*(1-i)+s*i);return}zt(0<=t&&t<this.getParameterCount()),this._model.parameters.maximumValues[t]<s&&(s=this._model.parameters.maximumValues[t]),this._model.parameters.minimumValues[t]>s&&(s=this._model.parameters.minimumValues[t]),this._parameterValues[t]=i==1?s:this._parameterValues[t]=this._parameterValues[t]*(1-i)+s*i}setParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.setParameterValueByIndex(r,s,i)}addParameterValueByIndex(t,s,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+s*i)}addParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.addParameterValueByIndex(r,s,i)}multiplyParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.multiplyParameterValueByIndex(r,s,i)}multiplyParameterValueByIndex(t,s,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(s-1)*i))}getDrawableIndex(t){const s=this._model.drawables.count;for(let i=0;i<s;++i)if(this._drawableIds.at(i)==t)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){const s=this._model.drawables.ids;return J.getIdManager().getId(s[t])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this.getDrawableTextureIndex(t)}getDrawableTextureIndex(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(s[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableMultiplyColor(t){const s=this._model.drawables.multiplyColors,i=t*4,r=new mt;return r.r=s[i],r.g=s[i+1],r.b=s[i+2],r.a=s[i+3],r}getDrawableScreenColor(t){const s=this._model.drawables.screenColors,i=t*4,r=new mt;return r.r=s[i],r.g=s[i+1],r.b=s[i+2],r.a=s[i+3],r}getDrawableParentPartIndex(t){return this._model.drawables.parentPartIndices[t]}getDrawableBlendMode(t){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(s[t])?ce.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(s[t])?ce.CubismBlendMode_Multiplicative:ce.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(s[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(s[t])}getDrawableDynamicFlagVisibilityDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(s[t])}getDrawableDynamicFlagOpacityDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(s[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(s[t])}getDrawableDynamicFlagBlendColorDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasBlendColorDidChangeBit(s[t])}loadParameters(){let t=this._model.parameters.count;const s=this._savedParameters.getSize();t>s&&(t=s);for(let i=0;i<t;++i)this._parameterValues[i]=this._savedParameters.at(i)}initialize(){zt(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const s=this._model.parameters.ids,i=this._model.parameters.count;this._parameterIds.prepareCapacity(i);for(let r=0;r<i;++r)this._parameterIds.pushBack(J.getIdManager().getId(s[r]))}const t=this._model.parts.count;{const s=this._model.parts.ids;this._partIds.prepareCapacity(t);for(let i=0;i<t;++i)this._partIds.pushBack(J.getIdManager().getId(s[i]));this._userPartMultiplyColors.prepareCapacity(t),this._userPartScreenColors.prepareCapacity(t),this._partChildDrawables.prepareCapacity(t)}{const s=this._model.drawables.ids,i=this._model.drawables.count;this._userMultiplyColors.prepareCapacity(i),this._userScreenColors.prepareCapacity(i),this._userCullings.prepareCapacity(i);const r=new Eg(!1,!1);for(let n=0;n<t;++n){const a=new mt(1,1,1,1),o=new mt(0,0,0,1),l=new ba(!1,a),u=new ba(!1,o);this._userPartMultiplyColors.pushBack(l),this._userPartScreenColors.pushBack(u),this._partChildDrawables.pushBack(new L),this._partChildDrawables.at(n).prepareCapacity(i)}for(let n=0;n<i;++n){const a=new mt(1,1,1,1),o=new mt(0,0,0,1),l=new Sa(!1,a),u=new Sa(!1,o);this._drawableIds.pushBack(J.getIdManager().getId(s[n])),this._userMultiplyColors.pushBack(l),this._userScreenColors.pushBack(u),this._userCullings.pushBack(r);const c=this.getDrawableParentPartIndex(n);c>=0&&this._partChildDrawables.at(c).pushBack(n)}}}constructor(t){this._model=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new L,this._parameterIds=new L,this._drawableIds=new L,this._partIds=new L,this._isOverwrittenModelMultiplyColors=!1,this._isOverwrittenModelScreenColors=!1,this._isOverwrittenCullings=!1,this._modelOpacity=1,this._userMultiplyColors=new L,this._userScreenColors=new L,this._userCullings=new L,this._userPartMultiplyColors=new L,this._userPartScreenColors=new L,this._partChildDrawables=new L,this._notExistPartId=new Xt,this._notExistParameterId=new Xt,this._notExistParameterValues=new Xt,this._notExistPartOpacities=new Xt}release(){this._model.release(),this._model=null}}var Ma;(e=>{e.CubismModel=ll})(Ma||(Ma={}));class fi{static create(t,s){let i=null;if(s&&!this.hasMocConsistency(t))return st("Inconsistent MOC3."),i;const r=Live2DCubismCore.Moc.fromArrayBuffer(t);return r&&(i=new fi(r),i._mocVersion=Live2DCubismCore.Version.csmGetMocVersion(r,t)),i}static delete(t){t._moc._release(),t._moc=null,t=null}createModel(){let t=null;const s=Live2DCubismCore.Model.fromMoc(this._moc);return s&&(t=new ll(s),t.initialize(),++this._modelCount),t}deleteModel(t){t!=null&&(t.release(),t=null,--this._modelCount)}constructor(t){this._moc=t,this._modelCount=0,this._mocVersion=0}release(){zt(this._modelCount==0),this._moc._release(),this._moc=null}getLatestMocVersion(){return Live2DCubismCore.Version.csmGetLatestMocVersion()}getMocVersion(){return this._mocVersion}static hasMocConsistency(t){return Live2DCubismCore.Moc.prototype.hasMocConsistency(t)===1}}var va;(e=>{e.CubismMoc=fi})(va||(va={}));const Pa="Meta",Rg="UserDataCount",Fg="TotalUserDataSize",Li="UserData",Dg="Target",Ag="Id",Lg="Value";class ul{constructor(t,s){this._json=at.create(t,s)}release(){at.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString(Pa).getValueByString(Rg).toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString(Pa).getValueByString(Fg).toInt()}getUserDataTargetType(t){return this._json.getRoot().getValueByString(Li).getValueByIndex(t).getValueByString(Dg).getRawString()}getUserDataId(t){return J.getIdManager().getId(this._json.getRoot().getValueByString(Li).getValueByIndex(t).getValueByString(Ag).getRawString())}getUserDataValue(t){return this._json.getRoot().getValueByString(Li).getValueByIndex(t).getValueByString(Lg).getRawString()}}var Ba;(e=>{e.CubismModelUserDataJson=ul})(Ba||(Ba={}));const Og="ArtMesh";class cl{}class Ss{static create(t,s){const i=new Ss;return i.parseUserData(t,s),i}static delete(t){t!=null&&(t.release(),t=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(t,s){let i=new ul(t,s);if(!i){i.release(),i=void 0;return}const r=J.getIdManager().getId(Og),n=i.getUserDataCount();for(let a=0;a<n;a++){const o=new cl;o.targetId=i.getUserDataId(a),o.targetType=J.getIdManager().getId(i.getUserDataTargetType(a)),o.value=new Pt(i.getUserDataValue(a)),this._userDataNodes.pushBack(o),o.targetType==r&&this._artMeshUserDataNode.pushBack(o)}i.release(),i=void 0}constructor(){this._userDataNodes=new L,this._artMeshUserDataNode=new L}release(){for(let t=0;t<this._userDataNodes.getSize();++t)this._userDataNodes.set(t,null);this._userDataNodes=null}}var Ia;(e=>{e.CubismModelUserData=Ss,e.CubismModelUserDataNode=cl})(Ia||(Ia={}));let kg=class hl{isInitialized(){return this._initialized}setInitialized(t){this._initialized=t}isUpdating(){return this._updating}setUpdating(t){this._updating=t}setDragging(t,s){this._dragManager.set(t,s)}setAcceleration(t,s,i){this._accelerationX=t,this._accelerationY=s,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(t){this._opacity=t}getOpacity(){return this._opacity}loadModel(t,s=!1){if(this._moc=fi.create(t,s),this._moc==null){st("Failed to CubismMoc.create().");return}if(this._model=this._moc.createModel(),this._model==null){st("Failed to CreateModel().");return}this._model.saveParameters(),this._modelMatrix=new Do(this._model.getCanvasWidth(),this._model.getCanvasHeight())}loadMotion(t,s,i,r){return t==null||s==0?(st("Failed to loadMotion()."),null):Wo.create(t,s,r)}loadExpression(t,s,i){return t==null||s==0?(st("Failed to loadExpression()."),null):Oe.create(t,s)}loadPose(t,s){if(t==null||s==0){st("Failed to loadPose().");return}this._pose=xs.create(t,s)}loadUserData(t,s){if(t==null||s==0){st("Failed to loadUserData().");return}this._modelUserData=Ss.create(t,s)}loadPhysics(t,s){if(t==null||s==0){st("Failed to loadPhysics().");return}this._physics=or.create(t,s)}isHit(t,s,i){const r=this._model.getDrawableIndex(t);if(r<0)return!1;const n=this._model.getDrawableVertexCount(r),a=this._model.getDrawableVertices(r);let o=a[0],l=a[0],u=a[1],c=a[1];for(let f=1;f<n;++f){const _=a[ae.vertexOffset+f*ae.vertexStep],x=a[ae.vertexOffset+f*ae.vertexStep+1];_<o&&(o=_),_>l&&(l=_),x<u&&(u=x),x>c&&(c=x)}const g=this._modelMatrix.invertTransformX(s),p=this._modelMatrix.invertTransformY(i);return o<=g&&g<=l&&u<=p&&p<=c}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(t=1){this._renderer&&this.deleteRenderer(),this._renderer=new Or,this._renderer.initialize(this._model,t)}deleteRenderer(){this._renderer!=null&&(this._renderer.release(),this._renderer=null)}motionEventFired(t){re("{0}",t.s)}static cubismDefaultMotionEventCallback(t,s,i){const r=i;r!=null&&r.motionEventFired(s)}constructor(){this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._mocConsistency=!1,this._debugMode=!1,this._renderer=null,this._motionManager=new qo,this._motionManager.setEventCallback(hl.cubismDefaultMotionEventCallback,this),this._expressionManager=new Uo,this._dragManager=new Ao}release(){this._motionManager!=null&&(this._motionManager.release(),this._motionManager=null),this._expressionManager!=null&&(this._expressionManager.release(),this._expressionManager=null),this._moc!=null&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,xs.delete(this._pose),Ro.delete(this._eyeBlink),gi.delete(this._breath),this._dragManager=null,or.delete(this._physics),Ss.delete(this._modelUserData),this.deleteRenderer()}};var cr;(e=>{e.CubismUserModel=kg})(cr||(cr={}));const Se=J;class id extends Zi.ICubismModelSetting{}class Ng extends Qi.CubismModelSettingJson{}class Ug extends Ki.CubismMatrix44{}class zg extends cr.CubismUserModel{}class rd extends er.ACubismMotion{}class nd extends ir.CubismMotion{}class ad extends sr.CubismExpressionMotion{}class od extends rr.CubismMotionManager{}class ld extends lr.CubismPhysics{}class jg extends tr.CubismEyeBlink{}class Ns extends Ji.csmVector{}class Xg extends zg{constructor(){super();gt(this,"motionResources");gt(this,"expressionResources");gt(this,"lipSyncParamIds",new Ns);gt(this,"eyeBlinkParamIds",new Ns);this.motionResources={},this.expressionResources={},this.lipSyncParamIds=new Ns,this.eyeBlinkParamIds=new Ns,this._lipsync=!1}setEyeBlink(s){this._eyeBlink=s}addEyeBlinkParameterId(s){this.eyeBlinkParamIds.pushBack(s)}addLipSyncParameterId(s){this.lipSyncParamIds.pushBack(s)}addMotion(s,i,r=1,n=1){const a=this.loadMotion(s,s.byteLength,i);return r>0&&a.setFadeInTime(r),n>0&&a.setFadeOutTime(n),a.setEffectIds(this.eyeBlinkParamIds,this.lipSyncParamIds),this.motionResources[i]=a,i}addExpression(s,i,r=1,n=1){const a=this.loadExpression(s,s.byteLength,i);return r>0&&a.setFadeInTime(r),n>0&&a.setFadeOutTime(n),this.expressionResources[i]=a,i}get motionNames(){return Object.keys(this.motionResources)}get isMotionFinished(){return this._motionManager.isFinished()}startMotionByName(s){const i=this.motionResources[s];i&&this._motionManager.startMotionPriority(i,!1,0)}startExpressionByName(s){const i=this.expressionResources[s];i&&this._expressionManager.startMotionPriority(i,!1,1)}update(s){this.getModel().loadParameters();const i=this._motionManager.updateMotion(this.getModel(),s),r=this._expressionManager.updateMotion(this.getModel(),s);this.getModel().saveParameters(),!i&&!r&&this._eyeBlink!=null&&this._eyeBlink.updateParameters(this._model,s),this._pose!==null&&this._pose.updateParameters(this._model,0),this._physics!=null&&this._physics.evaluate(this._model,s),this._model.update()}}const Gg={autoBlink:!0,x:0,y:0,scale:1};let Va=!1;class $g{constructor(t){gt(this,"canvas");gt(this,"model",new Xg);gt(this,"point",new Vo);this.canvas=t}async init(t,s,i={}){const r=this.canvas.getContext("webgl");if(r===null)throw new Error("WebGL未対応のブラウザです。");r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.clearColor(0,0,0,0),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL);const n=Object.assign({},Gg,i),a=r.getParameter(r.FRAMEBUFFER_BINDING);Va||(Se.startUp(),Se.initialize(),Va=!0);const o=new Ng(t,t.byteLength),{moc3:l,textures:u,physics:c,expressions:g,motions:p}=s;this.model.loadModel(l),this.model.createRenderer();let f=0;for(const X of u){const Y=await Hg(X,r);this.model.getRenderer().bindTexture(f,Y),f++}this.model.getRenderer().setIsPremultipliedAlpha(!0),this.model.getRenderer().startUp(r),n.autoBlink&&this.model.setEyeBlink(jg.create(o));for(let X=0,Y=o.getEyeBlinkParameterCount();X<Y;X++)this.model.addEyeBlinkParameterId(o.getEyeBlinkParameterId(X));for(let X=0,Y=o.getLipSyncParameterCount();X<Y;X++)this.model.addLipSyncParameterId(o.getLipSyncParameterId(X));this.model.loadPhysics(c,c.byteLength);for(const[X,Y]of g)this.model.addExpression(Y,X);for(const[X,Y]of p)this.model.addMotion(Y,X);const _=Object.assign({x:0,y:0,z:1},{x:n.x,y:n.y,z:n.scale}),x=new Ug,y=()=>{this.canvas.width=this.canvas.clientWidth*devicePixelRatio,this.canvas.height=this.canvas.clientHeight*devicePixelRatio;const X=this.model.getModelMatrix();X.bottom(0),X.centerY(-1),X.translateY(-1),x.loadIdentity(),1<this.canvas.height/this.canvas.width?X.scale(1,this.canvas.width/this.canvas.height):X.scale(this.canvas.height/this.canvas.width,1),X.translateRelative(_.x,_.y),x.multiplyByMatrix(X);const ct=_.z;x.scaleRelative(ct,ct),this.model.getRenderer().setMvpMatrix(x)};y();const v=[0,0,this.canvas.width,this.canvas.height];let M=Date.now();const V=this.model.getModel(),E=Se.getIdManager(),F=()=>{const X=Date.now(),Y=(X-M)/1e3;V.setParameterValueById(E.getId("ParamAngleX"),this.point.angleX,.5),V.setParameterValueById(E.getId("ParamAngleY"),this.point.angleY,.5),V.setParameterValueById(E.getId("ParamAngleZ"),this.point.angleZ,.5),V.setParameterValueById(E.getId("ParamEyeBallX"),this.point.angleEyeX,.5),V.setParameterValueById(E.getId("ParamEyeBallY"),this.point.angleEyeY,.5),V.setParameterValueById(E.getId("ParamBodyAngleZ"),this.point.angleZ/2,.05),V.saveParameters(),this.model.update(Y),v[2]=this.canvas.width,v[3]=this.canvas.height,this.model.getRenderer().setRenderState(a,v),this.model.getRenderer().drawModel(),M=X,requestAnimationFrame(F)};window.addEventListener("resize",()=>{y(),F()}),F();const w=["akubi","akubi","swing","AiArt"],$=()=>{setTimeout(()=>{this.model.isMotionFinished&&this.model.startMotionByName(w[Math.floor(Math.random()*w.length)]),$()},1e3*10+Math.random()*1e3*80)};$();const Z=()=>{setTimeout(()=>{this.model.startMotionByName("mimi"),Z()},1e3*10+Math.random()*1e3*30)};Z()}updatePoint(t){Object.assign(this.point,t)}click(t){const s=this.canvas.getBoundingClientRect(),i=s.left+s.width/2,r=s.top+s.height/2,n=(t.clientX-i)/(s.width/2),a=(t.clientY-r)/(s.height/2);this.model.isHit(Se.getIdManager().getId("HitArea"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Se.getIdManager().getId("HitArea2"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Se.getIdManager().getId("HitArea_Body"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Se.getIdManager().getId("HitArea_Head"),n,a)}}async function Hg(e,t){return new Promise(s=>{const i=URL.createObjectURL(e),r=new Image;r.onload=()=>{const n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.generateMipmap(t.TEXTURE_2D),URL.revokeObjectURL(i),s(n)},r.addEventListener("error",()=>{console.error("image load error")}),r.src=i})}function Wg(e,t,s,i){return Math.sqrt(Math.pow(s-e,2)+Math.pow(i-t,2))}function Yg(e,t,s,i){return Math.atan2(i-t,s-e)}const wa="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js",bt="./misskey/live2d/ai/web/",De={moc3:bt+"ai.moc3",model3:bt+"ai.model3.json",physics3:bt+"ai.physics3.json",textures:[bt+"ai.4096/texture_00.png"],expressions:{smile:bt+"expressions/exp_01.exp3.json",surprise:bt+"expressions/exp_02.exp3.json",happy:bt+"expressions/exp_06.exp3.json",jitome:bt+"expressions/exp_11.exp3.json",gurugurume:bt+"expressions/exp_20.exp3.json"},motions:{swing:bt+"motions/mtn_03.motion3.json",akubi:bt+"motions/mtn_04.motion3.json",mimi:bt+"motions/mtn_05.motion3.json",AiArt:bt+"motions/AiArt.motion3.json"}};let Ta=!1;function qg(e,t){return new Promise((s,i)=>{const r=document.head.querySelector(`script[src="${wa}"]`);if(r)Ta?Oi(e,t).then(n=>{s(n)}):r.addEventListener("load",()=>{Oi(e,t).then(n=>{s(n)})});else{const n=document.createElement("script");n.setAttribute("src",wa),document.head.appendChild(n),n.addEventListener("load",()=>{Ta=!0,Oi(e,t).then(a=>{s(a)})})}})}async function Oi(e,t){try{const[s,i,r,n,a,o]=await Promise.all([fetch(De.model3).then(g=>g.arrayBuffer()),fetch(De.moc3).then(g=>g.arrayBuffer()),fetch(De.physics3).then(g=>g.arrayBuffer()),Promise.all(De.textures.map(g=>fetch(g).then(p=>p.blob()))),Promise.all(Object.entries(De.expressions).map(([g,p])=>fetch(p).then(f=>f.arrayBuffer()).then(f=>[g,f]))),Promise.all(Object.entries(De.motions).map(([g,p])=>fetch(p).then(f=>f.arrayBuffer()).then(f=>[g,f])))]),l=new $g(e);await l.init(s,{moc3:i,physics:r,textures:n,expressions:a,motions:o},{autoBlink:!0,...t}),window.parent.postMessage({type:"loaded",body:null},"*");const u=new Vo,c=g=>{const p=g.x,f=g.y,_=e.getBoundingClientRect(),x=t.eyeX?t.eyeX:_.left+_.width/2,y=t.eyeY?t.eyeY:_.top+_.height/2,v=Yg(p,f,x,y),M=Math.cos(v)*Math.sin(v)*180/Math.PI,V=Wg(p,f,x,y),E=x-p,F=y-f;Object.assign(u,{angleX:-E/10,angleY:F/10,angleZ:M*(V/x)/10,angleEyeX:-E/x/10,angleEyeY:F/y/2}),l.updatePoint(u)};return document.body.addEventListener("mousemove",g=>{c({x:g.clientX,y:g.clientY})},!1),window.addEventListener("message",g=>{const{type:p,body:f}=g.data;switch(p){case"setPos":break;case"moveCursor":c(f);break;default:break}},!1),l}catch(s){alert(s.message),console.error(s)}}const Jg=vu({__name:"App",setup(e,{expose:t}){let s=null;const i=eu(),r=n=>{s&&s.click(n)};return uo(()=>{const n=new URL(window.location.href);qg(i.value,{scale:parseFloat(n.searchParams.get("scale")||"1"),x:parseFloat(n.searchParams.get("x")||"0"),y:parseFloat(n.searchParams.get("y")||"1"),eyeX:n.searchParams.has("eyeX")?parseFloat(n.searchParams.get("eyeX")):void 0,eyeY:n.searchParams.has("eyeY")?parseFloat(n.searchParams.get("eyeY")):void 0}).then(a=>{a&&(s=qa(a))})}),t({canvas:i,touched:r}),(n,a)=>(ec(),rc("canvas",{id:"canvas",ref_key:"canvas",ref:i,onClick:r},null,512))}});Gc(Jg).mount("#app");
