(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();/**
* @vue/shared v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function fr(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return s=>s in t}const Q={},Xe=[],Yt=()=>{},Ma=()=>!1,ai=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),pr=e=>e.startsWith("onUpdate:"),dt=Object.assign,_r=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},_l=Object.prototype.hasOwnProperty,$=(e,t)=>_l.call(e,t),z=Array.isArray,us=e=>oi(e)==="[object Map]",ml=e=>oi(e)==="[object Set]",U=e=>typeof e=="function",ot=e=>typeof e=="string",Ze=e=>typeof e=="symbol",nt=e=>e!==null&&typeof e=="object",va=e=>(nt(e)||U(e))&&U(e.then)&&U(e.catch),yl=Object.prototype.toString,oi=e=>yl.call(e),Cl=e=>oi(e).slice(8,-1),xl=e=>oi(e)==="[object Object]",mr=e=>ot(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,cs=fr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),li=e=>{const t=Object.create(null);return(s=>t[s]||(t[s]=e(s)))},Sl=/-(\w)/g,pe=li(e=>e.replace(Sl,(t,s)=>s?s.toUpperCase():"")),bl=/\B([A-Z])/g,Fe=li(e=>e.replace(bl,"-$1").toLowerCase()),Pa=li(e=>e.charAt(0).toUpperCase()+e.slice(1)),xi=li(e=>e?`on${Pa(e)}`:""),he=(e,t)=>!Object.is(e,t),Si=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},Ba=(e,t,s,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:s})},Ml=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let $r;const ui=()=>$r||($r=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function yr(e){if(z(e)){const t={};for(let s=0;s<e.length;s++){const i=e[s],r=ot(i)?Il(i):yr(i);if(r)for(const n in r)t[n]=r[n]}return t}else if(ot(e)||nt(e))return e}const vl=/;(?![^(]*\))/g,Pl=/:([^]+)/,Bl=/\/\*[^]*?\*\//g;function Il(e){const t={};return e.replace(Bl,"").split(vl).forEach(s=>{if(s){const i=s.split(Pl);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Cr(e){let t="";if(ot(e))t=e;else if(z(e))for(let s=0;s<e.length;s++){const i=Cr(e[s]);i&&(t+=i+" ")}else if(nt(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const Vl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",wl=fr(Vl);function Ia(e){return!!e||e===""}/**
* @vue/reactivity v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let St;class Fl{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=St,!t&&St&&(this.index=(St.scopes||(St.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].pause();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].resume();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].resume()}}run(t){if(this._active){const s=St;try{return St=this,t()}finally{St=s}}}on(){++this._on===1&&(this.prevScope=St,St=this)}off(){this._on>0&&--this._on===0&&(St=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let s,i;for(s=0,i=this.effects.length;s<i;s++)this.effects[s].stop();for(this.effects.length=0,s=0,i=this.cleanups.length;s<i;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function Tl(){return St}let Z;const bi=new WeakSet;class Va{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,St&&St.active&&St.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,bi.has(this)&&(bi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Fa(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Yr(this),Ta(this);const t=Z,s=At;Z=this,At=!0;try{return this.fn()}finally{Ra(this),Z=t,At=s,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)br(t);this.deps=this.depsTail=void 0,Yr(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?bi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){zi(this)&&this.run()}get dirty(){return zi(this)}}let wa=0,hs,gs;function Fa(e,t=!1){if(e.flags|=8,t){e.next=gs,gs=e;return}e.next=hs,hs=e}function xr(){wa++}function Sr(){if(--wa>0)return;if(gs){let t=gs;for(gs=void 0;t;){const s=t.next;t.next=void 0,t.flags&=-9,t=s}}let e;for(;hs;){let t=hs;for(hs=void 0;t;){const s=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=s}}if(e)throw e}function Ta(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ra(e){let t,s=e.depsTail,i=s;for(;i;){const r=i.prevDep;i.version===-1?(i===s&&(s=r),br(i),Rl(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=t,e.depsTail=s}function zi(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ea(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ea(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===xs)||(e.globalVersion=xs,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!zi(e))))return;e.flags|=2;const t=e.dep,s=Z,i=At;Z=e,At=!0;try{Ta(e);const r=e.fn(e._value);(t.version===0||he(r,e._value))&&(e.flags|=128,e._value=r,t.version++)}catch(r){throw t.version++,r}finally{Z=s,At=i,Ra(e),e.flags&=-3}}function br(e,t=!1){const{dep:s,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),s.subs===e&&(s.subs=i,!i&&s.computed)){s.computed.flags&=-5;for(let n=s.computed.deps;n;n=n.nextDep)br(n,!0)}!t&&!--s.sc&&s.map&&s.map.delete(s.key)}function Rl(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let At=!0;const Da=[];function ie(){Da.push(At),At=!1}function re(){const e=Da.pop();At=e===void 0?!0:e}function Yr(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const s=Z;Z=void 0;try{t()}finally{Z=s}}}let xs=0,El=class{constructor(t,s){this.sub=t,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Mr{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Z||!At||Z===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Z)s=this.activeLink=new El(Z,this),Z.deps?(s.prevDep=Z.depsTail,Z.depsTail.nextDep=s,Z.depsTail=s):Z.deps=Z.depsTail=s,Oa(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const i=s.nextDep;i.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=i),s.prevDep=Z.depsTail,s.nextDep=void 0,Z.depsTail.nextDep=s,Z.depsTail=s,Z.deps===s&&(Z.deps=i)}return s}trigger(t){this.version++,xs++,this.notify(t)}notify(t){xr();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Sr()}}}function Oa(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)Oa(i)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const ji=new WeakMap,Be=Symbol(""),Xi=Symbol(""),Ss=Symbol("");function ct(e,t,s){if(At&&Z){let i=ji.get(e);i||ji.set(e,i=new Map);let r=i.get(s);r||(i.set(s,r=new Mr),r.map=i,r.key=s),r.track()}}function ee(e,t,s,i,r,n){const a=ji.get(e);if(!a){xs++;return}const o=l=>{l&&l.trigger()};if(xr(),t==="clear")a.forEach(o);else{const l=z(e),c=l&&mr(s);if(l&&s==="length"){const u=Number(i);a.forEach((h,_)=>{(_==="length"||_===Ss||!Ze(_)&&_>=u)&&o(h)})}else switch((s!==void 0||a.has(void 0))&&o(a.get(s)),c&&o(a.get(Ss)),t){case"add":l?c&&o(a.get("length")):(o(a.get(Be)),us(e)&&o(a.get(Xi)));break;case"delete":l||(o(a.get(Be)),us(e)&&o(a.get(Xi)));break;case"set":us(e)&&o(a.get(Be));break}}Sr()}function Re(e){const t=H(e);return t===e?t:(ct(t,"iterate",Ss),kt(e)?t:t.map(_t))}function vr(e){return ct(e=H(e),"iterate",Ss),e}const Dl={__proto__:null,[Symbol.iterator](){return Mi(this,Symbol.iterator,_t)},concat(...e){return Re(this).concat(...e.map(t=>z(t)?Re(t):t))},entries(){return Mi(this,"entries",e=>(e[1]=_t(e[1]),e))},every(e,t){return Jt(this,"every",e,t,void 0,arguments)},filter(e,t){return Jt(this,"filter",e,t,s=>s.map(_t),arguments)},find(e,t){return Jt(this,"find",e,t,_t,arguments)},findIndex(e,t){return Jt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Jt(this,"findLast",e,t,_t,arguments)},findLastIndex(e,t){return Jt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Jt(this,"forEach",e,t,void 0,arguments)},includes(...e){return vi(this,"includes",e)},indexOf(...e){return vi(this,"indexOf",e)},join(e){return Re(this).join(e)},lastIndexOf(...e){return vi(this,"lastIndexOf",e)},map(e,t){return Jt(this,"map",e,t,void 0,arguments)},pop(){return ss(this,"pop")},push(...e){return ss(this,"push",e)},reduce(e,...t){return qr(this,"reduce",e,t)},reduceRight(e,...t){return qr(this,"reduceRight",e,t)},shift(){return ss(this,"shift")},some(e,t){return Jt(this,"some",e,t,void 0,arguments)},splice(...e){return ss(this,"splice",e)},toReversed(){return Re(this).toReversed()},toSorted(e){return Re(this).toSorted(e)},toSpliced(...e){return Re(this).toSpliced(...e)},unshift(...e){return ss(this,"unshift",e)},values(){return Mi(this,"values",_t)}};function Mi(e,t,s){const i=vr(e),r=i[t]();return i!==e&&!kt(e)&&(r._next=r.next,r.next=()=>{const n=r._next();return n.value&&(n.value=s(n.value)),n}),r}const Ol=Array.prototype;function Jt(e,t,s,i,r,n){const a=vr(e),o=a!==e&&!kt(e),l=a[t];if(l!==Ol[t]){const h=l.apply(e,n);return o?_t(h):h}let c=s;a!==e&&(o?c=function(h,_){return s.call(this,_t(h),_,e)}:s.length>2&&(c=function(h,_){return s.call(this,h,_,e)}));const u=l.call(a,c,i);return o&&r?r(u):u}function qr(e,t,s,i){const r=vr(e);let n=s;return r!==e&&(kt(e)?s.length>3&&(n=function(a,o,l){return s.call(this,a,o,l,e)}):n=function(a,o,l){return s.call(this,a,_t(o),l,e)}),r[t](n,...i)}function vi(e,t,s){const i=H(e);ct(i,"iterate",Ss);const r=i[t](...s);return(r===-1||r===!1)&&Vr(s[0])?(s[0]=H(s[0]),i[t](...s)):r}function ss(e,t,s=[]){ie(),xr();const i=H(e)[t].apply(e,s);return Sr(),re(),i}const Ll=fr("__proto__,__v_isRef,__isVue"),La=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ze));function Al(e){Ze(e)||(e=String(e));const t=H(this);return ct(t,"has",e),t.hasOwnProperty(e)}class Aa{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,i){if(s==="__v_skip")return t.__v_skip;const r=this._isReadonly,n=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return n;if(s==="__v_raw")return i===(r?n?$l:za:n?Ua:Na).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const a=z(t);if(!r){let l;if(a&&(l=Dl[s]))return l;if(s==="hasOwnProperty")return Al}const o=Reflect.get(t,s,gt(t)?t:i);return(Ze(s)?La.has(s):Ll(s))||(r||ct(t,"get",s),n)?o:gt(o)?a&&mr(s)?o:o.value:nt(o)?r?ja(o):Br(o):o}}class ka extends Aa{constructor(t=!1){super(!1,t)}set(t,s,i,r){let n=t[s];if(!this._isShallow){const l=we(n);if(!kt(i)&&!we(i)&&(n=H(n),i=H(i)),!z(t)&&gt(n)&&!gt(i))return l||(n.value=i),!0}const a=z(t)&&mr(s)?Number(s)<t.length:$(t,s),o=Reflect.set(t,s,i,gt(t)?t:r);return t===H(r)&&(a?he(i,n)&&ee(t,"set",s,i):ee(t,"add",s,i)),o}deleteProperty(t,s){const i=$(t,s);t[s];const r=Reflect.deleteProperty(t,s);return r&&i&&ee(t,"delete",s,void 0),r}has(t,s){const i=Reflect.has(t,s);return(!Ze(s)||!La.has(s))&&ct(t,"has",s),i}ownKeys(t){return ct(t,"iterate",z(t)?"length":Be),Reflect.ownKeys(t)}}class kl extends Aa{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const Nl=new ka,Ul=new kl,zl=new ka(!0);const Gi=e=>e,Os=e=>Reflect.getPrototypeOf(e);function jl(e,t,s){return function(...i){const r=this.__v_raw,n=H(r),a=us(n),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=r[e](...i),u=s?Gi:t?Wi:_t;return!t&&ct(n,"iterate",l?Xi:Be),{next(){const{value:h,done:_}=c.next();return _?{value:h,done:_}:{value:o?[u(h[0]),u(h[1])]:u(h),done:_}},[Symbol.iterator](){return this}}}}function Ls(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Xl(e,t){const s={get(r){const n=this.__v_raw,a=H(n),o=H(r);e||(he(r,o)&&ct(a,"get",r),ct(a,"get",o));const{has:l}=Os(a),c=t?Gi:e?Wi:_t;if(l.call(a,r))return c(n.get(r));if(l.call(a,o))return c(n.get(o));n!==a&&n.get(r)},get size(){const r=this.__v_raw;return!e&&ct(H(r),"iterate",Be),r.size},has(r){const n=this.__v_raw,a=H(n),o=H(r);return e||(he(r,o)&&ct(a,"has",r),ct(a,"has",o)),r===o?n.has(r):n.has(r)||n.has(o)},forEach(r,n){const a=this,o=a.__v_raw,l=H(o),c=t?Gi:e?Wi:_t;return!e&&ct(l,"iterate",Be),o.forEach((u,h)=>r.call(n,c(u),c(h),a))}};return dt(s,e?{add:Ls("add"),set:Ls("set"),delete:Ls("delete"),clear:Ls("clear")}:{add(r){!t&&!kt(r)&&!we(r)&&(r=H(r));const n=H(this);return Os(n).has.call(n,r)||(n.add(r),ee(n,"add",r,r)),this},set(r,n){!t&&!kt(n)&&!we(n)&&(n=H(n));const a=H(this),{has:o,get:l}=Os(a);let c=o.call(a,r);c||(r=H(r),c=o.call(a,r));const u=l.call(a,r);return a.set(r,n),c?he(n,u)&&ee(a,"set",r,n):ee(a,"add",r,n),this},delete(r){const n=H(this),{has:a,get:o}=Os(n);let l=a.call(n,r);l||(r=H(r),l=a.call(n,r)),o&&o.call(n,r);const c=n.delete(r);return l&&ee(n,"delete",r,void 0),c},clear(){const r=H(this),n=r.size!==0,a=r.clear();return n&&ee(r,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(r=>{s[r]=jl(r,e,t)}),s}function Pr(e,t){const s=Xl(e,t);return(i,r,n)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get($(s,r)&&r in i?s:i,r,n)}const Gl={get:Pr(!1,!1)},Wl={get:Pr(!1,!0)},Hl={get:Pr(!0,!1)};const Na=new WeakMap,Ua=new WeakMap,za=new WeakMap,$l=new WeakMap;function Yl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ql(e){return e.__v_skip||!Object.isExtensible(e)?0:Yl(Cl(e))}function Br(e){return we(e)?e:Ir(e,!1,Nl,Gl,Na)}function Jl(e){return Ir(e,!1,zl,Wl,Ua)}function ja(e){return Ir(e,!0,Ul,Hl,za)}function Ir(e,t,s,i,r){if(!nt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const n=ql(e);if(n===0)return e;const a=r.get(e);if(a)return a;const o=new Proxy(e,n===2?i:s);return r.set(e,o),o}function ds(e){return we(e)?ds(e.__v_raw):!!(e&&e.__v_isReactive)}function we(e){return!!(e&&e.__v_isReadonly)}function kt(e){return!!(e&&e.__v_isShallow)}function Vr(e){return e?!!e.__v_raw:!1}function H(e){const t=e&&e.__v_raw;return t?H(t):e}function Xa(e){return!$(e,"__v_skip")&&Object.isExtensible(e)&&Ba(e,"__v_skip",!0),e}const _t=e=>nt(e)?Br(e):e,Wi=e=>nt(e)?ja(e):e;function gt(e){return e?e.__v_isRef===!0:!1}function Kl(e){return Zl(e,!1)}function Zl(e,t){return gt(e)?e:new Ql(e,t)}class Ql{constructor(t,s){this.dep=new Mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?t:H(t),this._value=s?t:_t(t),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(t){const s=this._rawValue,i=this.__v_isShallow||kt(t)||we(t);t=i?t:H(t),he(t,s)&&(this._rawValue=t,this._value=i?t:_t(t),this.dep.trigger())}}function tu(e){return gt(e)?e.value:e}const eu={get:(e,t,s)=>t==="__v_raw"?e:tu(Reflect.get(e,t,s)),set:(e,t,s,i)=>{const r=e[t];return gt(r)&&!gt(s)?(r.value=s,!0):Reflect.set(e,t,s,i)}};function Ga(e){return ds(e)?e:new Proxy(e,eu)}class su{constructor(t,s,i){this.fn=t,this.setter=s,this._value=void 0,this.dep=new Mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=xs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&Z!==this)return Fa(this,!0),!0}get value(){const t=this.dep.track();return Ea(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function iu(e,t,s=!1){let i,r;return U(e)?i=e:(i=e.get,r=e.set),new su(i,r,s)}const As={},qs=new WeakMap;let ve;function ru(e,t=!1,s=ve){if(s){let i=qs.get(s);i||qs.set(s,i=[]),i.push(e)}}function nu(e,t,s=Q){const{immediate:i,deep:r,once:n,scheduler:a,augmentJob:o,call:l}=s,c=x=>r?x:kt(x)||r===!1||r===0?ue(x,1):ue(x);let u,h,_,d,p=!1,y=!1;if(gt(e)?(h=()=>e.value,p=kt(e)):ds(e)?(h=()=>c(e),p=!0):z(e)?(y=!0,p=e.some(x=>ds(x)||kt(x)),h=()=>e.map(x=>{if(gt(x))return x.value;if(ds(x))return c(x);if(U(x))return l?l(x,2):x()})):U(e)?t?h=l?()=>l(e,2):e:h=()=>{if(_){ie();try{_()}finally{re()}}const x=ve;ve=u;try{return l?l(e,3,[d]):e(d)}finally{ve=x}}:h=Yt,t&&r){const x=h,R=r===!0?1/0:r;h=()=>ue(x(),R)}const m=Tl(),I=()=>{u.stop(),m&&m.active&&_r(m.effects,u)};if(n&&t){const x=t;t=(...R)=>{x(...R),I()}}let T=y?new Array(e.length).fill(As):As;const b=x=>{if(!(!(u.flags&1)||!u.dirty&&!x))if(t){const R=u.run();if(r||p||(y?R.some((N,W)=>he(N,T[W])):he(R,T))){_&&_();const N=ve;ve=u;try{const W=[R,T===As?void 0:y&&T[0]===As?[]:T,d];T=R,l?l(t,3,W):t(...W)}finally{ve=N}}}else u.run()};return o&&o(b),u=new Va(h),u.scheduler=a?()=>a(b,!1):b,d=x=>ru(x,!1,u),_=u.onStop=()=>{const x=qs.get(u);if(x){if(l)l(x,4);else for(const R of x)R();qs.delete(u)}},t?i?b(!0):T=u.run():a?a(b.bind(null,!0),!0):u.run(),I.pause=u.pause.bind(u),I.resume=u.resume.bind(u),I.stop=I,I}function ue(e,t=1/0,s){if(t<=0||!nt(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),t--,gt(e))ue(e.value,t,s);else if(z(e))for(let i=0;i<e.length;i++)ue(e[i],t,s);else if(ml(e)||us(e))e.forEach(i=>{ue(i,t,s)});else if(xl(e)){for(const i in e)ue(e[i],t,s);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&ue(e[i],t,s)}return e}/**
* @vue/runtime-core v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ts(e,t,s,i){try{return i?e(...i):e()}catch(r){ci(r,t,s)}}function qt(e,t,s,i){if(U(e)){const r=Ts(e,t,s,i);return r&&va(r)&&r.catch(n=>{ci(n,t,s)}),r}if(z(e)){const r=[];for(let n=0;n<e.length;n++)r.push(qt(e[n],t,s,i));return r}}function ci(e,t,s,i=!0){const r=t?t.vnode:null,{errorHandler:n,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Q;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${s}`;for(;o;){const u=o.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](e,l,c)===!1)return}o=o.parent}if(n){ie(),Ts(n,null,10,[e,l,c]),re();return}}au(e,s,r,i,a)}function au(e,t,s,i=!0,r=!1){if(r)throw e;console.error(e)}const mt=[];let Wt=-1;const Ge=[];let ae=null,ke=0;const Wa=Promise.resolve();let Js=null;function ou(e){const t=Js||Wa;return e?t.then(this?e.bind(this):e):t}function lu(e){let t=Wt+1,s=mt.length;for(;t<s;){const i=t+s>>>1,r=mt[i],n=bs(r);n<e||n===e&&r.flags&2?t=i+1:s=i}return t}function wr(e){if(!(e.flags&1)){const t=bs(e),s=mt[mt.length-1];!s||!(e.flags&2)&&t>=bs(s)?mt.push(e):mt.splice(lu(t),0,e),e.flags|=1,Ha()}}function Ha(){Js||(Js=Wa.then(Ya))}function uu(e){z(e)?Ge.push(...e):ae&&e.id===-1?ae.splice(ke+1,0,e):e.flags&1||(Ge.push(e),e.flags|=1),Ha()}function Jr(e,t,s=Wt+1){for(;s<mt.length;s++){const i=mt[s];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;mt.splice(s,1),s--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function $a(e){if(Ge.length){const t=[...new Set(Ge)].sort((s,i)=>bs(s)-bs(i));if(Ge.length=0,ae){ae.push(...t);return}for(ae=t,ke=0;ke<ae.length;ke++){const s=ae[ke];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}ae=null,ke=0}}const bs=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Ya(e){try{for(Wt=0;Wt<mt.length;Wt++){const t=mt[Wt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ts(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Wt<mt.length;Wt++){const t=mt[Wt];t&&(t.flags&=-2)}Wt=-1,mt.length=0,$a(),Js=null,(mt.length||Ge.length)&&Ya()}}let $t=null,qa=null;function Ks(e){const t=$t;return $t=e,qa=e&&e.type.__scopeId||null,t}function cu(e,t=$t,s){if(!t||e._n)return e;const i=(...r)=>{i._d&&an(-1);const n=Ks(t);let a;try{a=e(...r)}finally{Ks(n),i._d&&an(1)}return a};return i._n=!0,i._c=!0,i._d=!0,i}function Ce(e,t,s,i){const r=e.dirs,n=t&&t.dirs;for(let a=0;a<r.length;a++){const o=r[a];n&&(o.oldValue=n[a].value);let l=o.dir[i];l&&(ie(),qt(l,s,8,[e.el,o,e,t]),re())}}const hu=Symbol("_vte"),gu=e=>e.__isTeleport,du=Symbol("_leaveCb");function Fr(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Fr(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function fu(e,t){return U(e)?dt({name:e.name},t,{setup:e}):e}function Ja(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function fs(e,t,s,i,r=!1){if(z(e)){e.forEach((p,y)=>fs(p,t&&(z(t)?t[y]:t),s,i,r));return}if(ps(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&fs(e,t,s,i.component.subTree);return}const n=i.shapeFlag&4?Dr(i.component):i.el,a=r?null:n,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Q?o.refs={}:o.refs,h=o.setupState,_=H(h),d=h===Q?Ma:p=>$(_,p);if(c!=null&&c!==l){if(ot(c))u[c]=null,d(c)&&(h[c]=null);else if(gt(c)){c.value=null;const p=t;p.k&&(u[p.k]=null)}}if(U(l))Ts(l,o,12,[a,u]);else{const p=ot(l),y=gt(l);if(p||y){const m=()=>{if(e.f){const I=p?d(l)?h[l]:u[l]:l.value;if(r)z(I)&&_r(I,n);else if(z(I))I.includes(n)||I.push(n);else if(p)u[l]=[n],d(l)&&(h[l]=u[l]);else{const T=[n];l.value=T,e.k&&(u[e.k]=T)}}else p?(u[l]=a,d(l)&&(h[l]=a)):y&&(l.value=a,e.k&&(u[e.k]=a))};a?(m.id=-1,It(m,s)):m()}}}ui().requestIdleCallback;ui().cancelIdleCallback;const ps=e=>!!e.type.__asyncLoader,Ka=e=>e.type.__isKeepAlive;function pu(e,t){Za(e,"a",t)}function _u(e,t){Za(e,"da",t)}function Za(e,t,s=yt){const i=e.__wdc||(e.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(hi(t,i,s),s){let r=s.parent;for(;r&&r.parent;)Ka(r.parent.vnode)&&mu(i,t,s,r),r=r.parent}}function mu(e,t,s,i){const r=hi(t,e,i,!0);to(()=>{_r(i[t],r)},s)}function hi(e,t,s=yt,i=!1){if(s){const r=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...a)=>{ie();const o=Rs(s),l=qt(t,s,e,a);return o(),re(),l});return i?r.unshift(n):r.push(n),n}}const ne=e=>(t,s=yt)=>{(!vs||e==="sp")&&hi(e,(...i)=>t(...i),s)},yu=ne("bm"),Qa=ne("m"),Cu=ne("bu"),xu=ne("u"),Su=ne("bum"),to=ne("um"),bu=ne("sp"),Mu=ne("rtg"),vu=ne("rtc");function Pu(e,t=yt){hi("ec",e,t)}const Bu=Symbol.for("v-ndc"),Hi=e=>e?bo(e)?Dr(e):Hi(e.parent):null,_s=dt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Hi(e.parent),$root:e=>Hi(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>so(e),$forceUpdate:e=>e.f||(e.f=()=>{wr(e.update)}),$nextTick:e=>e.n||(e.n=ou.bind(e.proxy)),$watch:e=>Yu.bind(e)}),Pi=(e,t)=>e!==Q&&!e.__isScriptSetup&&$(e,t),Iu={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:i,data:r,props:n,accessCache:a,type:o,appContext:l}=e;let c;if(t[0]!=="$"){const d=a[t];if(d!==void 0)switch(d){case 1:return i[t];case 2:return r[t];case 4:return s[t];case 3:return n[t]}else{if(Pi(i,t))return a[t]=1,i[t];if(r!==Q&&$(r,t))return a[t]=2,r[t];if((c=e.propsOptions[0])&&$(c,t))return a[t]=3,n[t];if(s!==Q&&$(s,t))return a[t]=4,s[t];$i&&(a[t]=0)}}const u=_s[t];let h,_;if(u)return t==="$attrs"&&ct(e.attrs,"get",""),u(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(s!==Q&&$(s,t))return a[t]=4,s[t];if(_=l.config.globalProperties,$(_,t))return _[t]},set({_:e},t,s){const{data:i,setupState:r,ctx:n}=e;return Pi(r,t)?(r[t]=s,!0):i!==Q&&$(i,t)?(i[t]=s,!0):$(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(n[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:i,appContext:r,propsOptions:n,type:a}},o){let l,c;return!!(s[o]||e!==Q&&o[0]!=="$"&&$(e,o)||Pi(t,o)||(l=n[0])&&$(l,o)||$(i,o)||$(_s,o)||$(r.config.globalProperties,o)||(c=a.__cssModules)&&c[o])},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:$(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function Kr(e){return z(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let $i=!0;function Vu(e){const t=so(e),s=e.proxy,i=e.ctx;$i=!1,t.beforeCreate&&Zr(t.beforeCreate,e,"bc");const{data:r,computed:n,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:_,beforeUpdate:d,updated:p,activated:y,deactivated:m,beforeDestroy:I,beforeUnmount:T,destroyed:b,unmounted:x,render:R,renderTracked:N,renderTriggered:W,errorCaptured:rt,serverPrefetch:j,expose:q,inheritAttrs:Rt,components:_e,directives:Te,filters:yi}=t;if(c&&wu(c,i,null),a)for(const st in a){const J=a[st];U(J)&&(i[st]=J.bind(s))}if(r){const st=r.call(s,s);nt(st)&&(e.data=Br(st))}if($i=!0,n)for(const st in n){const J=n[st],me=U(J)?J.bind(s,s):U(J.get)?J.get.bind(s,s):Yt,Es=!U(J)&&U(J.set)?J.set.bind(s):Yt,ye=Cc({get:me,set:Es});Object.defineProperty(i,st,{enumerable:!0,configurable:!0,get:()=>ye.value,set:Nt=>ye.value=Nt})}if(o)for(const st in o)eo(o[st],i,s,st);if(l){const st=U(l)?l.call(s):l;Reflect.ownKeys(st).forEach(J=>{Ou(J,st[J])})}u&&Zr(u,e,"c");function ft(st,J){z(J)?J.forEach(me=>st(me.bind(s))):J&&st(J.bind(s))}if(ft(yu,h),ft(Qa,_),ft(Cu,d),ft(xu,p),ft(pu,y),ft(_u,m),ft(Pu,rt),ft(vu,N),ft(Mu,W),ft(Su,T),ft(to,x),ft(bu,j),z(q))if(q.length){const st=e.exposed||(e.exposed={});q.forEach(J=>{Object.defineProperty(st,J,{get:()=>s[J],set:me=>s[J]=me,enumerable:!0})})}else e.exposed||(e.exposed={});R&&e.render===Yt&&(e.render=R),Rt!=null&&(e.inheritAttrs=Rt),_e&&(e.components=_e),Te&&(e.directives=Te),j&&Ja(e)}function wu(e,t,s=Yt){z(e)&&(e=Yi(e));for(const i in e){const r=e[i];let n;nt(r)?"default"in r?n=Ws(r.from||i,r.default,!0):n=Ws(r.from||i):n=Ws(r),gt(n)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>n.value,set:a=>n.value=a}):t[i]=n}}function Zr(e,t,s){qt(z(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,s)}function eo(e,t,s,i){let r=i.includes(".")?_o(s,i):()=>s[i];if(ot(e)){const n=t[e];U(n)&&Ii(r,n)}else if(U(e))Ii(r,e.bind(s));else if(nt(e))if(z(e))e.forEach(n=>eo(n,t,s,i));else{const n=U(e.handler)?e.handler.bind(s):t[e.handler];U(n)&&Ii(r,n,e)}}function so(e){const t=e.type,{mixins:s,extends:i}=t,{mixins:r,optionsCache:n,config:{optionMergeStrategies:a}}=e.appContext,o=n.get(t);let l;return o?l=o:!r.length&&!s&&!i?l=t:(l={},r.length&&r.forEach(c=>Zs(l,c,a,!0)),Zs(l,t,a)),nt(t)&&n.set(t,l),l}function Zs(e,t,s,i=!1){const{mixins:r,extends:n}=t;n&&Zs(e,n,s,!0),r&&r.forEach(a=>Zs(e,a,s,!0));for(const a in t)if(!(i&&a==="expose")){const o=Fu[a]||s&&s[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const Fu={data:Qr,props:tn,emits:tn,methods:os,computed:os,beforeCreate:pt,created:pt,beforeMount:pt,mounted:pt,beforeUpdate:pt,updated:pt,beforeDestroy:pt,beforeUnmount:pt,destroyed:pt,unmounted:pt,activated:pt,deactivated:pt,errorCaptured:pt,serverPrefetch:pt,components:os,directives:os,watch:Ru,provide:Qr,inject:Tu};function Qr(e,t){return t?e?function(){return dt(U(e)?e.call(this,this):e,U(t)?t.call(this,this):t)}:t:e}function Tu(e,t){return os(Yi(e),Yi(t))}function Yi(e){if(z(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function pt(e,t){return e?[...new Set([].concat(e,t))]:t}function os(e,t){return e?dt(Object.create(null),e,t):t}function tn(e,t){return e?z(e)&&z(t)?[...new Set([...e,...t])]:dt(Object.create(null),Kr(e),Kr(t??{})):t}function Ru(e,t){if(!e)return t;if(!t)return e;const s=dt(Object.create(null),e);for(const i in t)s[i]=pt(e[i],t[i]);return s}function io(){return{app:null,config:{isNativeTag:Ma,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Eu=0;function Du(e,t){return function(i,r=null){U(i)||(i=dt({},i)),r!=null&&!nt(r)&&(r=null);const n=io(),a=new WeakSet,o=[];let l=!1;const c=n.app={_uid:Eu++,_component:i,_props:r,_container:null,_context:n,_instance:null,version:xc,get config(){return n.config},set config(u){},use(u,...h){return a.has(u)||(u&&U(u.install)?(a.add(u),u.install(c,...h)):U(u)&&(a.add(u),u(c,...h))),c},mixin(u){return n.mixins.includes(u)||n.mixins.push(u),c},component(u,h){return h?(n.components[u]=h,c):n.components[u]},directive(u,h){return h?(n.directives[u]=h,c):n.directives[u]},mount(u,h,_){if(!l){const d=c._ceVNode||Ie(i,r);return d.appContext=n,_===!0?_="svg":_===!1&&(_=void 0),e(d,u,_),l=!0,c._container=u,u.__vue_app__=c,Dr(d.component)}},onUnmount(u){o.push(u)},unmount(){l&&(qt(o,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(u,h){return n.provides[u]=h,c},runWithContext(u){const h=We;We=c;try{return u()}finally{We=h}}};return c}}let We=null;function Ou(e,t){if(yt){let s=yt.provides;const i=yt.parent&&yt.parent.provides;i===s&&(s=yt.provides=Object.create(i)),s[e]=t}}function Ws(e,t,s=!1){const i=dc();if(i||We){let r=We?We._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return s&&U(t)?t.call(i&&i.proxy):t}}const ro={},no=()=>Object.create(ro),ao=e=>Object.getPrototypeOf(e)===ro;function Lu(e,t,s,i=!1){const r={},n=no();e.propsDefaults=Object.create(null),oo(e,t,r,n);for(const a in e.propsOptions[0])a in r||(r[a]=void 0);s?e.props=i?r:Jl(r):e.type.props?e.props=r:e.props=n,e.attrs=n}function Au(e,t,s,i){const{props:r,attrs:n,vnode:{patchFlag:a}}=e,o=H(r),[l]=e.propsOptions;let c=!1;if((i||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let _=u[h];if(gi(e.emitsOptions,_))continue;const d=t[_];if(l)if($(n,_))d!==n[_]&&(n[_]=d,c=!0);else{const p=pe(_);r[p]=qi(l,o,p,d,e,!1)}else d!==n[_]&&(n[_]=d,c=!0)}}}else{oo(e,t,r,n)&&(c=!0);let u;for(const h in o)(!t||!$(t,h)&&((u=Fe(h))===h||!$(t,u)))&&(l?s&&(s[h]!==void 0||s[u]!==void 0)&&(r[h]=qi(l,o,h,void 0,e,!0)):delete r[h]);if(n!==o)for(const h in n)(!t||!$(t,h))&&(delete n[h],c=!0)}c&&ee(e.attrs,"set","")}function oo(e,t,s,i){const[r,n]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(cs(l))continue;const c=t[l];let u;r&&$(r,u=pe(l))?!n||!n.includes(u)?s[u]=c:(o||(o={}))[u]=c:gi(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,a=!0)}if(n){const l=H(s),c=o||Q;for(let u=0;u<n.length;u++){const h=n[u];s[h]=qi(r,l,h,c[h],e,!$(c,h))}}return a}function qi(e,t,s,i,r,n){const a=e[s];if(a!=null){const o=$(a,"default");if(o&&i===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&U(l)){const{propsDefaults:c}=r;if(s in c)i=c[s];else{const u=Rs(r);i=c[s]=l.call(null,t),u()}}else i=l;r.ce&&r.ce._setProp(s,i)}a[0]&&(n&&!o?i=!1:a[1]&&(i===""||i===Fe(s))&&(i=!0))}return i}const ku=new WeakMap;function lo(e,t,s=!1){const i=s?ku:t.propsCache,r=i.get(e);if(r)return r;const n=e.props,a={},o=[];let l=!1;if(!U(e)){const u=h=>{l=!0;const[_,d]=lo(h,t,!0);dt(a,_),d&&o.push(...d)};!s&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!n&&!l)return nt(e)&&i.set(e,Xe),Xe;if(z(n))for(let u=0;u<n.length;u++){const h=pe(n[u]);en(h)&&(a[h]=Q)}else if(n)for(const u in n){const h=pe(u);if(en(h)){const _=n[u],d=a[h]=z(_)||U(_)?{type:_}:dt({},_),p=d.type;let y=!1,m=!0;if(z(p))for(let I=0;I<p.length;++I){const T=p[I],b=U(T)&&T.name;if(b==="Boolean"){y=!0;break}else b==="String"&&(m=!1)}else y=U(p)&&p.name==="Boolean";d[0]=y,d[1]=m,(y||$(d,"default"))&&o.push(h)}}const c=[a,o];return nt(e)&&i.set(e,c),c}function en(e){return e[0]!=="$"&&!cs(e)}const Tr=e=>e==="_"||e==="_ctx"||e==="$stable",Rr=e=>z(e)?e.map(Ht):[Ht(e)],Nu=(e,t,s)=>{if(t._n)return t;const i=cu((...r)=>Rr(t(...r)),s);return i._c=!1,i},uo=(e,t,s)=>{const i=e._ctx;for(const r in e){if(Tr(r))continue;const n=e[r];if(U(n))t[r]=Nu(r,n,i);else if(n!=null){const a=Rr(n);t[r]=()=>a}}},co=(e,t)=>{const s=Rr(t);e.slots.default=()=>s},ho=(e,t,s)=>{for(const i in t)(s||!Tr(i))&&(e[i]=t[i])},Uu=(e,t,s)=>{const i=e.slots=no();if(e.vnode.shapeFlag&32){const r=t._;r?(ho(i,t,s),s&&Ba(i,"_",r,!0)):uo(t,i)}else t&&co(e,t)},zu=(e,t,s)=>{const{vnode:i,slots:r}=e;let n=!0,a=Q;if(i.shapeFlag&32){const o=t._;o?s&&o===1?n=!1:ho(r,t,s):(n=!t.$stable,uo(t,r)),a=t}else t&&(co(e,t),a={default:1});if(n)for(const o in r)!Tr(o)&&a[o]==null&&delete r[o]},It=ec;function ju(e){return Xu(e)}function Xu(e,t){const s=ui();s.__VUE__=!0;const{insert:i,remove:r,patchProp:n,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:_,setScopeId:d=Yt,insertStaticContent:p}=e,y=(g,f,C,v=null,S=null,M=null,w=void 0,V=null,B=!!f.dynamicChildren)=>{if(g===f)return;g&&!is(g,f)&&(v=Ds(g),Nt(g,S,M,!0),g=null),f.patchFlag===-2&&(B=!1,f.dynamicChildren=null);const{type:P,ref:L,shapeFlag:F}=f;switch(P){case di:m(g,f,C,v);break;case qe:I(g,f,C,v);break;case Vi:g==null&&T(f,C,v,w);break;case te:_e(g,f,C,v,S,M,w,V,B);break;default:F&1?R(g,f,C,v,S,M,w,V,B):F&6?Te(g,f,C,v,S,M,w,V,B):(F&64||F&128)&&P.process(g,f,C,v,S,M,w,V,B,ts)}L!=null&&S?fs(L,g&&g.ref,M,f||g,!f):L==null&&g&&g.ref!=null&&fs(g.ref,null,M,g,!0)},m=(g,f,C,v)=>{if(g==null)i(f.el=o(f.children),C,v);else{const S=f.el=g.el;f.children!==g.children&&c(S,f.children)}},I=(g,f,C,v)=>{g==null?i(f.el=l(f.children||""),C,v):f.el=g.el},T=(g,f,C,v)=>{[g.el,g.anchor]=p(g.children,f,C,v,g.el,g.anchor)},b=({el:g,anchor:f},C,v)=>{let S;for(;g&&g!==f;)S=_(g),i(g,C,v),g=S;i(f,C,v)},x=({el:g,anchor:f})=>{let C;for(;g&&g!==f;)C=_(g),r(g),g=C;r(f)},R=(g,f,C,v,S,M,w,V,B)=>{f.type==="svg"?w="svg":f.type==="math"&&(w="mathml"),g==null?N(f,C,v,S,M,w,V,B):j(g,f,S,M,w,V,B)},N=(g,f,C,v,S,M,w,V)=>{let B,P;const{props:L,shapeFlag:F,transition:O,dirs:k}=g;if(B=g.el=a(g.type,M,L&&L.is,L),F&8?u(B,g.children):F&16&&rt(g.children,B,null,v,S,Bi(g,M),w,V),k&&Ce(g,null,v,"created"),W(B,g,g.scopeId,w,v),L){for(const K in L)K!=="value"&&!cs(K)&&n(B,K,null,L[K],M,v);"value"in L&&n(B,"value",null,L.value,M),(P=L.onVnodeBeforeMount)&&Xt(P,v,g)}k&&Ce(g,null,v,"beforeMount");const X=Gu(S,O);X&&O.beforeEnter(B),i(B,f,C),((P=L&&L.onVnodeMounted)||X||k)&&It(()=>{P&&Xt(P,v,g),X&&O.enter(B),k&&Ce(g,null,v,"mounted")},S)},W=(g,f,C,v,S)=>{if(C&&d(g,C),v)for(let M=0;M<v.length;M++)d(g,v[M]);if(S){let M=S.subTree;if(f===M||yo(M.type)&&(M.ssContent===f||M.ssFallback===f)){const w=S.vnode;W(g,w,w.scopeId,w.slotScopeIds,S.parent)}}},rt=(g,f,C,v,S,M,w,V,B=0)=>{for(let P=B;P<g.length;P++){const L=g[P]=V?oe(g[P]):Ht(g[P]);y(null,L,f,C,v,S,M,w,V)}},j=(g,f,C,v,S,M,w)=>{const V=f.el=g.el;let{patchFlag:B,dynamicChildren:P,dirs:L}=f;B|=g.patchFlag&16;const F=g.props||Q,O=f.props||Q;let k;if(C&&xe(C,!1),(k=O.onVnodeBeforeUpdate)&&Xt(k,C,f,g),L&&Ce(f,g,C,"beforeUpdate"),C&&xe(C,!0),(F.innerHTML&&O.innerHTML==null||F.textContent&&O.textContent==null)&&u(V,""),P?q(g.dynamicChildren,P,V,C,v,Bi(f,S),M):w||J(g,f,V,null,C,v,Bi(f,S),M,!1),B>0){if(B&16)Rt(V,F,O,C,S);else if(B&2&&F.class!==O.class&&n(V,"class",null,O.class,S),B&4&&n(V,"style",F.style,O.style,S),B&8){const X=f.dynamicProps;for(let K=0;K<X.length;K++){const Y=X[K],Ct=F[Y],xt=O[Y];(xt!==Ct||Y==="value")&&n(V,Y,Ct,xt,S,C)}}B&1&&g.children!==f.children&&u(V,f.children)}else!w&&P==null&&Rt(V,F,O,C,S);((k=O.onVnodeUpdated)||L)&&It(()=>{k&&Xt(k,C,f,g),L&&Ce(f,g,C,"updated")},v)},q=(g,f,C,v,S,M,w)=>{for(let V=0;V<f.length;V++){const B=g[V],P=f[V],L=B.el&&(B.type===te||!is(B,P)||B.shapeFlag&198)?h(B.el):C;y(B,P,L,null,v,S,M,w,!0)}},Rt=(g,f,C,v,S)=>{if(f!==C){if(f!==Q)for(const M in f)!cs(M)&&!(M in C)&&n(g,M,f[M],null,S,v);for(const M in C){if(cs(M))continue;const w=C[M],V=f[M];w!==V&&M!=="value"&&n(g,M,V,w,S,v)}"value"in C&&n(g,"value",f.value,C.value,S)}},_e=(g,f,C,v,S,M,w,V,B)=>{const P=f.el=g?g.el:o(""),L=f.anchor=g?g.anchor:o("");let{patchFlag:F,dynamicChildren:O,slotScopeIds:k}=f;k&&(V=V?V.concat(k):k),g==null?(i(P,C,v),i(L,C,v),rt(f.children||[],C,L,S,M,w,V,B)):F>0&&F&64&&O&&g.dynamicChildren?(q(g.dynamicChildren,O,C,S,M,w,V),(f.key!=null||S&&f===S.subTree)&&go(g,f,!0)):J(g,f,C,L,S,M,w,V,B)},Te=(g,f,C,v,S,M,w,V,B)=>{f.slotScopeIds=V,g==null?f.shapeFlag&512?S.ctx.activate(f,C,v,w,B):yi(f,C,v,S,M,w,B):zr(g,f,B)},yi=(g,f,C,v,S,M,w)=>{const V=g.component=gc(g,v,S);if(Ka(g)&&(V.ctx.renderer=ts),fc(V,!1,w),V.asyncDep){if(S&&S.registerDep(V,ft,w),!g.el){const B=V.subTree=Ie(qe);I(null,B,f,C),g.placeholder=B.el}}else ft(V,g,f,C,S,M,w)},zr=(g,f,C)=>{const v=f.component=g.component;if(Qu(g,f,C))if(v.asyncDep&&!v.asyncResolved){st(v,f,C);return}else v.next=f,v.update();else f.el=g.el,v.vnode=f},ft=(g,f,C,v,S,M,w)=>{const V=()=>{if(g.isMounted){let{next:F,bu:O,u:k,parent:X,vnode:K}=g;{const zt=fo(g);if(zt){F&&(F.el=K.el,st(g,F,w)),zt.asyncDep.then(()=>{g.isUnmounted||V()});return}}let Y=F,Ct;xe(g,!1),F?(F.el=K.el,st(g,F,w)):F=K,O&&Si(O),(Ct=F.props&&F.props.onVnodeBeforeUpdate)&&Xt(Ct,X,F,K),xe(g,!0);const xt=rn(g),Ut=g.subTree;g.subTree=xt,y(Ut,xt,h(Ut.el),Ds(Ut),g,S,M),F.el=xt.el,Y===null&&tc(g,xt.el),k&&It(k,S),(Ct=F.props&&F.props.onVnodeUpdated)&&It(()=>Xt(Ct,X,F,K),S)}else{let F;const{el:O,props:k}=f,{bm:X,m:K,parent:Y,root:Ct,type:xt}=g,Ut=ps(f);xe(g,!1),X&&Si(X),!Ut&&(F=k&&k.onVnodeBeforeMount)&&Xt(F,Y,f),xe(g,!0);{Ct.ce&&Ct.ce._def.shadowRoot!==!1&&Ct.ce._injectChildStyle(xt);const zt=g.subTree=rn(g);y(null,zt,C,v,g,S,M),f.el=zt.el}if(K&&It(K,S),!Ut&&(F=k&&k.onVnodeMounted)){const zt=f;It(()=>Xt(F,Y,zt),S)}(f.shapeFlag&256||Y&&ps(Y.vnode)&&Y.vnode.shapeFlag&256)&&g.a&&It(g.a,S),g.isMounted=!0,f=C=v=null}};g.scope.on();const B=g.effect=new Va(V);g.scope.off();const P=g.update=B.run.bind(B),L=g.job=B.runIfDirty.bind(B);L.i=g,L.id=g.uid,B.scheduler=()=>wr(L),xe(g,!0),P()},st=(g,f,C)=>{f.component=g;const v=g.vnode.props;g.vnode=f,g.next=null,Au(g,f.props,v,C),zu(g,f.children,C),ie(),Jr(g),re()},J=(g,f,C,v,S,M,w,V,B=!1)=>{const P=g&&g.children,L=g?g.shapeFlag:0,F=f.children,{patchFlag:O,shapeFlag:k}=f;if(O>0){if(O&128){Es(P,F,C,v,S,M,w,V,B);return}else if(O&256){me(P,F,C,v,S,M,w,V,B);return}}k&8?(L&16&&Qe(P,S,M),F!==P&&u(C,F)):L&16?k&16?Es(P,F,C,v,S,M,w,V,B):Qe(P,S,M,!0):(L&8&&u(C,""),k&16&&rt(F,C,v,S,M,w,V,B))},me=(g,f,C,v,S,M,w,V,B)=>{g=g||Xe,f=f||Xe;const P=g.length,L=f.length,F=Math.min(P,L);let O;for(O=0;O<F;O++){const k=f[O]=B?oe(f[O]):Ht(f[O]);y(g[O],k,C,null,S,M,w,V,B)}P>L?Qe(g,S,M,!0,!1,F):rt(f,C,v,S,M,w,V,B,F)},Es=(g,f,C,v,S,M,w,V,B)=>{let P=0;const L=f.length;let F=g.length-1,O=L-1;for(;P<=F&&P<=O;){const k=g[P],X=f[P]=B?oe(f[P]):Ht(f[P]);if(is(k,X))y(k,X,C,null,S,M,w,V,B);else break;P++}for(;P<=F&&P<=O;){const k=g[F],X=f[O]=B?oe(f[O]):Ht(f[O]);if(is(k,X))y(k,X,C,null,S,M,w,V,B);else break;F--,O--}if(P>F){if(P<=O){const k=O+1,X=k<L?f[k].el:v;for(;P<=O;)y(null,f[P]=B?oe(f[P]):Ht(f[P]),C,X,S,M,w,V,B),P++}}else if(P>O)for(;P<=F;)Nt(g[P],S,M,!0),P++;else{const k=P,X=P,K=new Map;for(P=X;P<=O;P++){const vt=f[P]=B?oe(f[P]):Ht(f[P]);vt.key!=null&&K.set(vt.key,P)}let Y,Ct=0;const xt=O-X+1;let Ut=!1,zt=0;const es=new Array(xt);for(P=0;P<xt;P++)es[P]=0;for(P=k;P<=F;P++){const vt=g[P];if(Ct>=xt){Nt(vt,S,M,!0);continue}let jt;if(vt.key!=null)jt=K.get(vt.key);else for(Y=X;Y<=O;Y++)if(es[Y-X]===0&&is(vt,f[Y])){jt=Y;break}jt===void 0?Nt(vt,S,M,!0):(es[jt-X]=P+1,jt>=zt?zt=jt:Ut=!0,y(vt,f[jt],C,null,S,M,w,V,B),Ct++)}const Gr=Ut?Wu(es):Xe;for(Y=Gr.length-1,P=xt-1;P>=0;P--){const vt=X+P,jt=f[vt],Wr=f[vt+1],Hr=vt+1<L?Wr.el||Wr.placeholder:v;es[P]===0?y(null,jt,C,Hr,S,M,w,V,B):Ut&&(Y<0||P!==Gr[Y]?ye(jt,C,Hr,2):Y--)}}},ye=(g,f,C,v,S=null)=>{const{el:M,type:w,transition:V,children:B,shapeFlag:P}=g;if(P&6){ye(g.component.subTree,f,C,v);return}if(P&128){g.suspense.move(f,C,v);return}if(P&64){w.move(g,f,C,ts);return}if(w===te){i(M,f,C);for(let F=0;F<B.length;F++)ye(B[F],f,C,v);i(g.anchor,f,C);return}if(w===Vi){b(g,f,C);return}if(v!==2&&P&1&&V)if(v===0)V.beforeEnter(M),i(M,f,C),It(()=>V.enter(M),S);else{const{leave:F,delayLeave:O,afterLeave:k}=V,X=()=>{g.ctx.isUnmounted?r(M):i(M,f,C)},K=()=>{M._isLeaving&&M[du](!0),F(M,()=>{X(),k&&k()})};O?O(M,X,K):K()}else i(M,f,C)},Nt=(g,f,C,v=!1,S=!1)=>{const{type:M,props:w,ref:V,children:B,dynamicChildren:P,shapeFlag:L,patchFlag:F,dirs:O,cacheIndex:k}=g;if(F===-2&&(S=!1),V!=null&&(ie(),fs(V,null,C,g,!0),re()),k!=null&&(f.renderCache[k]=void 0),L&256){f.ctx.deactivate(g);return}const X=L&1&&O,K=!ps(g);let Y;if(K&&(Y=w&&w.onVnodeBeforeUnmount)&&Xt(Y,f,g),L&6)pl(g.component,C,v);else{if(L&128){g.suspense.unmount(C,v);return}X&&Ce(g,null,f,"beforeUnmount"),L&64?g.type.remove(g,f,C,ts,v):P&&!P.hasOnce&&(M!==te||F>0&&F&64)?Qe(P,f,C,!1,!0):(M===te&&F&384||!S&&L&16)&&Qe(B,f,C),v&&jr(g)}(K&&(Y=w&&w.onVnodeUnmounted)||X)&&It(()=>{Y&&Xt(Y,f,g),X&&Ce(g,null,f,"unmounted")},C)},jr=g=>{const{type:f,el:C,anchor:v,transition:S}=g;if(f===te){fl(C,v);return}if(f===Vi){x(g);return}const M=()=>{r(C),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(g.shapeFlag&1&&S&&!S.persisted){const{leave:w,delayLeave:V}=S,B=()=>w(C,M);V?V(g.el,M,B):B()}else M()},fl=(g,f)=>{let C;for(;g!==f;)C=_(g),r(g),g=C;r(f)},pl=(g,f,C)=>{const{bum:v,scope:S,job:M,subTree:w,um:V,m:B,a:P}=g;sn(B),sn(P),v&&Si(v),S.stop(),M&&(M.flags|=8,Nt(w,g,f,C)),V&&It(V,f),It(()=>{g.isUnmounted=!0},f)},Qe=(g,f,C,v=!1,S=!1,M=0)=>{for(let w=M;w<g.length;w++)Nt(g[w],f,C,v,S)},Ds=g=>{if(g.shapeFlag&6)return Ds(g.component.subTree);if(g.shapeFlag&128)return g.suspense.next();const f=_(g.anchor||g.el),C=f&&f[hu];return C?_(C):f};let Ci=!1;const Xr=(g,f,C)=>{g==null?f._vnode&&Nt(f._vnode,null,null,!0):y(f._vnode||null,g,f,null,null,null,C),f._vnode=g,Ci||(Ci=!0,Jr(),$a(),Ci=!1)},ts={p:y,um:Nt,m:ye,r:jr,mt:yi,mc:rt,pc:J,pbc:q,n:Ds,o:e};return{render:Xr,hydrate:void 0,createApp:Du(Xr)}}function Bi({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function xe({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Gu(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function go(e,t,s=!1){const i=e.children,r=t.children;if(z(i)&&z(r))for(let n=0;n<i.length;n++){const a=i[n];let o=r[n];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=r[n]=oe(r[n]),o.el=a.el),!s&&o.patchFlag!==-2&&go(a,o)),o.type===di&&o.patchFlag!==-1&&(o.el=a.el),o.type===qe&&!o.el&&(o.el=a.el)}}function Wu(e){const t=e.slice(),s=[0];let i,r,n,a,o;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=s[s.length-1],e[r]<c){t[i]=r,s.push(i);continue}for(n=0,a=s.length-1;n<a;)o=n+a>>1,e[s[o]]<c?n=o+1:a=o;c<e[s[n]]&&(n>0&&(t[i]=s[n-1]),s[n]=i)}}for(n=s.length,a=s[n-1];n-- >0;)s[n]=a,a=t[a];return s}function fo(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:fo(t)}function sn(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Hu=Symbol.for("v-scx"),$u=()=>Ws(Hu);function Ii(e,t,s){return po(e,t,s)}function po(e,t,s=Q){const{immediate:i,deep:r,flush:n,once:a}=s,o=dt({},s),l=t&&i||!t&&n!=="post";let c;if(vs){if(n==="sync"){const d=$u();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Yt,d.resume=Yt,d.pause=Yt,d}}const u=yt;o.call=(d,p,y)=>qt(d,u,p,y);let h=!1;n==="post"?o.scheduler=d=>{It(d,u&&u.suspense)}:n!=="sync"&&(h=!0,o.scheduler=(d,p)=>{p?d():wr(d)}),o.augmentJob=d=>{t&&(d.flags|=4),h&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const _=nu(e,t,o);return vs&&(c?c.push(_):l&&_()),_}function Yu(e,t,s){const i=this.proxy,r=ot(e)?e.includes(".")?_o(i,e):()=>i[e]:e.bind(i,i);let n;U(t)?n=t:(n=t.handler,s=t);const a=Rs(this),o=po(r,n.bind(i),s);return a(),o}function _o(e,t){const s=t.split(".");return()=>{let i=e;for(let r=0;r<s.length&&i;r++)i=i[s[r]];return i}}const qu=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${pe(t)}Modifiers`]||e[`${Fe(t)}Modifiers`];function Ju(e,t,...s){if(e.isUnmounted)return;const i=e.vnode.props||Q;let r=s;const n=t.startsWith("update:"),a=n&&qu(i,t.slice(7));a&&(a.trim&&(r=s.map(u=>ot(u)?u.trim():u)),a.number&&(r=s.map(Ml)));let o,l=i[o=xi(t)]||i[o=xi(pe(t))];!l&&n&&(l=i[o=xi(Fe(t))]),l&&qt(l,e,6,r);const c=i[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,qt(c,e,6,r)}}function mo(e,t,s=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const n=e.emits;let a={},o=!1;if(!U(e)){const l=c=>{const u=mo(c,t,!0);u&&(o=!0,dt(a,u))};!s&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!n&&!o?(nt(e)&&i.set(e,null),null):(z(n)?n.forEach(l=>a[l]=null):dt(a,n),nt(e)&&i.set(e,a),a)}function gi(e,t){return!e||!ai(t)?!1:(t=t.slice(2).replace(/Once$/,""),$(e,t[0].toLowerCase()+t.slice(1))||$(e,Fe(t))||$(e,t))}function rn(e){const{type:t,vnode:s,proxy:i,withProxy:r,propsOptions:[n],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:h,data:_,setupState:d,ctx:p,inheritAttrs:y}=e,m=Ks(e);let I,T;try{if(s.shapeFlag&4){const x=r||i,R=x;I=Ht(c.call(R,x,u,h,d,_,p)),T=o}else{const x=t;I=Ht(x.length>1?x(h,{attrs:o,slots:a,emit:l}):x(h,null)),T=t.props?o:Ku(o)}}catch(x){ms.length=0,ci(x,e,1),I=Ie(qe)}let b=I;if(T&&y!==!1){const x=Object.keys(T),{shapeFlag:R}=b;x.length&&R&7&&(n&&x.some(pr)&&(T=Zu(T,n)),b=Je(b,T,!1,!0))}return s.dirs&&(b=Je(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&Fr(b,s.transition),I=b,Ks(m),I}const Ku=e=>{let t;for(const s in e)(s==="class"||s==="style"||ai(s))&&((t||(t={}))[s]=e[s]);return t},Zu=(e,t)=>{const s={};for(const i in e)(!pr(i)||!(i.slice(9)in t))&&(s[i]=e[i]);return s};function Qu(e,t,s){const{props:i,children:r,component:n}=e,{props:a,children:o,patchFlag:l}=t,c=n.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return i?nn(i,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const _=u[h];if(a[_]!==i[_]&&!gi(c,_))return!0}}}else return(r||o)&&(!o||!o.$stable)?!0:i===a?!1:i?a?nn(i,a,c):!0:!!a;return!1}function nn(e,t,s){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const n=i[r];if(t[n]!==e[n]&&!gi(s,n))return!0}return!1}function tc({vnode:e,parent:t},s){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=s,t=t.parent;else break}}const yo=e=>e.__isSuspense;function ec(e,t){t&&t.pendingBranch?z(e)?t.effects.push(...e):t.effects.push(e):uu(e)}const te=Symbol.for("v-fgt"),di=Symbol.for("v-txt"),qe=Symbol.for("v-cmt"),Vi=Symbol.for("v-stc"),ms=[];let Vt=null;function sc(e=!1){ms.push(Vt=e?null:[])}function ic(){ms.pop(),Vt=ms[ms.length-1]||null}let Ms=1;function an(e,t=!1){Ms+=e,e<0&&Vt&&t&&(Vt.hasOnce=!0)}function rc(e){return e.dynamicChildren=Ms>0?Vt||Xe:null,ic(),Ms>0&&Vt&&Vt.push(e),e}function nc(e,t,s,i,r,n){return rc(So(e,t,s,i,r,n,!0))}function Co(e){return e?e.__v_isVNode===!0:!1}function is(e,t){return e.type===t.type&&e.key===t.key}const xo=({key:e})=>e??null,Hs=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?ot(e)||gt(e)||U(e)?{i:$t,r:e,k:t,f:!!s}:e:null);function So(e,t=null,s=null,i=0,r=null,n=e===te?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&xo(t),ref:t&&Hs(t),scopeId:qa,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:$t};return o?(Er(l,s),n&128&&e.normalize(l)):s&&(l.shapeFlag|=ot(s)?8:16),Ms>0&&!a&&Vt&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Vt.push(l),l}const Ie=ac;function ac(e,t=null,s=null,i=0,r=null,n=!1){if((!e||e===Bu)&&(e=qe),Co(e)){const o=Je(e,t,!0);return s&&Er(o,s),Ms>0&&!n&&Vt&&(o.shapeFlag&6?Vt[Vt.indexOf(e)]=o:Vt.push(o)),o.patchFlag=-2,o}if(yc(e)&&(e=e.__vccOpts),t){t=oc(t);let{class:o,style:l}=t;o&&!ot(o)&&(t.class=Cr(o)),nt(l)&&(Vr(l)&&!z(l)&&(l=dt({},l)),t.style=yr(l))}const a=ot(e)?1:yo(e)?128:gu(e)?64:nt(e)?4:U(e)?2:0;return So(e,t,s,i,r,a,n,!0)}function oc(e){return e?Vr(e)||ao(e)?dt({},e):e:null}function Je(e,t,s=!1,i=!1){const{props:r,ref:n,patchFlag:a,children:o,transition:l}=e,c=t?uc(r||{},t):r,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&xo(c),ref:t&&t.ref?s&&n?z(n)?n.concat(Hs(t)):[n,Hs(t)]:Hs(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==te?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Je(e.ssContent),ssFallback:e.ssFallback&&Je(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&i&&Fr(u,l.clone(u)),u}function lc(e=" ",t=0){return Ie(di,null,e,t)}function Ht(e){return e==null||typeof e=="boolean"?Ie(qe):z(e)?Ie(te,null,e.slice()):Co(e)?oe(e):Ie(di,null,String(e))}function oe(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Je(e)}function Er(e,t){let s=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(z(t))s=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),Er(e,r()),r._c&&(r._d=!0));return}else{s=32;const r=t._;!r&&!ao(t)?t._ctx=$t:r===3&&$t&&($t.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else U(t)?(t={default:t,_ctx:$t},s=32):(t=String(t),i&64?(s=16,t=[lc(t)]):s=8);e.children=t,e.shapeFlag|=s}function uc(...e){const t={};for(let s=0;s<e.length;s++){const i=e[s];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=Cr([t.class,i.class]));else if(r==="style")t.style=yr([t.style,i.style]);else if(ai(r)){const n=t[r],a=i[r];a&&n!==a&&!(z(n)&&n.includes(a))&&(t[r]=n?[].concat(n,a):a)}else r!==""&&(t[r]=i[r])}return t}function Xt(e,t,s,i=null){qt(e,t,7,[s,i])}const cc=io();let hc=0;function gc(e,t,s){const i=e.type,r=(t?t.appContext:e.appContext)||cc,n={uid:hc++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Fl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:lo(i,r),emitsOptions:mo(i,r),emit:null,emitted:null,propsDefaults:Q,inheritAttrs:i.inheritAttrs,ctx:Q,data:Q,props:Q,attrs:Q,slots:Q,refs:Q,setupState:Q,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=Ju.bind(null,n),e.ce&&e.ce(n),n}let yt=null;const dc=()=>yt||$t;let Qs,Ji;{const e=ui(),t=(s,i)=>{let r;return(r=e[s])||(r=e[s]=[]),r.push(i),n=>{r.length>1?r.forEach(a=>a(n)):r[0](n)}};Qs=t("__VUE_INSTANCE_SETTERS__",s=>yt=s),Ji=t("__VUE_SSR_SETTERS__",s=>vs=s)}const Rs=e=>{const t=yt;return Qs(e),e.scope.on(),()=>{e.scope.off(),Qs(t)}},on=()=>{yt&&yt.scope.off(),Qs(null)};function bo(e){return e.vnode.shapeFlag&4}let vs=!1;function fc(e,t=!1,s=!1){t&&Ji(t);const{props:i,children:r}=e.vnode,n=bo(e);Lu(e,i,n,t),Uu(e,r,s||t);const a=n?pc(e,t):void 0;return t&&Ji(!1),a}function pc(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Iu);const{setup:i}=s;if(i){ie();const r=e.setupContext=i.length>1?mc(e):null,n=Rs(e),a=Ts(i,e,0,[e.props,r]),o=va(a);if(re(),n(),(o||e.sp)&&!ps(e)&&Ja(e),o){if(a.then(on,on),t)return a.then(l=>{ln(e,l)}).catch(l=>{ci(l,e,0)});e.asyncDep=a}else ln(e,a)}else Mo(e)}function ln(e,t,s){U(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:nt(t)&&(e.setupState=Ga(t)),Mo(e)}function Mo(e,t,s){const i=e.type;e.render||(e.render=i.render||Yt);{const r=Rs(e);ie();try{Vu(e)}finally{re(),r()}}}const _c={get(e,t){return ct(e,"get",""),e[t]}};function mc(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,_c),slots:e.slots,emit:e.emit,expose:t}}function Dr(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Ga(Xa(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in _s)return _s[s](e)},has(t,s){return s in t||s in _s}})):e.proxy}function yc(e){return U(e)&&"__vccOpts"in e}const Cc=(e,t)=>iu(e,t,vs),xc="3.5.20";/**
* @vue/runtime-dom v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ki;const un=typeof window<"u"&&window.trustedTypes;if(un)try{Ki=un.createPolicy("vue",{createHTML:e=>e})}catch{}const vo=Ki?e=>Ki.createHTML(e):e=>e,Sc="http://www.w3.org/2000/svg",bc="http://www.w3.org/1998/Math/MathML",Qt=typeof document<"u"?document:null,cn=Qt&&Qt.createElement("template"),Mc={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,i)=>{const r=t==="svg"?Qt.createElementNS(Sc,e):t==="mathml"?Qt.createElementNS(bc,e):s?Qt.createElement(e,{is:s}):Qt.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>Qt.createTextNode(e),createComment:e=>Qt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Qt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,i,r,n){const a=s?s.previousSibling:t.lastChild;if(r&&(r===n||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),s),!(r===n||!(r=r.nextSibling)););else{cn.innerHTML=vo(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const o=cn.content;if(i==="svg"||i==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,s)}return[a?a.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},vc=Symbol("_vtc");function Pc(e,t,s){const i=e[vc];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const hn=Symbol("_vod"),Bc=Symbol("_vsh"),Ic=Symbol(""),Vc=/(^|;)\s*display\s*:/;function wc(e,t,s){const i=e.style,r=ot(s);let n=!1;if(s&&!r){if(t)if(ot(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();s[o]==null&&$s(i,o,"")}else for(const a in t)s[a]==null&&$s(i,a,"");for(const a in s)a==="display"&&(n=!0),$s(i,a,s[a])}else if(r){if(t!==s){const a=i[Ic];a&&(s+=";"+a),i.cssText=s,n=Vc.test(s)}}else t&&e.removeAttribute("style");hn in e&&(e[hn]=n?i.display:"",e[Bc]&&(i.display="none"))}const gn=/\s*!important$/;function $s(e,t,s){if(z(s))s.forEach(i=>$s(e,t,i));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const i=Fc(e,t);gn.test(s)?e.setProperty(Fe(i),s.replace(gn,""),"important"):e[i]=s}}const dn=["Webkit","Moz","ms"],wi={};function Fc(e,t){const s=wi[t];if(s)return s;let i=pe(t);if(i!=="filter"&&i in e)return wi[t]=i;i=Pa(i);for(let r=0;r<dn.length;r++){const n=dn[r]+i;if(n in e)return wi[t]=n}return t}const fn="http://www.w3.org/1999/xlink";function pn(e,t,s,i,r,n=wl(t)){i&&t.startsWith("xlink:")?s==null?e.removeAttributeNS(fn,t.slice(6,t.length)):e.setAttributeNS(fn,t,s):s==null||n&&!Ia(s)?e.removeAttribute(t):e.setAttribute(t,n?"":Ze(s)?String(s):s)}function _n(e,t,s,i,r){if(t==="innerHTML"||t==="textContent"){s!=null&&(e[t]=t==="innerHTML"?vo(s):s);return}const n=e.tagName;if(t==="value"&&n!=="PROGRESS"&&!n.includes("-")){const o=n==="OPTION"?e.getAttribute("value")||"":e.value,l=s==null?e.type==="checkbox"?"on":"":String(s);(o!==l||!("_value"in e))&&(e.value=l),s==null&&e.removeAttribute(t),e._value=s;return}let a=!1;if(s===""||s==null){const o=typeof e[t];o==="boolean"?s=Ia(s):s==null&&o==="string"?(s="",a=!0):o==="number"&&(s=0,a=!0)}try{e[t]=s}catch{}a&&e.removeAttribute(r||t)}function Tc(e,t,s,i){e.addEventListener(t,s,i)}function Rc(e,t,s,i){e.removeEventListener(t,s,i)}const mn=Symbol("_vei");function Ec(e,t,s,i,r=null){const n=e[mn]||(e[mn]={}),a=n[t];if(i&&a)a.value=i;else{const[o,l]=Dc(t);if(i){const c=n[t]=Ac(i,r);Tc(e,o,c,l)}else a&&(Rc(e,o,a,l),n[t]=void 0)}}const yn=/(?:Once|Passive|Capture)$/;function Dc(e){let t;if(yn.test(e)){t={};let i;for(;i=e.match(yn);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Fe(e.slice(2)),t]}let Fi=0;const Oc=Promise.resolve(),Lc=()=>Fi||(Oc.then(()=>Fi=0),Fi=Date.now());function Ac(e,t){const s=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=s.attached)return;qt(kc(i,s.value),t,5,[i])};return s.value=e,s.attached=Lc(),s}function kc(e,t){if(z(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const Cn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Nc=(e,t,s,i,r,n)=>{const a=r==="svg";t==="class"?Pc(e,i,a):t==="style"?wc(e,s,i):ai(t)?pr(t)||Ec(e,t,s,i,n):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Uc(e,t,i,a))?(_n(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&pn(e,t,i,a,n,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!ot(i))?_n(e,pe(t),i,n,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),pn(e,t,i,a))};function Uc(e,t,s,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&Cn(t)&&U(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Cn(t)&&ot(s)?!1:t in e}const zc=dt({patchProp:Nc},Mc);let xn;function jc(){return xn||(xn=ju(zc))}const Xc=((...e)=>{const t=jc().createApp(...e),{mount:s}=t;return t.mount=i=>{const r=Wc(i);if(!r)return;const n=t._component;!U(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const a=s(r,!1,Gc(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t});function Gc(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Wc(e){return ot(e)?document.querySelector(e):e}class Po{angleX=0;angleY=0;angleZ=0;angleEyeX=0;angleEyeY=0;mouseDistance=0;autoBlink=!1}const ys=class ys{constructor(t=0){t<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(t),this._capacity=t,this._size=0)}at(t){return this._ptr[t]}set(t,s){this._ptr[t]=s}get(t=0){const s=new Array;for(let i=t;i<this._size;i++)s.push(this._ptr[i]);return s}pushBack(t){this._size>=this._capacity&&this.prepareCapacity(this._capacity==0?ys.DefaultSize:this._capacity*2),this._ptr[this._size++]=t}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(t,s){this._size<t&&this.prepareCapacity(t);for(let r=0;r<t;r++)this._ptr[r]=s;this._size=t}resize(t,s=null){this.updateSize(t,s,!0)}updateSize(t,s=null,i=!0){if(this._size<t)if(this.prepareCapacity(t),i)for(let n=this._size;n<t;n++)typeof s=="function"?this._ptr[n]=JSON.parse(JSON.stringify(new s)):this._ptr[n]=s;else for(let n=this._size;n<t;n++)this._ptr[n]=s;else{const n=this._size-t;this._ptr.splice(this._size-n,n)}this._size=t}insert(t,s,i){let r=t._index;const n=s._index,a=i._index,o=a-n;this.prepareCapacity(this._size+o);const l=this._size-r;if(l>0)for(let c=0;c<l;c++)this._ptr.splice(r+c,0,null);for(let c=n;c<a;c++,r++)this._ptr[r]=s._vector._ptr[c];this._size=this._size+o}remove(t){return t<0||this._size<=t?!1:(this._ptr.splice(t,1),--this._size,!0)}erase(t){const s=t._index;return s<0||this._size<=s?t:(this._ptr.splice(s,1),--this._size,new Ys(this,s))}prepareCapacity(t){t>this._capacity&&(this._capacity==0?(this._ptr=new Array(t),this._capacity=t):(this._ptr.length=t,this._capacity=t))}begin(){return this._size==0?this.end():new Ys(this,0)}end(){return new Ys(this,this._size)}getOffset(t){const s=new ys;return s._ptr=this.get(t),s._size=this.get(t).length,s._capacity=this.get(t).length,s}};ys.DefaultSize=10;let D=ys,Ys=class Zi{constructor(t,s){this._vector=t??null,this._index=s??0}set(t){return this._index=t._index,this._vector=t._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new Zi(this._vector,this._index++)}decrement(){return new Zi(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(t){return this._index=t._index,this._vector=t._vector,this}notEqual(t){return this._index!=t._index||this._vector!=t._vector}};var Qi;(e=>{e.csmVector=D,e.iterator=Ys})(Qi||(Qi={}));class Tt{append(t,s){return this.s+=s!==void 0?t.substr(0,s):t,this}expansion(t,s){for(let i=0;i<t;i++)this.append(s);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(t){return this.s<t.s}isGreat(t){return this.s>t.s}isEqual(t){return this.s==t}isEmpty(){return this.s.length==0}constructor(t){this.s=t}}var Sn;(e=>{e.csmString=Tt})(Sn||(Sn={}));class He{static createIdInternal(t){return new He(t)}getString(){return this._id}isEqual(t){return typeof t=="string"?this._id.isEqual(t):t instanceof Tt?this._id.isEqual(t.s):t instanceof He?this._id.isEqual(t._id.s):!1}isNotEqual(t){return typeof t=="string"?!this._id.isEqual(t):t instanceof Tt?!this._id.isEqual(t.s):t instanceof He?!this._id.isEqual(t._id.s):!1}constructor(t){if(typeof t=="string"){this._id=new Tt(t);return}this._id=t}}var bn;(e=>{e.CubismId=He})(bn||(bn={}));class Bo{constructor(){this._ids=new D}release(){for(let t=0;t<this._ids.getSize();++t)this._ids.set(t,void 0);this._ids=null}registerIds(t){for(let s=0;s<t.length;s++)this.registerId(t[s])}registerId(t){let s=null;if(typeof t=="string"){if((s=this.findId(t))!=null)return s;s=He.createIdInternal(t),this._ids.pushBack(s)}else return this.registerId(t.s);return s}getId(t){return this.registerId(t)}isExist(t){return typeof t=="string"?this.findId(t)!=null:this.isExist(t.s)}findId(t){for(let s=0;s<this._ids.getSize();++s)if(this._ids.at(s).getString().isEqual(t))return this._ids.at(s);return null}}var Mn;(e=>{e.CubismIdManager=Bo})(Mn||(Mn={}));let ge=class ls{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,s,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=4;for(let a=0;a<n;++a)for(let o=0;o<n;++o)for(let l=0;l<n;++l)r[o+a*4]+=t[l+a*4]*s[o+l*4];for(let a=0;a<16;++a)i[a]=r[a]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let s=0;s<16;++s)this._tr[s]=t[s]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,s){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,s,0,1]);ls.multiply(i,this._tr,this._tr)}translate(t,s){this._tr[12]=t,this._tr[13]=s}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,s){const i=new Float32Array([t,0,0,0,0,s,0,0,0,0,1,0,0,0,0,1]);ls.multiply(i,this._tr,this._tr)}scale(t,s){this._tr[0]=t,this._tr[5]=s}multiplyByMatrix(t){ls.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new ls;for(let s=0;s<this._tr.length;s++)t._tr[s]=this._tr[s];return t}};var tr;(e=>{e.CubismMatrix44=ge})(tr||(tr={}));class ti{constructor(t,s,i,r){this.x=t,this.y=s,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,s){this.x-=t,this.y-=s,this.width+=t*2,this.height+=s*2}}var vn;(e=>{e.csmRect=ti})(vn||(vn={}));class fi{static create(){return null}static delete(t){}initialize(t){this._model=t}drawModel(){this.getModel()!=null&&(this.saveProfile(),this.doDrawModel(),this.restoreProfile())}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,s,i,r){t<0?t=0:t>1&&(t=1),s<0?s=0:s>1&&(s=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.r=t,this._modelColor.g=s,this._modelColor.b=i,this._modelColor.a=r}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}getModelColorWithOpacity(t){const s=this.getModelColor();return s.a*=t,this.isPremultipliedAlpha()&&(s.r*=s.a,s.g*=s.a,s.b*=s.a),s}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisotropy=t}getAnisotropy(){return this._anisotropy}getModel(){return this._model}useHighPrecisionMask(t){this._useHighPrecisionMask=t}isUsingHighPrecisionMask(){return this._useHighPrecisionMask}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisotropy=0,this._model=null,this._modelColor=new Mt,this._useHighPrecisionMask=!1,this._mvpMatrix4x4=new ge,this._mvpMatrix4x4.loadIdentity()}}var de=(e=>(e[e.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",e[e.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",e[e.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",e))(de||{});class Mt{constructor(t=1,s=1,i=1,r=1){this.r=t,this.g=s,this.b=i,this.a=r}}class Hc{constructor(t,s){this._clippingIdList=t,this._clippingIdCount=s,this._allClippedDrawRect=new ti,this._layoutBounds=new ti,this._clippedDrawableIndexList=[],this._matrixForMask=new ge,this._matrixForDraw=new ge,this._bufferIndex=0}release(){this._layoutBounds!=null&&(this._layoutBounds=null),this._allClippedDrawRect!=null&&(this._allClippedDrawRect=null),this._clippedDrawableIndexList!=null&&(this._clippedDrawableIndexList=null)}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}}var Pn;(e=>{e.CubismBlendMode=de,e.CubismRenderer=fi,e.CubismTextureColor=Mt})(Pn||(Pn={}));const $c=(e,t,s)=>{Or.print(e,"[CSM]"+t,s)},ks=(e,t,s)=>{$c(e,t+`
`,s)},bt=e=>{console.assert(e)};let Ps,Ft,G,it;Ps=(e,...t)=>{ks(Ue.LogLevel_Debug,"[D]"+e,t)},Ft=(e,...t)=>{ks(Ue.LogLevel_Info,"[I]"+e,t)},G=(e,...t)=>{ks(Ue.LogLevel_Warning,"[W]"+e,t)},it=(e,...t)=>{ks(Ue.LogLevel_Error,"[E]"+e,t)};class Or{static print(t,s,i){if(t<tt.getLoggingLevel())return;const r=tt.coreLogFunction;if(!r)return;const n=s.replace(/\{(\d+)\}/g,(a,o)=>i[o]);r(n)}static dumpBytes(t,s,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(t,`
`):r%8==0&&r>0&&this.print(t,"  "),this.print(t,"{0} ",[s[r]&255]);this.print(t,`
`)}constructor(){}}var Bn;(e=>{e.CubismDebug=Or})(Bn||(Bn={}));class Io{constructor(t,s){this.first=t??null,this.second=s??null}}const Cs=class Cs{constructor(t){t!=null?t<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(t),this._size=t):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(t){let s=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){s=i;break}if(s!=-1){G("The key `{0}` is already append.",t);return}this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new Io(t),this._size+=1}getValue(t){let s=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){s=i;break}return s>=0?this._keyValues[s].second:(this.appendKey(t),this._keyValues[this._size-1].second)}setValue(t,s){let i=-1;for(let r=0;r<this._size;r++)if(this._keyValues[r].first==t){i=r;break}i>=0?this._keyValues[i].second=s:(this.appendKey(t),this._keyValues[this._size-1].second=s)}isExist(t){for(let s=0;s<this._size;s++)if(this._keyValues[s].first==t)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(t,s){t>this._keyValues.length&&(this._keyValues.length==0?(!s&&t<Cs.DefaultSize&&(t=Cs.DefaultSize),this._keyValues.length=t):(!s&&t<this._keyValues.length*2&&(t=this._keyValues.length*2),this._keyValues.length=t))}begin(){return new Ve(this,0)}end(){return new Ve(this,this._size)}erase(t){const s=t._index;return s<0||this._size<=s?t:(this._keyValues.splice(s,1),--this._size,new Ve(this,s))}dumpAsInt(){for(let t=0;t<this._size;t++)Ps("{0} ,",this._keyValues[t]),Ps(`
`)}};Cs.DefaultSize=10;let Lt=Cs;class Ve{constructor(t,s){this._map=t??new Lt,this._index=s??0}set(t){return this._index=t._index,this._map=t._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new Ve(this._map,this._index++)}decrement(){const t=new Ve(this._map,this._index);return this._map=t._map,this._index=t._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(t){return this._index!=t._index||this._map!=t._map}}var In;(e=>{e.csmMap=Lt,e.csmPair=Io,e.iterator=Ve})(In||(In={}));class ei{static parseJsonObject(t,s){return Object.keys(t).forEach(i=>{if(typeof t[i]=="boolean"){const r=!!t[i];s.put(i,new Ot(r))}else if(typeof t[i]=="string"){const r=String(t[i]);s.put(i,new Ke(r))}else if(typeof t[i]=="number"){const r=Number(t[i]);s.put(i,new ii(r))}else t[i]instanceof Array?s.put(i,ei.parseJsonArray(t[i])):t[i]instanceof Object?s.put(i,ei.parseJsonObject(t[i],new Ye)):t[i]==null?s.put(i,new $e):s.put(i,t[i])}),s}static parseJsonArray(t){const s=new Lr;return Object.keys(t).forEach(i=>{if(typeof Number(i)=="number")if(typeof t[i]=="boolean"){const n=!!t[i];s.add(new Ot(n))}else if(typeof t[i]=="string"){const n=String(t[i]);s.add(new Ke(n))}else if(typeof t[i]=="number"){const n=Number(t[i]);s.add(new ii(n))}else t[i]instanceof Array?s.add(this.parseJsonArray(t[i])):t[i]instanceof Object?s.add(this.parseJsonObject(t[i],new Ye)):t[i]==null?s.add(new $e):s.add(t[i]);else if(t[i]instanceof Array)s.add(this.parseJsonArray(t[i]));else if(t[i]instanceof Object)s.add(this.parseJsonObject(t[i],new Ye));else if(t[i]==null)s.add(new $e);else{const n=Array(t[i]);for(let a=0;a<n.length;a++)s.add(n[a])}}),s}}const si="Error: type mismatch",Yc="Error: index out of bounds";let ht=class Gt{constructor(){}getRawString(t,s){return this.getString(t,s)}toInt(t=0){return t}toFloat(t=0){return t}toBoolean(t=!1){return t}getSize(){return 0}getArray(t=null){return t}getVector(t=new D){return t}getMap(t){return t}getValueByIndex(t){return Gt.errorValue.setErrorNotForClientCall(si)}getValueByString(t){return Gt.nullValue.setErrorNotForClientCall(si)}getKeys(){return Gt.dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(t){return!1}isStatic(){return!1}setErrorNotForClientCall(t){return Bs.errorValue}static staticInitializeNotForClientCall(){Ot.trueValue=new Ot(!0),Ot.falseValue=new Ot(!1),Gt.errorValue=new Bs("ERROR",!0),Gt.nullValue=new $e,Gt.dummyKeys=new D}static staticReleaseNotForClientCall(){Ot.trueValue=null,Ot.falseValue=null,Gt.errorValue=null,Gt.nullValue=null,Gt.dummyKeys=null}};class lt{constructor(t,s){this._parseCallback=ei.parseJsonObject,this._error=null,this._lineCount=0,this._root=null,t!=null&&this.parseBytes(t,s,this._parseCallback)}static create(t,s){const i=new lt;return i.parseBytes(t,s,i._parseCallback)?i:(lt.delete(i),null)}static delete(t){}getRoot(){return this._root}static arrayBufferToString(t){const s=new Uint8Array(t);let i="";for(let r=0,n=s.length;r<n;++r)i+="%"+this.pad(s[r].toString(16));return i=decodeURIComponent(i),i}static pad(t){return t.length<2?"0"+t:t}parseBytes(t,s,i){const r=new Array(1),n=lt.arrayBufferToString(t);if(i==null?this._root=this.parseValue(n,s,0,r):this._root=i(JSON.parse(n),new Ye),this._error){let a="\0";return a="Json parse error : @line "+(this._lineCount+1)+`
`,this._root=new Ke(a),Ft("{0}",this._root.getRawString()),!1}else if(this._root==null)return this._root=new Bs(new Tt(this._error),!1),!1;return!0}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(t,s,i,r){if(this._error)return null;let n=null,a=i,o;for(;a<s;a++)switch(t[a]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const c=new Array(1);return o=qc(t.slice(a),c),r[0]=t.indexOf(c[0]),new ii(o)}case'"':return new Ke(this.parseString(t,s,a+1,r));case"[":return n=this.parseArray(t,s,a+1,r),n;case"{":return n=this.parseObject(t,s,a+1,r),n;case"n":return a+3<s?(n=new $e,r[0]=a+4):this._error="parse null",n;case"t":return a+3<s?(n=Ot.trueValue,r[0]=a+4):this._error="parse true",n;case"f":return a+4<s?(n=Ot.falseValue,r[0]=a+5):this._error="illegal ',' position",n;case",":return this._error="illegal ',' position",null;case"]":return r[0]=a,null;case`
`:this._lineCount++}return this._error="illegal end of value",null}parseString(t,s,i,r){if(this._error)return null;if(!t)return this._error="string is null",null;let n=i,a,o;const l=new Tt("");let c=i;for(;n<s;n++)switch(a=t[n],a){case'"':return r[0]=n+1,l.append(t.slice(c),n-c),l.s;case"//":if(n++,n-1>c&&l.append(t.slice(c),n-c),c=n+1,n<s)switch(o=t[n],o){case"\\":l.expansion(1,"\\");break;case'"':l.expansion(1,'"');break;case"/":l.expansion(1,"/");break;case"b":l.expansion(1,"\b");break;case"f":l.expansion(1,"\f");break;case"n":l.expansion(1,`
`);break;case"r":l.expansion(1,"\r");break;case"t":l.expansion(1,"	");break;case"u":this._error="parse string/unicord escape not supported";break}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(t,s,i,r){if(this._error)return null;if(!t)return this._error="buffer is null",null;const n=new Ye;let a="",o=i,l="";const c=Array(1);let u=!1;for(;o<s;o++){t:for(;o<s;o++)switch(l=t[o],l){case'"':if(a=this.parseString(t,s,o+1,c),this._error)return null;o=c[0],u=!0;break t;case"}":return r[0]=o+1,n;case":":this._error="illegal ':' position";break;case`
`:this._lineCount++}if(!u)return this._error="key not found",null;u=!1;t:for(;o<s;o++)switch(l=t[o],l){case":":u=!0,o++;break t;case"}":this._error="illegal '}' position";break;case`
`:this._lineCount++}if(!u)return this._error="':' not found",null;const h=this.parseValue(t,s,o,c);if(this._error)return null;o=c[0],n.put(a,h);t:for(;o<s;o++)switch(l=t[o],l){case",":break t;case"}":return r[0]=o+1,n;case`
`:this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(t,s,i,r){if(this._error)return null;if(!t)return this._error="buffer is null",null;let n=new Lr,a=i,o;const l=new Array(1);for(;a<s;a++){const c=this.parseValue(t,s,a,l);if(this._error)return null;a=l[0],c&&n.add(c);t:for(;a<s;a++)switch(o=t[a],o){case",":break t;case"]":return r[0]=a+1,n;case`
`:++this._lineCount}}return n=void 0,this._error="illegal end of parseObject",null}}class ii extends ht{constructor(t){super(),this._value=t}isFloat(){return!0}getString(t,s){return this._value=parseFloat("\0"),this._stringBuffer="\0",this._stringBuffer}toInt(t=0){return parseInt(this._value.toString())}toFloat(t=0){return this._value}equals(t){return typeof t=="number"?Math.round(t)?!1:t==this._value:!1}}class Ot extends ht{isBool(){return!0}toBoolean(t=!1){return this._boolValue}getString(t,s){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(t){return typeof t=="boolean"?t==this._boolValue:!1}isStatic(){return!0}constructor(t){super(),this._boolValue=t}}class Ke extends ht{constructor(t){super(),typeof t=="string"&&(this._stringBuffer=t),t instanceof Tt&&(this._stringBuffer=t.s)}isString(){return!0}getString(t,s){return this._stringBuffer}equals(t){return typeof t=="string"?this._stringBuffer==t:t instanceof Tt?this._stringBuffer==t.s:!1}}class Bs extends Ke{isStatic(){return this._isStatic}setErrorNotForClientCall(t){return this._stringBuffer=t,this}constructor(t,s){typeof t=="string"?super(t):super(t),this._isStatic=s}isError(){return!0}}class $e extends ht{isNull(){return!0}getString(t,s){return this._stringBuffer}isStatic(){return!0}setErrorNotForClientCall(t){return this._stringBuffer=t,Bs.nullValue}constructor(){super(),this._stringBuffer="NullValue"}}class Lr extends ht{constructor(){super(),this._array=new D}release(){for(let t=this._array.begin();t.notEqual(this._array.end());t.preIncrement()){let s=t.ptr();s&&!s.isStatic()&&(s=void 0,s=null)}}isArray(){return!0}getValueByIndex(t){if(t<0||this._array.getSize()<=t)return ht.errorValue.setErrorNotForClientCall(Yc);const s=this._array.at(t);return s??ht.nullValue}getValueByString(t){return ht.errorValue.setErrorNotForClientCall(si)}getString(t,s){const i=s+`[
`;for(let r=this._array.begin();r.notEqual(this._array.end());r.increment()){const n=r.ptr();this._stringBuffer+=s+""+n.getString(s+" ")+`
`}return this._stringBuffer=i+s+`]
`,this._stringBuffer}add(t){this._array.pushBack(t)}getVector(t=null){return this._array}getSize(){return this._array.getSize()}}class Ye extends ht{constructor(){super(),this._map=new Lt}release(){const t=this._map.begin();for(;t.notEqual(this._map.end());){let s=t.ptr().second;s&&!s.isStatic()&&(s=void 0,s=null),t.preIncrement()}}isMap(){return!0}getValueByString(t){if(t instanceof Tt){const s=this._map.getValue(t.s);return s??ht.nullValue}for(let s=this._map.begin();s.notEqual(this._map.end());s.preIncrement())if(s.ptr().first==t)return s.ptr().second==null?ht.nullValue:s.ptr().second;return ht.nullValue}getValueByIndex(t){return ht.errorValue.setErrorNotForClientCall(si)}getString(t,s){this._stringBuffer=s+`{
`;const i=this._map.begin();for(;i.notEqual(this._map.end());){const r=i.ptr().first,n=i.ptr().second;this._stringBuffer+=s+" "+r+" : "+n.getString(s+"   ")+` 
`,i.preIncrement()}return this._stringBuffer+=s+`}
`,this._stringBuffer}getMap(t){return this._map}put(t,s){this._map.setValue(t,s)}getKeys(){if(!this._keys){this._keys=new D;const t=this._map.begin();for(;t.notEqual(this._map.end());){const s=t.ptr().first;this._keys.pushBack(s),t.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}var Vn;(e=>{e.CubismJson=lt,e.JsonArray=Lr,e.JsonBoolean=Ot,e.JsonError=Bs,e.JsonFloat=ii,e.JsonMap=Ye,e.JsonNullvalue=$e,e.JsonString=Ke,e.Value=ht})(Vn||(Vn={}));function qc(e,t){let s=0;for(let r=1;;r++){const n=e.slice(r-1,r);if(n=="e"||n=="-"||n=="E")continue;const a=e.substring(0,r),o=Number(a);if(isNaN(o))break;s=r}let i=parseFloat(e);return isNaN(i)&&(i=NaN),t[0]=e.slice(s),i}let Et=!1,Ee=!1,De=null,rs=null;const ce=Object.freeze({vertexOffset:0,vertexStep:2});function Ne(e){e&&(e=void 0)}let tt=class{static startUp(t=null){if(Et)return Ft("CubismFramework.startUp() is already done."),Et;if(De=t,De!=null&&Live2DCubismCore.Logging.csmSetLogFunction(De.logFunction),Et=!0,Et){const s=Live2DCubismCore.Version.csmGetVersion(),i=(s&4278190080)>>24,r=(s&16711680)>>16,n=s&65535,a=s;Ft("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+i).slice(-2),("00"+r).slice(-2),("0000"+n).slice(-4),a)}return Ft("CubismFramework.startUp() is complete."),Et}static cleanUp(){Et=!1,Ee=!1,De=null,rs=null}static initialize(t=0){if(bt(Et),!Et){G("CubismFramework is not started.");return}if(Ee){G("CubismFramework.initialize() skipped, already initialized.");return}ht.staticInitializeNotForClientCall(),rs=new Bo,Live2DCubismCore.Memory.initializeAmountOfMemory(t),Ee=!0,Ft("CubismFramework.initialize() is complete.")}static dispose(){if(bt(Et),!Et){G("CubismFramework is not started.");return}if(!Ee){G("CubismFramework.dispose() skipped, not initialized.");return}ht.staticReleaseNotForClientCall(),rs.release(),rs=null,fi.staticRelease(),Ee=!1,Ft("CubismFramework.dispose() is complete.")}static isStarted(){return Et}static isInitialized(){return Ee}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return De!=null?De.loggingLevel:5}static getIdManager(){return rs}constructor(){}};var Ue=(e=>(e[e.LogLevel_Verbose=0]="LogLevel_Verbose",e[e.LogLevel_Debug=1]="LogLevel_Debug",e[e.LogLevel_Info=2]="LogLevel_Info",e[e.LogLevel_Warning=3]="LogLevel_Warning",e[e.LogLevel_Error=4]="LogLevel_Error",e[e.LogLevel_Off=5]="LogLevel_Off",e))(Ue||{}),wn;(e=>{e.Constant=ce,e.csmDelete=Ne,e.CubismFramework=tt})(wn||(wn={}));let Vo=class{};var er;(e=>{e.ICubismModelSetting=Vo})(er||(er={}));var wo=(e=>(e[e.FrequestNode_Groups=0]="FrequestNode_Groups",e[e.FrequestNode_Moc=1]="FrequestNode_Moc",e[e.FrequestNode_Motions=2]="FrequestNode_Motions",e[e.FrequestNode_Expressions=3]="FrequestNode_Expressions",e[e.FrequestNode_Textures=4]="FrequestNode_Textures",e[e.FrequestNode_Physics=5]="FrequestNode_Physics",e[e.FrequestNode_Pose=6]="FrequestNode_Pose",e[e.FrequestNode_HitAreas=7]="FrequestNode_HitAreas",e))(wo||{});let Jc=class extends Vo{constructor(t,s){super(),this.version="Version",this.fileReferences="FileReferences",this.groups="Groups",this.layout="Layout",this.hitAreas="HitAreas",this.moc="Moc",this.textures="Textures",this.physics="Physics",this.pose="Pose",this.expressions="Expressions",this.motions="Motions",this.userData="UserData",this.name="Name",this.filePath="File",this.id="Id",this.ids="Ids",this.target="Target",this.idle="Idle",this.tapBody="TapBody",this.pinchIn="PinchIn",this.pinchOut="PinchOut",this.shake="Shake",this.flickHead="FlickHead",this.parameter="Parameter",this.soundPath="Sound",this.fadeInTime="FadeInTime",this.fadeOutTime="FadeOutTime",this.centerX="CenterX",this.centerY="CenterY",this.x="X",this.y="Y",this.width="Width",this.height="Height",this.lipSync="LipSync",this.eyeBlink="EyeBlink",this.initParameter="init_param",this.initPartsVisible="init_parts_visible",this.val="val",this._json=lt.create(t,s),this.getJson()&&(this._jsonValue=new D,this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.groups)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.moc)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.motions)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.expressions)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.textures)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.physics)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.pose)),this._jsonValue.pushBack(this.getJson().getRoot().getValueByString(this.hitAreas)))}release(){lt.delete(this._json),this._jsonValue=null}getJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(1).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(4).getSize():0}getTextureDirectory(){const s=this._jsonValue.at(4).getValueByIndex(0).getRawString().split("/"),i=s.length-1;let r="";for(let n=0;n<i;n++)r+=s[n],n<i-1&&(r+="/");return r}getTextureFileName(t){return this._jsonValue.at(4).getValueByIndex(t).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(7).getSize():0}getHitAreaId(t){return tt.getIdManager().getId(this._jsonValue.at(7).getValueByIndex(t).getValueByString(this.id).getRawString())}getHitAreaName(t){return this._jsonValue.at(7).getValueByIndex(t).getValueByString(this.name).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(5).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(6).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(3).getSize():0}getExpressionName(t){return this._jsonValue.at(3).getValueByIndex(t).getValueByString(this.name).getRawString()}getExpressionFileName(t){return this._jsonValue.at(3).getValueByIndex(t).getValueByString(this.filePath).getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().getSize():0}getMotionGroupName(t){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().at(t):null}getMotionCount(t){return this.isExistMotionGroupName(t)?this._jsonValue.at(2).getValueByString(t).getSize():0}getMotionFileName(t,s){return this.isExistMotionGroupName(t)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.filePath).getRawString():""}getMotionSoundFileName(t,s){return this.isExistMotionSoundFile(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.soundPath).getRawString():""}getMotionFadeInTimeValue(t,s){return this.isExistMotionFadeIn(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.fadeInTime).toFloat():-1}getMotionFadeOutTimeValue(t,s){return this.isExistMotionFadeOut(t,s)?this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.fadeOutTime).toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.userData).getRawString():""}getLayoutMap(t){const s=this.getJson().getRoot().getValueByString(this.layout).getMap();if(s==null)return!1;let i=!1;for(const r=s.begin();r.notEqual(s.end());r.preIncrement())t.setValue(r.ptr().first,r.ptr().second.toFloat()),i=!0;return i}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(this.name).getRawString()==this.eyeBlink){t=i.getValueByString(this.ids).getVector().getSize();break}}return t}getEyeBlinkParameterId(t){if(!this.isExistEyeBlinkParameters())return null;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(this.name).getRawString()==this.eyeBlink)return tt.getIdManager().getId(i.getValueByString(this.ids).getValueByIndex(t).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(this.name).getRawString()==this.lipSync){t=i.getValueByString(this.ids).getVector().getSize();break}}return t}getLipSyncParameterId(t){if(!this.isExistLipSyncParameters())return null;for(let s=0;s<this._jsonValue.at(0).getSize();s++){const i=this._jsonValue.at(0).getValueByIndex(s);if(!(i.isNull()||i.isError())&&i.getValueByString(this.name).getRawString()==this.lipSync)return tt.getIdManager().getId(i.getValueByString(this.ids).getValueByIndex(t).getRawString())}return null}isExistModelFile(){const t=this._jsonValue.at(1);return!t.isNull()&&!t.isError()}isExistTextureFiles(){const t=this._jsonValue.at(4);return!t.isNull()&&!t.isError()}isExistHitAreas(){const t=this._jsonValue.at(7);return!t.isNull()&&!t.isError()}isExistPhysicsFile(){const t=this._jsonValue.at(5);return!t.isNull()&&!t.isError()}isExistPoseFile(){const t=this._jsonValue.at(6);return!t.isNull()&&!t.isError()}isExistExpressionFile(){const t=this._jsonValue.at(3);return!t.isNull()&&!t.isError()}isExistMotionGroups(){const t=this._jsonValue.at(2);return!t.isNull()&&!t.isError()}isExistMotionGroupName(t){const s=this._jsonValue.at(2).getValueByString(t);return!s.isNull()&&!s.isError()}isExistMotionSoundFile(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.soundPath);return!i.isNull()&&!i.isError()}isExistMotionFadeIn(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.fadeInTime);return!i.isNull()&&!i.isError()}isExistMotionFadeOut(t,s){const i=this._jsonValue.at(2).getValueByString(t).getValueByIndex(s).getValueByString(this.fadeOutTime);return!i.isNull()&&!i.isError()}isExistUserDataFile(){const t=this.getJson().getRoot().getValueByString(this.fileReferences).getValueByString(this.userData);return!t.isNull()&&!t.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let t=0;t<this._jsonValue.at(0).getSize();++t)if(this._jsonValue.at(0).getValueByIndex(t).getValueByString(this.name).getRawString()==this.eyeBlink)return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let t=0;t<this._jsonValue.at(0).getSize();++t)if(this._jsonValue.at(0).getValueByIndex(t).getValueByString(this.name).getRawString()==this.lipSync)return!0;return!1}};var sr;(e=>{e.CubismModelSettingJson=Jc,e.FrequestNode=wo})(sr||(sr={}));class pi{static create(){return new pi}static delete(t){}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,s){this._currentTime+=s;const i=this._currentTime*2*Math.PI;for(let r=0;r<this._breathParameters.getSize();++r){const n=this._breathParameters.at(r);t.addParameterValueById(n.parameterId,n.offset+n.peak*Math.sin(i/n.cycle),n.weight)}}constructor(){this._currentTime=0}}class Kc{constructor(t,s,i,r,n){this.parameterId=t??null,this.offset=s??0,this.peak=i??0,this.cycle=r??0,this.weight=n??0}}var Fn;(e=>{e.BreathParameterData=Kc,e.CubismBreath=pi})(Fn||(Fn={}));var fe;let Fo=(fe=class{static create(t=null){return new fe(t)}static delete(t){}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,s,i){this._closingSeconds=t,this._closedSeconds=s,this._openingSeconds=i}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,s){this._userTimeSeconds+=s;let i,r=0;switch(this._blinkingState){case 2:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,r>=1&&(r=1,this._blinkingState=3,this._stateStartTimeSeconds=this._userTimeSeconds),i=1-r;break;case 3:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,r>=1&&(this._blinkingState=4,this._stateStartTimeSeconds=this._userTimeSeconds),i=0;break;case 4:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,r>=1&&(r=1,this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming()),i=r;break;case 1:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=2,this._stateStartTimeSeconds=this._userTimeSeconds),i=1;break;case 0:default:this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming(),i=1;break}fe.CloseIfZero||(i=-i);for(let a=0;a<this._parameterIds.getSize();++a)t.setParameterValueById(this._parameterIds.at(a),i)}constructor(t){if(this._blinkingState=0,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new D,t!=null)for(let s=0;s<t.getEyeBlinkParameterCount();++s)this._parameterIds.pushBack(t.getEyeBlinkParameterId(s))}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}},fe.CloseIfZero=!0,fe);var To=(e=>(e[e.EyeState_First=0]="EyeState_First",e[e.EyeState_Interval=1]="EyeState_Interval",e[e.EyeState_Closing=2]="EyeState_Closing",e[e.EyeState_Closed=3]="EyeState_Closed",e[e.EyeState_Opening=4]="EyeState_Opening",e))(To||{}),ir;(e=>{e.CubismEyeBlink=Fo,e.EyeState=To})(ir||(ir={}));const Zc=.001,Ti=.5,Tn="FadeInTime",Rn="Link",Qc="Groups",th="Id";class Is{static create(t,s){const i=lt.create(t,s);if(!i)return null;const r=new Is,n=i.getRoot();n.getValueByString(Tn).isNull()||(r._fadeTimeSeconds=n.getValueByString(Tn).toFloat(Ti),r._fadeTimeSeconds<0&&(r._fadeTimeSeconds=Ti));const a=n.getValueByString(Qc),o=a.getSize();for(let l=0;l<o;++l){const c=a.getValueByIndex(l),u=c.getSize();let h=0;for(let _=0;_<u;++_){const d=c.getValueByIndex(_),p=new Vs,y=tt.getIdManager().getId(d.getValueByString(th).getRawString());if(p.partId=y,!d.getValueByString(Rn).isNull()){const m=d.getValueByString(Rn),I=m.getSize();for(let T=0;T<I;++T){const b=new Vs,x=tt.getIdManager().getId(m.getValueByIndex(T).getString());b.partId=x,p.link.pushBack(b)}}r._partGroups.pushBack(p.clone()),++h}r._partGroupCounts.pushBack(h)}return lt.delete(i),r}static delete(t){}updateParameters(t,s){t!=this._lastModel&&this.reset(t),this._lastModel=t,s<0&&(s=0);let i=0;for(let r=0;r<this._partGroupCounts.getSize();r++){const n=this._partGroupCounts.at(r);this.doFade(t,s,i,n),i+=n}this.copyPartOpacities(t)}reset(t){let s=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const r=this._partGroupCounts.at(i);for(let n=s;n<s+r;++n){this._partGroups.at(n).initialize(t);const a=this._partGroups.at(n).partIndex,o=this._partGroups.at(n).parameterIndex;if(!(a<0)){t.setPartOpacityByIndex(a,n==s?1:0),t.setParameterValueByIndex(o,n==s?1:0);for(let l=0;l<this._partGroups.at(n).link.getSize();++l)this._partGroups.at(n).link.at(l).initialize(t)}}s+=r}}copyPartOpacities(t){for(let s=0;s<this._partGroups.getSize();++s){const i=this._partGroups.at(s);if(i.link.getSize()==0)continue;const r=this._partGroups.at(s).partIndex,n=t.getPartOpacityByIndex(r);for(let a=0;a<i.link.getSize();++a){const l=i.link.at(a).partIndex;l<0||t.setPartOpacityByIndex(l,n)}}}doFade(t,s,i,r){let n=-1,a=1;const o=.5,l=.15;for(let c=i;c<i+r;++c){const u=this._partGroups.at(c).partIndex,h=this._partGroups.at(c).parameterIndex;if(t.getParameterValueByIndex(h)>Zc){if(n>=0)break;if(n=c,this._fadeTimeSeconds==0){a=1;continue}a=t.getPartOpacityByIndex(u),a+=s/this._fadeTimeSeconds,a>1&&(a=1)}}n<0&&(n=0,a=1);for(let c=i;c<i+r;++c){const u=this._partGroups.at(c).partIndex;if(n==c)t.setPartOpacityByIndex(u,a);else{let h=t.getPartOpacityByIndex(u),_;a<o?_=a*(o-1)/o+1:_=(1-a)*o/(1-o),(1-_)*(1-a)>l&&(_=1-l/(1-a)),h>_&&(h=_),t.setPartOpacityByIndex(u,h)}}}constructor(){this._fadeTimeSeconds=Ti,this._lastModel=null,this._partGroups=new D,this._partGroupCounts=new D}}class Vs{constructor(t){if(this.parameterIndex=0,this.partIndex=0,this.link=new D,t!=null){this.partId=t.partId;for(const s=t.link.begin();s.notEqual(t.link.end());s.preIncrement())this.link.pushBack(s.ptr().clone())}}assignment(t){this.partId=t.partId;for(const s=t.link.begin();s.notEqual(t.link.end());s.preIncrement())this.link.pushBack(s.ptr().clone());return this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new Vs;t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=new D;for(let s=this.link.begin();s.notEqual(this.link.end());s.increment())t.link.pushBack(s.ptr().clone());return t}}var En;(e=>{e.CubismPose=Is,e.PartData=Vs})(En||(En={}));class Ro extends ge{constructor(t,s){super(),this._width=t!==void 0?t:0,this._height=s!==void 0?s:0,this.setHeight(2)}setWidth(t){const s=t/this._width,i=s;this.scale(s,i)}setHeight(t){const s=t/this._height,i=s;this.scale(s,i)}setPosition(t,s){this.translate(t,s)}setCenterPosition(t,s){this.centerX(t),this.centerY(s)}top(t){this.setY(t)}bottom(t){const s=this._height*this.getScaleY();this.translateY(t-s)}left(t){this.setX(t)}right(t){const s=this._width*this.getScaleX();this.translateX(t-s)}centerX(t){const s=this._width*this.getScaleX();this.translateX(t-s/2)}setX(t){this.translateX(t)}centerY(t){const s=this._height*this.getScaleY();this.translateY(t-s/2)}setY(t){this.translateY(t)}setupFromLayout(t){const s="width",i="height",a="center_x",o="center_y",c="bottom",u="left",h="right";for(const _=t.begin();_.notEqual(t.end());_.preIncrement()){const d=_.ptr().first,p=_.ptr().second;d==s?this.setWidth(p):d==i&&this.setHeight(p)}for(const _=t.begin();_.notEqual(t.end());_.preIncrement()){const d=_.ptr().first,p=_.ptr().second;d=="x"?this.setX(p):d=="y"?this.setY(p):d==a?this.centerX(p):d==o?this.centerY(p):d=="top"?this.top(p):d==c?this.bottom(p):d==u?this.left(p):d==h&&this.right(p)}}}var Dn;(e=>{e.CubismModelMatrix=Ro})(Dn||(Dn={}));class E{constructor(t,s){this.x=t,this.y=s,this.x=t??0,this.y=s??0}add(t){const s=new E(0,0);return s.x=this.x+t.x,s.y=this.y+t.y,s}substract(t){const s=new E(0,0);return s.x=this.x-t.x,s.y=this.y-t.y,s}multiply(t){const s=new E(0,0);return s.x=this.x*t.x,s.y=this.y*t.y,s}multiplyByScaler(t){return this.multiply(new E(t,t))}division(t){const s=new E(0,0);return s.x=this.x/t.x,s.y=this.y/t.y,s}divisionByScalar(t){return this.division(new E(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}var On;(e=>{e.CubismVector2=E})(On||(On={}));const je=class je{static range(t,s,i){return t<s?t=s:t>i&&(t=i),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static cbrt(t){if(t===0)return t;let s=t;const i=s<0;i&&(s=-s);let r;return s===1/0?r=1/0:(r=Math.exp(Math.log(s)/3),r=(s/(r*r)+2*r)/3),i?-r:r}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,s){return t>s?t:s}static min(t,s){return t>s?s:t}static clamp(t,s,i){return t<s?s:i<t?i:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return t*180/Math.PI}static directionToRadian(t,s){const i=Math.atan2(s.y,s.x),r=Math.atan2(t.y,t.x);let n=i-r;for(;n<-Math.PI;)n+=Math.PI*2;for(;n>Math.PI;)n-=Math.PI*2;return n}static directionToDegrees(t,s){const i=this.directionToRadian(t,s);let r=this.radianToDegrees(i);return s.x-t.x>0&&(r=-r),r}static radianToDirection(t){const s=new E;return s.x=this.sin(t),s.y=this.cos(t),s}static quadraticEquation(t,s,i){return this.abs(t)<je.Epsilon?this.abs(s)<je.Epsilon?-i:-i/s:-(s+this.sqrt(s*s-4*t*i))/(2*t)}static cardanoAlgorithmForBezier(t,s,i,r){if(this.abs(t)<je.Epsilon)return this.range(this.quadraticEquation(s,i,r),0,1);const n=s/t,a=i/t,o=r/t,l=(3*a-n*n)/3,c=l/3,u=(2*n*n*n-9*n*a+27*o)/27,h=u/2,_=h*h+c*c*c,d=.5,p=d+.01;if(_<0){const b=-l/3,x=b*b*b,R=this.sqrt(x),N=-u/(2*R),W=this.range(N,-1,1),rt=Math.acos(W),q=2*this.cbrt(R),Rt=q*this.cos(rt/3)-n/3;if(this.abs(Rt-d)<p)return this.range(Rt,0,1);const _e=q*this.cos((rt+2*Math.PI)/3)-n/3;if(this.abs(_e-d)<p)return this.range(_e,0,1);const Te=q*this.cos((rt+4*Math.PI)/3)-n/3;return this.range(Te,0,1)}if(_==0){let b;h<0?b=this.cbrt(-h):b=-this.cbrt(h);const x=2*b-n/3;if(this.abs(x-d)<p)return this.range(x,0,1);const R=-b-n/3;return this.range(R,0,1)}const y=this.sqrt(_),m=this.cbrt(y-h),I=this.cbrt(y+h),T=m-I-n/3;return this.range(T,0,1)}static mod(t,s){if(!isFinite(t)||s===0||isNaN(t)||isNaN(s))return console.warn(`divided: ${t}, divisor: ${s} mod() returns 'NaN'.`),NaN;const i=Math.abs(t),r=Math.abs(s);let n=i-Math.floor(i/r)*r;return n*=Math.sign(t),n}constructor(){}};je.Epsilon=1e-5;let A=je;var Ln;(e=>{e.CubismMath=A})(Ln||(Ln={}));const Ri=30,An=.01;class Eo{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(t){this._userTimeSeconds+=t;const i=40/10*1/Ri;if(this._lastTimeSeconds==0){this._lastTimeSeconds=this._userTimeSeconds;return}const r=(this._userTimeSeconds-this._lastTimeSeconds)*Ri;this._lastTimeSeconds=this._userTimeSeconds;const a=.15*Ri,o=r*i/a,l=this._faceTargetX-this._faceX,c=this._faceTargetY-this._faceY;if(A.abs(l)<=An&&A.abs(c)<=An)return;const u=A.sqrt(l*l+c*c),h=i*l/u,_=i*c/u;let d=h-this._faceVX,p=_-this._faceVY;const y=A.sqrt(d*d+p*p);(y<-o||y>o)&&(d*=o/y,p*=o/y),this._faceVX+=d,this._faceVY+=p;{const m=.5*(A.sqrt(o*o+16*o*u-8*o*u)-o),I=A.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);I>m&&(this._faceVX*=m/I,this._faceVY*=m/I)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(t,s){this._faceTargetX=t,this._faceTargetY=s}}var kn;(e=>{e.CubismTargetPoint=Eo})(kn||(kn={}));let _i=class{constructor(){this.setBeganMotionHandler=t=>this._onBeganMotion=t,this.getBeganMotionHandler=()=>this._onBeganMotion,this.setFinishedMotionHandler=t=>this._onFinishedMotion=t,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._isLoop=!1,this._isLoopFadeIn=!0,this._previousLoopState=this._isLoop,this._firedEventValues=new D}static delete(t){t.release(),t=null}release(){this._weight=0}updateParameters(t,s,i){if(!s.isAvailable()||s.isFinished())return;this.setupMotionQueueEntry(s,i);const r=this.updateFadeWeight(s,i);this.doUpdateParameters(t,i,r,s),s.getEndTime()>0&&s.getEndTime()<i&&s.setIsFinished(!0)}setupMotionQueueEntry(t,s){t==null||t.isStarted()||t.isAvailable()&&(t.setIsStarted(!0),t.setStartTime(s-this._offsetSeconds),t.setFadeInStartTime(s),t.getEndTime()<0&&this.adjustEndTime(t),t._motion._onBeganMotion&&t._motion._onBeganMotion(t._motion))}updateFadeWeight(t,s){t==null&&Or.print(Ue.LogLevel_Error,"motionQueueEntry is null.");let i=this._weight;const r=this._fadeInSeconds==0?1:A.getEasingSine((s-t.getFadeInStartTime())/this._fadeInSeconds),n=this._fadeOutSeconds==0||t.getEndTime()<0?1:A.getEasingSine((t.getEndTime()-s)/this._fadeOutSeconds);return i=i*r*n,t.setState(s,i),bt(0<=i&&i<=1),i}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}setLoop(t){this._isLoop=t}getLoop(){return this._isLoop}setLoopFadeIn(t){this._isLoopFadeIn=t}getLoopFadeIn(){return this._isLoopFadeIn}getFiredEvent(t,s){return this._firedEventValues}isExistModelOpacity(){return!1}getModelOpacityIndex(){return-1}getModelOpacityId(t){return null}getModelOpacityValue(){return 1}adjustEndTime(t){const s=this.getDuration(),i=s<=0?-1:t.getStartTime()+s;t.setEndTime(i)}};var rr;(e=>{e.ACubismMotion=_i})(rr||(rr={}));const eh="FadeInTime",sh="FadeOutTime",Nn="Parameters",ih="Id",rh="Value",Ns="Blend",nh="Add",ah="Multiply",oh="Overwrite",Un=1;var ut;let ze=(ut=class extends _i{static create(t,s){const i=new ut;return i.parse(t,s),i}doUpdateParameters(t,s,i,r){for(let n=0;n<this._parameters.getSize();++n){const a=this._parameters.at(n);switch(a.blendType){case 0:{t.addParameterValueById(a.parameterId,a.value,i);break}case 1:{t.multiplyParameterValueById(a.parameterId,a.value,i);break}case 2:{t.setParameterValueById(a.parameterId,a.value,i);break}}}}calculateExpressionParameters(t,s,i,r,n,a){if(!(i==null||r==null)&&i.isAvailable()){this._fadeWeight=this.updateFadeWeight(i,s);for(let o=0;o<r.getSize();++o){const l=r.at(o);if(l.parameterId==null)continue;const c=l.overwriteValue=t.getParameterValueById(l.parameterId),u=this.getExpressionParameters();let h=-1;for(let m=0;m<u.getSize();++m)if(l.parameterId==u.at(m).parameterId){h=m;break}if(h<0){n==0?(l.additiveValue=ut.DefaultAdditiveValue,l.multiplyValue=ut.DefaultMultiplyValue,l.overwriteValue=c):(l.additiveValue=this.calculateValue(l.additiveValue,ut.DefaultAdditiveValue,a),l.multiplyValue=this.calculateValue(l.multiplyValue,ut.DefaultMultiplyValue,a),l.overwriteValue=this.calculateValue(l.overwriteValue,c,a));continue}const _=u.at(h).value;let d,p,y;switch(u.at(h).blendType){case 0:d=_,p=ut.DefaultMultiplyValue,y=c;break;case 1:d=ut.DefaultAdditiveValue,p=_,y=c;break;case 2:d=ut.DefaultAdditiveValue,p=ut.DefaultMultiplyValue,y=_;break;default:return}n==0?(l.additiveValue=d,l.multiplyValue=p,l.overwriteValue=y):(l.additiveValue=l.additiveValue*(1-a)+d*a,l.multiplyValue=l.multiplyValue*(1-a)+p*a,l.overwriteValue=l.overwriteValue*(1-a)+y*a)}}}getExpressionParameters(){return this._parameters}getFadeWeight(){return this._fadeWeight}parse(t,s){const i=lt.create(t,s);if(!i)return;const r=i.getRoot();this.setFadeInTime(r.getValueByString(eh).toFloat(Un)),this.setFadeOutTime(r.getValueByString(sh).toFloat(Un));const n=r.getValueByString(Nn).getSize();this._parameters.prepareCapacity(n);for(let a=0;a<n;++a){const o=r.getValueByString(Nn).getValueByIndex(a),l=tt.getIdManager().getId(o.getValueByString(ih).getRawString()),c=o.getValueByString(rh).toFloat();let u;o.getValueByString(Ns).isNull()||o.getValueByString(Ns).getString()==nh?u=0:o.getValueByString(Ns).getString()==ah?u=1:o.getValueByString(Ns).getString()==oh?u=2:u=0;const h=new Oo;h.parameterId=l,h.blendType=u,h.value=c,this._parameters.pushBack(h)}lt.delete(i)}calculateValue(t,s,i){return t*(1-i)+s*i}constructor(){super(),this._parameters=new D,this._fadeWeight=0}},ut.DefaultAdditiveValue=0,ut.DefaultMultiplyValue=1,ut);var Do=(e=>(e[e.Additive=0]="Additive",e[e.Multiply=1]="Multiply",e[e.Overwrite=2]="Overwrite",e))(Do||{});class Oo{}var nr;(e=>{e.CubismExpressionMotion=ze,e.ExpressionBlendType=Do,e.ExpressionParameter=Oo})(nr||(nr={}));class Lo{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&_i.delete(this._motion)}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,s){const i=s+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,s){this._stateTimeSeconds=t,this._stateWeight=s}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}getCubismMotion(){return this._motion}}var zn;(e=>{e.CubismMotionQueueEntry=Lo})(zn||(zn={}));class Ar{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new D}release(){for(let t=0;t<this._motions.getSize();++t)this._motions.at(t)&&(this._motions.at(t).release(),this._motions.set(t,null));this._motions=null}startMotion(t,s,i){if(t==null)return Ao;let r=null;for(let n=0;n<this._motions.getSize();++n)r=this._motions.at(n),r?.setFadeOut(r._motion.getFadeOutTime());return r=new Lo,r._autoDelete=s,r._motion=t,this._motions.pushBack(r),r._motionQueueEntryHandle}isFinished(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let s=t.ptr();if(s==null){t=this._motions.erase(t);continue}if(s._motion==null){s.release(),s=null,t=this._motions.erase(t);continue}if(s.isFinished())t.preIncrement();else return!1}return!0}isFinishedByHandle(t){for(let s=this._motions.begin();s.notEqual(this._motions.end());s.increment()){const i=s.ptr();if(i!=null&&i._motionQueueEntryHandle==t&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let s=t.ptr();if(s==null){t=this._motions.erase(t);continue}s.release(),s=null,t=this._motions.erase(t)}}getCubismMotionQueueEntries(){return this._motions}getCubismMotionQueueEntry(t){for(let s=this._motions.begin();s.notEqual(this._motions.end());s.preIncrement()){const i=s.ptr();if(i!=null&&i._motionQueueEntryHandle==t)return i}return null}setEventCallback(t,s=null){this._eventCallBack=t,this._eventCustomData=s}doUpdateMotion(t,s){let i=!1;for(let r=this._motions.begin();r.notEqual(this._motions.end());){let n=r.ptr();if(n==null){r=this._motions.erase(r);continue}const a=n._motion;if(a==null){n.release(),n=null,r=this._motions.erase(r);continue}a.updateParameters(t,n,s),i=!0;const o=a.getFiredEvent(n.getLastCheckEventSeconds()-n.getStartTime(),s-n.getStartTime());for(let l=0;l<o.getSize();++l)this._eventCallBack(this,o.at(l),this._eventCustomData);n.setLastCheckEventSeconds(s),n.isFinished()?(n.release(),n=null,r=this._motions.erase(r)):(n.isTriggeredFadeOut()&&n.startFadeOut(n.getFadeOutSeconds(),s),r.preIncrement())}return i}}const Ao=-1;var jn;(e=>{e.CubismMotionQueueManager=Ar,e.InvalidMotionQueueEntryHandleValue=Ao})(jn||(jn={}));class lh{}class ko extends Ar{constructor(){super(),this._currentPriority=0,this._reservePriority=0,this._expressionParameterValues=new D,this._fadeWeights=new D}release(){this._expressionParameterValues&&(Ne(this._expressionParameterValues),this._expressionParameterValues=null),this._fadeWeights&&(Ne(this._fadeWeights),this._fadeWeights=null)}getCurrentPriority(){return Ft("CubismExpressionMotionManager.getCurrentPriority() is deprecated because a priority value is not actually used during expression motion playback."),this._currentPriority}getReservePriority(){return Ft("CubismExpressionMotionManager.getReservePriority() is deprecated because a priority value is not actually used during expression motion playback."),this._reservePriority}getFadeWeight(t){return t<0||this._fadeWeights.getSize()<1||t>=this._fadeWeights.getSize()?(console.warn("Failed to get the fade weight value. The element at that index does not exist."),-1):this._fadeWeights.at(t)}setFadeWeight(t,s){if(t<0||this._fadeWeights.getSize()<1||this._fadeWeights.getSize()<=t){console.warn("Failed to set the fade weight value. The element at that index does not exist.");return}this._fadeWeights.set(t,s)}setReservePriority(t){Ft("CubismExpressionMotionManager.setReservePriority() is deprecated because a priority value is not actually used during expression motion playback."),this._reservePriority=t}startMotionPriority(t,s,i){return Ft("CubismExpressionMotionManager.startMotionPriority() is deprecated because a priority value is not actually used during expression motion playback."),i==this.getReservePriority()&&this.setReservePriority(0),this._currentPriority=i,this.startMotion(t,s)}updateMotion(t,s){this._userTimeSeconds+=s;let i=!1;const r=this.getCubismMotionQueueEntries();let n=0,a=0;if(this._fadeWeights.getSize()!==r.getSize()){const o=r.getSize()-this._fadeWeights.getSize();for(let l=0;l<o;l++)this._fadeWeights.pushBack(0)}for(let o=this._motions.begin();o.notEqual(this._motions.end());){const l=o.ptr();if(l==null){o=r.erase(o);continue}const c=l.getCubismMotion();if(c==null){Ne(l),o=r.erase(o);continue}const u=c.getExpressionParameters();if(l.isAvailable())for(let h=0;h<u.getSize();++h){if(u.at(h).parameterId==null)continue;let _=-1;for(let p=0;p<this._expressionParameterValues.getSize();++p)if(this._expressionParameterValues.at(p).parameterId==u.at(h).parameterId){_=p;break}if(_>=0)continue;const d=new lh;d.parameterId=u.at(h).parameterId,d.additiveValue=ze.DefaultAdditiveValue,d.multiplyValue=ze.DefaultMultiplyValue,d.overwriteValue=t.getParameterValueById(d.parameterId),this._expressionParameterValues.pushBack(d)}c.setupMotionQueueEntry(l,this._userTimeSeconds),this.setFadeWeight(a,c.updateFadeWeight(l,this._userTimeSeconds)),c.calculateExpressionParameters(t,this._userTimeSeconds,l,this._expressionParameterValues,a,this.getFadeWeight(a)),n+=c.getFadeInTime()==0?1:A.getEasingSine((this._userTimeSeconds-l.getFadeInStartTime())/c.getFadeInTime()),i=!0,l.isTriggeredFadeOut()&&l.startFadeOut(l.getFadeOutSeconds(),this._userTimeSeconds),o.preIncrement(),++a}if(r.getSize()>1&&this.getFadeWeight(this._fadeWeights.getSize()-1)>=1)for(let l=r.getSize()-2;l>=0;--l){const c=r.at(l);Ne(c),r.remove(l),this._fadeWeights.remove(l)}n>1&&(n=1);for(let o=0;o<this._expressionParameterValues.getSize();++o){const l=this._expressionParameterValues.at(o);t.setParameterValueById(l.parameterId,(l.overwriteValue+l.additiveValue)*l.multiplyValue,n),l.additiveValue=ze.DefaultAdditiveValue,l.multiplyValue=ze.DefaultMultiplyValue}return i}}var Xn;(e=>{e.CubismExpressionMotionManager=ko})(Xn||(Xn={}));var Dt=(e=>(e[e.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",e[e.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",e[e.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",e))(Dt||{}),at=(e=>(e[e.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",e[e.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",e[e.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",e[e.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",e))(at||{});class ws{constructor(){this.time=0,this.value=0}}class No{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}}class Uo{constructor(){this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class zo{constructor(){this.fireTime=0}}class jo{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new D,this.segments=new D,this.points=new D,this.events=new D}}var Gn;(e=>{e.CubismMotionCurve=Uo,e.CubismMotionCurveTarget=Dt,e.CubismMotionData=jo,e.CubismMotionEvent=zo,e.CubismMotionPoint=ws,e.CubismMotionSegment=No,e.CubismMotionSegmentType=at})(Gn||(Gn={}));const Pt="Meta",uh="Duration",ch="Loop",hh="AreBeziersRestricted",gh="CurveCount",dh="Fps",fh="TotalSegmentCount",ph="TotalPointCount",Kt="Curves",_h="Target",mh="Id",Us="FadeInTime",zs="FadeOutTime",Wn="Segments",Hn="UserData",yh="UserDataCount",Ch="TotalUserDataSize",xh="Time",Sh="Value";class Xo{constructor(t,s){this._json=lt.create(t,s)}release(){lt.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(Pt).getValueByString(uh).toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(Pt).getValueByString(ch).toBoolean()}hasConsistency(){let t=!0;if(!this._json||!this._json.getRoot())return!1;const s=this._json.getRoot().getValueByString(Kt).getVector().getSize();let i=0,r=0;for(let n=0;n<s;++n)for(let a=0;a<this.getMotionCurveSegmentCount(n);){switch(a==0&&(r+=1,a+=2),this.getMotionCurveSegment(n,a)){case at.CubismMotionSegmentType_Linear:r+=1,a+=3;break;case at.CubismMotionSegmentType_Bezier:r+=3,a+=7;break;case at.CubismMotionSegmentType_Stepped:r+=1,a+=3;break;case at.CubismMotionSegmentType_InverseStepped:r+=1,a+=3;break;default:bt(0);break}++i}return s!=this.getMotionCurveCount()&&(G("The number of curves does not match the metadata."),t=!1),i!=this.getMotionTotalSegmentCount()&&(G("The number of segment does not match the metadata."),t=!1),r!=this.getMotionTotalPointCount()&&(G("The number of point does not match the metadata."),t=!1),t}getEvaluationOptionFlag(t){return t==0?this._json.getRoot().getValueByString(Pt).getValueByString(hh).toBoolean():!1}getMotionCurveCount(){return this._json.getRoot().getValueByString(Pt).getValueByString(gh).toInt()}getMotionFps(){return this._json.getRoot().getValueByString(Pt).getValueByString(dh).toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(Pt).getValueByString(fh).toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(Pt).getValueByString(ph).toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(Pt).getValueByString(Us).isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(Pt).getValueByString(zs).isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(Pt).getValueByString(Us).toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(Pt).getValueByString(zs).toFloat()}getMotionCurveTarget(t){return this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(_h).getRawString()}getMotionCurveId(t){return tt.getIdManager().getId(this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(mh).getRawString())}isExistMotionCurveFadeInTime(t){return!this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(Us).isNull()}isExistMotionCurveFadeOutTime(t){return!this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(zs).isNull()}getMotionCurveFadeInTime(t){return this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(Us).toFloat()}getMotionCurveFadeOutTime(t){return this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(zs).toFloat()}getMotionCurveSegmentCount(t){return this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(Wn).getVector().getSize()}getMotionCurveSegment(t,s){return this._json.getRoot().getValueByString(Kt).getValueByIndex(t).getValueByString(Wn).getValueByIndex(s).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(Pt).getValueByString(yh).toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(Pt).getValueByString(Ch).toInt()}getEventTime(t){return this._json.getRoot().getValueByString(Hn).getValueByIndex(t).getValueByString(xh).toFloat()}getEventValue(t){return new Tt(this._json.getRoot().getValueByString(Hn).getValueByIndex(t).getValueByString(Sh).getRawString())}}var Go=(e=>(e[e.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",e))(Go||{}),$n;(e=>{e.CubismMotionJson=Xo})($n||($n={}));const bh="EyeBlink",Mh="LipSync",vh="Model",Ph="Parameter",Bh="PartOpacity",js="Opacity",Ih=!1;function wt(e,t,s){const i=new ws;return i.time=e.time+(t.time-e.time)*s,i.value=e.value+(t.value-e.value)*s,i}function Wo(e,t){let s=(t-e[0].time)/(e[1].time-e[0].time);return s<0&&(s=0),e[0].value+(e[1].value-e[0].value)*s}function Vh(e,t){let s=(t-e[0].time)/(e[3].time-e[0].time);s<0&&(s=0);const i=wt(e[0],e[1],s),r=wt(e[1],e[2],s),n=wt(e[2],e[3],s),a=wt(i,r,s),o=wt(r,n,s);return wt(a,o,s).value}function wh(e,t){const s=t,i=e[0].time,r=e[3].time,n=e[1].time,a=e[2].time,o=r-3*a+3*n-i,l=3*a-6*n+3*i,c=3*n-3*i,u=i-s,h=A.cardanoAlgorithmForBezier(o,l,c,u),_=wt(e[0],e[1],h),d=wt(e[1],e[2],h),p=wt(e[2],e[3],h),y=wt(_,d,h),m=wt(d,p,h);return wt(y,m,h).value}function Ho(e,t){return e[0].value}function $o(e,t){return e[1].value}function Ei(e,t,s,i,r){const n=e.curves.at(t);let a=-1;const o=n.baseSegmentIndex+n.segmentCount;let l=0;for(let u=n.baseSegmentIndex;u<o;++u)if(l=e.segments.at(u).basePointIndex+(e.segments.at(u).segmentType==at.CubismMotionSegmentType_Bezier?3:1),e.points.at(l).time>s){a=u;break}if(a==-1)return i&&s<r?Fh(e,o-1,e.segments.at(n.baseSegmentIndex).basePointIndex,l,s,r):e.points.at(l).value;const c=e.segments.at(a);return c.evaluate(e.points.get(c.basePointIndex),s)}function Fh(e,t,s,i,r,n){const a=[new ws,new ws];{const o=e.points.at(i);a[0].time=o.time,a[0].value=o.value}{const o=e.points.at(s);a[1].time=n,a[1].value=o.value}switch(e.segments.at(t).segmentType){case at.CubismMotionSegmentType_Linear:case at.CubismMotionSegmentType_Bezier:default:return Wo(a,r);case at.CubismMotionSegmentType_Stepped:return Ho(a);case at.CubismMotionSegmentType_InverseStepped:return $o(a)}}let Yo=class qo extends _i{constructor(){super(),this._motionBehavior=1,this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._modelCurveIdOpacity=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null,this._modelOpacity=1,this._debugMode=!1}static create(t,s,i,r,n=!1){const a=new qo;if(a.parse(t,s,n),a._motionData)a._sourceFrameRate=a._motionData.fps,a._loopDurationSeconds=a._motionData.duration,a._onFinishedMotion=i,a._onBeganMotion=r;else return Ne(a),null;return a}doUpdateParameters(t,s,i,r){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=tt.getIdManager().getId(bh)),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=tt.getIdManager().getId(Mh)),this._modelCurveIdOpacity==null&&(this._modelCurveIdOpacity=tt.getIdManager().getId(js)),this._motionBehavior===1&&this._previousLoopState!==this._isLoop&&(this.adjustEndTime(r),this._previousLoopState=this._isLoop);let n=s-r.getStartTime();n<0&&(n=0);let a=Number.MAX_VALUE,o=Number.MAX_VALUE;const l=64;let c=0,u=0;this._eyeBlinkParameterIds.getSize()>l&&Ps("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>l&&Ps("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const h=this._fadeInSeconds<=0?1:A.getEasingSine((s-r.getFadeInStartTime())/this._fadeInSeconds),_=this._fadeOutSeconds<=0||r.getEndTime()<0?1:A.getEasingSine((r.getEndTime()-s)/this._fadeOutSeconds);let d,p,y,m=n,I=this._motionData.duration;const T=this._motionBehavior===1&&this._isLoop;if(this._isLoop)for(this._motionBehavior===1&&(I+=1/this._motionData.fps);m>I;)m-=I;const b=this._motionData.curves;for(p=0;p<this._motionData.curveCount&&b.at(p).type==Dt.CubismMotionCurveTarget_Model;++p)d=Ei(this._motionData,p,m,T,I),b.at(p).id==this._modelCurveIdEyeBlink?o=d:b.at(p).id==this._modelCurveIdLipSync?a=d:b.at(p).id==this._modelCurveIdOpacity&&(this._modelOpacity=d,t.setModelOapcity(this.getModelOpacityValue()));for(;p<this._motionData.curveCount&&b.at(p).type==Dt.CubismMotionCurveTarget_Parameter;++p){if(y=t.getParameterIndex(b.at(p).id),y==-1)continue;const x=t.getParameterValueByIndex(y);if(d=Ei(this._motionData,p,m,T,I),o!=Number.MAX_VALUE){for(let N=0;N<this._eyeBlinkParameterIds.getSize()&&N<l;++N)if(this._eyeBlinkParameterIds.at(N)==b.at(p).id){d*=o,u|=1<<N;break}}if(a!=Number.MAX_VALUE){for(let N=0;N<this._lipSyncParameterIds.getSize()&&N<l;++N)if(this._lipSyncParameterIds.at(N)==b.at(p).id){d+=a,c|=1<<N;break}}t.isRepeat(y)&&(d=t.getParameterRepeatValue(y,d));let R;if(b.at(p).fadeInTime<0&&b.at(p).fadeOutTime<0)R=x+(d-x)*i;else{let N,W;b.at(p).fadeInTime<0?N=h:N=b.at(p).fadeInTime==0?1:A.getEasingSine((s-r.getFadeInStartTime())/b.at(p).fadeInTime),b.at(p).fadeOutTime<0?W=_:W=b.at(p).fadeOutTime==0||r.getEndTime()<0?1:A.getEasingSine((r.getEndTime()-s)/b.at(p).fadeOutTime);const rt=this._weight*N*W;R=x+(d-x)*rt}t.setParameterValueByIndex(y,R,1)}{if(o!=Number.MAX_VALUE)for(let x=0;x<this._eyeBlinkParameterIds.getSize()&&x<l;++x){const R=t.getParameterValueById(this._eyeBlinkParameterIds.at(x));if(u>>x&1)continue;const N=R+(o-R)*i;t.setParameterValueById(this._eyeBlinkParameterIds.at(x),N)}if(a!=Number.MAX_VALUE)for(let x=0;x<this._lipSyncParameterIds.getSize()&&x<l;++x){const R=t.getParameterValueById(this._lipSyncParameterIds.at(x));if(c>>x&1)continue;const N=R+(a-R)*i;t.setParameterValueById(this._lipSyncParameterIds.at(x),N)}}for(;p<this._motionData.curveCount&&b.at(p).type==Dt.CubismMotionCurveTarget_PartOpacity;++p)y=t.getParameterIndex(b.at(p).id),y!=-1&&(d=Ei(this._motionData,p,m,T,I),t.setParameterValueByIndex(y,d));n>=I&&(this._isLoop?this.updateForNextLoop(r,s,m):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(t){G("setIsLoop() is a deprecated function. Please use setLoop()."),this._isLoop=t}isLoop(){return G("isLoop() is a deprecated function. Please use getLoop()."),this._isLoop}setIsLoopFadeIn(t){G("setIsLoopFadeIn() is a deprecated function. Please use setLoopFadeIn()."),this._isLoopFadeIn=t}isLoopFadeIn(){return G("isLoopFadeIn() is a deprecated function. Please use getLoopFadeIn()."),this._isLoopFadeIn}setMotionBehavior(t){this._motionBehavior=t}getMotionBehavior(){return this._motionBehavior}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(t,s){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id){i.at(r).fadeInTime=s;return}}setParameterFadeOutTime(t,s){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id){i.at(r).fadeOutTime=s;return}}getParameterFadeInTime(t){const s=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==s.at(i).id)return s.at(i).fadeInTime;return-1}getParameterFadeOutTime(t){const s=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==s.at(i).id)return s.at(i).fadeOutTime;return-1}setEffectIds(t,s){this._eyeBlinkParameterIds=t,this._lipSyncParameterIds=s}release(){this._motionData=void 0,this._motionData=null}updateForNextLoop(t,s,i){switch(this._motionBehavior){case 1:default:t.setStartTime(s-i),this._isLoopFadeIn&&t.setFadeInStartTime(s-i),this._onFinishedMotion!=null&&this._onFinishedMotion(this);break;case 0:t.setStartTime(s),this._isLoopFadeIn&&t.setFadeInStartTime(s);break}}parse(t,s,i=!1){let r=new Xo(t,s);if(!r){r.release(),r=void 0;return}if(i&&!r.hasConsistency()){r.release(),it("Inconsistent motion3.json.");return}this._motionData=new jo,this._motionData.duration=r.getMotionDuration(),this._motionData.loop=r.isMotionLoop(),this._motionData.curveCount=r.getMotionCurveCount(),this._motionData.fps=r.getMotionFps(),this._motionData.eventCount=r.getEventCount();const n=r.getEvaluationOptionFlag(Go.EvaluationOptionFlag_AreBeziersRistricted);r.isExistMotionFadeInTime()?this._fadeInSeconds=r.getMotionFadeInTime()<0?1:r.getMotionFadeInTime():this._fadeInSeconds=1,r.isExistMotionFadeOutTime()?this._fadeOutSeconds=r.getMotionFadeOutTime()<0?1:r.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,Uo,!0),this._motionData.segments.updateSize(r.getMotionTotalSegmentCount(),No,!0),this._motionData.points.updateSize(r.getMotionTotalPointCount(),ws,!0),this._motionData.events.updateSize(this._motionData.eventCount,zo,!0);let a=0,o=0;for(let l=0;l<this._motionData.curveCount;++l){r.getMotionCurveTarget(l)==vh?this._motionData.curves.at(l).type=Dt.CubismMotionCurveTarget_Model:r.getMotionCurveTarget(l)==Ph?this._motionData.curves.at(l).type=Dt.CubismMotionCurveTarget_Parameter:r.getMotionCurveTarget(l)==Bh?this._motionData.curves.at(l).type=Dt.CubismMotionCurveTarget_PartOpacity:G('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!'),this._motionData.curves.at(l).id=r.getMotionCurveId(l),this._motionData.curves.at(l).baseSegmentIndex=o,this._motionData.curves.at(l).fadeInTime=r.isExistMotionCurveFadeInTime(l)?r.getMotionCurveFadeInTime(l):-1,this._motionData.curves.at(l).fadeOutTime=r.isExistMotionCurveFadeOutTime(l)?r.getMotionCurveFadeOutTime(l):-1;for(let c=0;c<r.getMotionCurveSegmentCount(l);){switch(c==0?(this._motionData.segments.at(o).basePointIndex=a,this._motionData.points.at(a).time=r.getMotionCurveSegment(l,c),this._motionData.points.at(a).value=r.getMotionCurveSegment(l,c+1),a+=1,c+=2):this._motionData.segments.at(o).basePointIndex=a-1,r.getMotionCurveSegment(l,c)){case at.CubismMotionSegmentType_Linear:{this._motionData.segments.at(o).segmentType=at.CubismMotionSegmentType_Linear,this._motionData.segments.at(o).evaluate=Wo,this._motionData.points.at(a).time=r.getMotionCurveSegment(l,c+1),this._motionData.points.at(a).value=r.getMotionCurveSegment(l,c+2),a+=1,c+=3;break}case at.CubismMotionSegmentType_Bezier:{this._motionData.segments.at(o).segmentType=at.CubismMotionSegmentType_Bezier,n||Ih?this._motionData.segments.at(o).evaluate=Vh:this._motionData.segments.at(o).evaluate=wh,this._motionData.points.at(a).time=r.getMotionCurveSegment(l,c+1),this._motionData.points.at(a).value=r.getMotionCurveSegment(l,c+2),this._motionData.points.at(a+1).time=r.getMotionCurveSegment(l,c+3),this._motionData.points.at(a+1).value=r.getMotionCurveSegment(l,c+4),this._motionData.points.at(a+2).time=r.getMotionCurveSegment(l,c+5),this._motionData.points.at(a+2).value=r.getMotionCurveSegment(l,c+6),a+=3,c+=7;break}case at.CubismMotionSegmentType_Stepped:{this._motionData.segments.at(o).segmentType=at.CubismMotionSegmentType_Stepped,this._motionData.segments.at(o).evaluate=Ho,this._motionData.points.at(a).time=r.getMotionCurveSegment(l,c+1),this._motionData.points.at(a).value=r.getMotionCurveSegment(l,c+2),a+=1,c+=3;break}case at.CubismMotionSegmentType_InverseStepped:{this._motionData.segments.at(o).segmentType=at.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(o).evaluate=$o,this._motionData.points.at(a).time=r.getMotionCurveSegment(l,c+1),this._motionData.points.at(a).value=r.getMotionCurveSegment(l,c+2),a+=1,c+=3;break}default:{bt(0);break}}++this._motionData.curves.at(l).segmentCount,++o}}for(let l=0;l<r.getEventCount();++l)this._motionData.events.at(l).fireTime=r.getEventTime(l),this._motionData.events.at(l).value=r.getEventValue(l);r.release(),r=void 0,r=null}getFiredEvent(t,s){this._firedEventValues.updateSize(0);for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events.at(i).fireTime>t&&this._motionData.events.at(i).fireTime<=s&&this._firedEventValues.pushBack(new Tt(this._motionData.events.at(i).value.s));return this._firedEventValues}isExistModelOpacity(){for(let t=0;t<this._motionData.curveCount;t++){const s=this._motionData.curves.at(t);if(s.type==Dt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(js)==0)return!0}return!1}getModelOpacityIndex(){if(this.isExistModelOpacity())for(let t=0;t<this._motionData.curveCount;t++){const s=this._motionData.curves.at(t);if(s.type==Dt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(js)==0)return t}return-1}getModelOpacityId(t){if(t!=-1){const s=this._motionData.curves.at(t);if(s.type==Dt.CubismMotionCurveTarget_Model&&s.id.getString().s.localeCompare(js)==0)return tt.getIdManager().getId(s.id.getString().s)}return null}getModelOpacityValue(){return this._modelOpacity}setDebugMode(t){this._debugMode=t}};var ar;(e=>{e.CubismMotion=Yo})(ar||(ar={}));let Jo=class extends Ar{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(t){this._reservePriority=t}startMotionPriority(t,s,i){return i==this._reservePriority&&(this._reservePriority=0),this._currentPriority=i,super.startMotion(t,s)}updateMotion(t,s){this._userTimeSeconds+=s;const i=super.doUpdateMotion(t,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),i}reserveMotion(t){return t<=this._reservePriority||t<=this._currentPriority?!1:(this._reservePriority=t,!0)}};var or;(e=>{e.CubismMotionManager=Jo})(or||(or={}));var ri=(e=>(e[e.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",e))(ri||{}),le=(e=>(e[e.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",e[e.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",e[e.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",e))(le||{});class Th{constructor(){this.gravity=new E(0,0),this.wind=new E(0,0)}}class kr{}class lr{}class Ko{constructor(){this.initialPosition=new E(0,0),this.position=new E(0,0),this.lastPosition=new E(0,0),this.lastGravity=new E(0,0),this.force=new E(0,0),this.velocity=new E(0,0)}}class Zo{constructor(){this.normalizationPosition=new lr,this.normalizationAngle=new lr}}class Qo{constructor(){this.source=new kr}}class tl{constructor(){this.destination=new kr,this.translationScale=new E(0,0)}}class el{constructor(){this.settings=new D,this.inputs=new D,this.outputs=new D,this.particles=new D,this.gravity=new E(0,0),this.wind=new E(0,0),this.fps=0}}var Yn;(e=>{e.CubismPhysicsInput=Qo,e.CubismPhysicsNormalization=lr,e.CubismPhysicsOutput=tl,e.CubismPhysicsParameter=kr,e.CubismPhysicsParticle=Ko,e.CubismPhysicsRig=el,e.CubismPhysicsSource=le,e.CubismPhysicsSubRig=Zo,e.CubismPhysicsTargetType=ri,e.PhysicsJsonEffectiveForces=Th})(Yn||(Yn={}));const ns="Position",Di="X",Oi="Y",Li="Angle",qn="Type",Jn="Id",Zt="Meta",Xs="EffectiveForces",Rh="TotalInputCount",Eh="TotalOutputCount",Dh="PhysicsSettingCount",Kn="Gravity",Zn="Wind",Oh="VertexCount",Lh="Fps",et="PhysicsSettings",Oe="Normalization",Qn="Minimum",ta="Maximum",ea="Default",sa="Reflect",ia="Weight",as="Input",Ah="Source",Se="Output",kh="Scale",Nh="VertexIndex",Uh="Destination",be="Vertices",zh="Mobility",jh="Delay",Xh="Radius",Gh="Acceleration";class sl{constructor(t,s){this._json=lt.create(t,s)}release(){lt.delete(this._json)}getGravity(){const t=new E(0,0);return t.x=this._json.getRoot().getValueByString(Zt).getValueByString(Xs).getValueByString(Kn).getValueByString(Di).toFloat(),t.y=this._json.getRoot().getValueByString(Zt).getValueByString(Xs).getValueByString(Kn).getValueByString(Oi).toFloat(),t}getWind(){const t=new E(0,0);return t.x=this._json.getRoot().getValueByString(Zt).getValueByString(Xs).getValueByString(Zn).getValueByString(Di).toFloat(),t.y=this._json.getRoot().getValueByString(Zt).getValueByString(Xs).getValueByString(Zn).getValueByString(Oi).toFloat(),t}getFps(){return this._json.getRoot().getValueByString(Zt).getValueByString(Lh).toFloat(0)}getSubRigCount(){return this._json.getRoot().getValueByString(Zt).getValueByString(Dh).toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(Zt).getValueByString(Rh).toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(Zt).getValueByString(Eh).toInt()}getVertexCount(){return this._json.getRoot().getValueByString(Zt).getValueByString(Oh).toInt()}getNormalizationPositionMinimumValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(ns).getValueByString(Qn).toFloat()}getNormalizationPositionMaximumValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(ns).getValueByString(ta).toFloat()}getNormalizationPositionDefaultValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(ns).getValueByString(ea).toFloat()}getNormalizationAngleMinimumValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(Li).getValueByString(Qn).toFloat()}getNormalizationAngleMaximumValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(Li).getValueByString(ta).toFloat()}getNormalizationAngleDefaultValue(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Oe).getValueByString(Li).getValueByString(ea).toFloat()}getInputCount(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(as).getVector().getSize()}getInputWeight(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(as).getValueByIndex(s).getValueByString(ia).toFloat()}getInputReflect(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(as).getValueByIndex(s).getValueByString(sa).toBoolean()}getInputType(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(as).getValueByIndex(s).getValueByString(qn).getRawString()}getInputSourceId(t,s){return tt.getIdManager().getId(this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(as).getValueByIndex(s).getValueByString(Ah).getValueByString(Jn).getRawString())}getOutputCount(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getVector().getSize()}getOutputVertexIndex(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(Nh).toInt()}getOutputAngleScale(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(kh).toFloat()}getOutputWeight(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(ia).toFloat()}getOutputDestinationId(t,s){return tt.getIdManager().getId(this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(Uh).getValueByString(Jn).getRawString())}getOutputType(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(qn).getRawString()}getOutputReflect(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(Se).getValueByIndex(s).getValueByString(sa).toBoolean()}getParticleCount(t){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getVector().getSize()}getParticleMobility(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(zh).toFloat()}getParticleDelay(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(jh).toFloat()}getParticleAcceleration(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(Gh).toFloat()}getParticleRadius(t,s){return this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(Xh).toFloat()}getParticlePosition(t,s){const i=new E(0,0);return i.x=this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(ns).getValueByString(Di).toFloat(),i.y=this._json.getRoot().getValueByString(et).getValueByIndex(t).getValueByString(be).getValueByIndex(s).getValueByString(ns).getValueByString(Oi).toFloat(),i}}var ra;(e=>{e.CubismPhysicsJson=sl})(ra||(ra={}));const na="X",aa="Y",oa="Angle",Wh=5,ur=100,la=.001,Hh=5;let cr=class il{static create(t,s){const i=new il;return i.parse(t,s),i._physicsRig.gravity.y=0,i}static delete(t){t!=null&&(t.release(),t=null)}parse(t,s){this._physicsRig=new el;let i=new sl(t,s);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.fps=i.getFps(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,Zo,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),Qo,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),tl,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),Ko,!0),this._currentRigOutputs.clear(),this._previousRigOutputs.clear();let r=0,n=0,a=0;for(let o=0;o<this._physicsRig.settings.getSize();++o){this._physicsRig.settings.at(o).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(o),this._physicsRig.settings.at(o).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(o),this._physicsRig.settings.at(o).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(o),this._physicsRig.settings.at(o).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(o),this._physicsRig.settings.at(o).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(o),this._physicsRig.settings.at(o).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(o),this._physicsRig.settings.at(o).inputCount=i.getInputCount(o),this._physicsRig.settings.at(o).baseInputIndex=r;for(let u=0;u<this._physicsRig.settings.at(o).inputCount;++u)this._physicsRig.inputs.at(r+u).sourceParameterIndex=-1,this._physicsRig.inputs.at(r+u).weight=i.getInputWeight(o,u),this._physicsRig.inputs.at(r+u).reflect=i.getInputReflect(o,u),i.getInputType(o,u)==na?(this._physicsRig.inputs.at(r+u).type=le.CubismPhysicsSource_X,this._physicsRig.inputs.at(r+u).getNormalizedParameterValue=Yh):i.getInputType(o,u)==aa?(this._physicsRig.inputs.at(r+u).type=le.CubismPhysicsSource_Y,this._physicsRig.inputs.at(r+u).getNormalizedParameterValue=qh):i.getInputType(o,u)==oa&&(this._physicsRig.inputs.at(r+u).type=le.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(r+u).getNormalizedParameterValue=Jh),this._physicsRig.inputs.at(r+u).source.targetType=ri.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(r+u).source.id=i.getInputSourceId(o,u);r+=this._physicsRig.settings.at(o).inputCount,this._physicsRig.settings.at(o).outputCount=i.getOutputCount(o),this._physicsRig.settings.at(o).baseOutputIndex=n;const l=new ua;l.outputs.resize(this._physicsRig.settings.at(o).outputCount);const c=new ua;c.outputs.resize(this._physicsRig.settings.at(o).outputCount);for(let u=0;u<this._physicsRig.settings.at(o).outputCount;++u)l.outputs.set(u,0),c.outputs.set(u,0),this._physicsRig.outputs.at(n+u).destinationParameterIndex=-1,this._physicsRig.outputs.at(n+u).vertexIndex=i.getOutputVertexIndex(o,u),this._physicsRig.outputs.at(n+u).angleScale=i.getOutputAngleScale(o,u),this._physicsRig.outputs.at(n+u).weight=i.getOutputWeight(o,u),this._physicsRig.outputs.at(n+u).destination.targetType=ri.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(n+u).destination.id=i.getOutputDestinationId(o,u),i.getOutputType(o,u)==na?(this._physicsRig.outputs.at(n+u).type=le.CubismPhysicsSource_X,this._physicsRig.outputs.at(n+u).getValue=Kh,this._physicsRig.outputs.at(n+u).getScale=sg):i.getOutputType(o,u)==aa?(this._physicsRig.outputs.at(n+u).type=le.CubismPhysicsSource_Y,this._physicsRig.outputs.at(n+u).getValue=Zh,this._physicsRig.outputs.at(n+u).getScale=ig):i.getOutputType(o,u)==oa&&(this._physicsRig.outputs.at(n+u).type=le.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(n+u).getValue=Qh,this._physicsRig.outputs.at(n+u).getScale=rg),this._physicsRig.outputs.at(n+u).reflect=i.getOutputReflect(o,u);this._currentRigOutputs.pushBack(l),this._previousRigOutputs.pushBack(c),n+=this._physicsRig.settings.at(o).outputCount,this._physicsRig.settings.at(o).particleCount=i.getParticleCount(o),this._physicsRig.settings.at(o).baseParticleIndex=a;for(let u=0;u<this._physicsRig.settings.at(o).particleCount;++u)this._physicsRig.particles.at(a+u).mobility=i.getParticleMobility(o,u),this._physicsRig.particles.at(a+u).delay=i.getParticleDelay(o,u),this._physicsRig.particles.at(a+u).acceleration=i.getParticleAcceleration(o,u),this._physicsRig.particles.at(a+u).radius=i.getParticleRadius(o,u),this._physicsRig.particles.at(a+u).position=i.getParticlePosition(o,u);a+=this._physicsRig.settings.at(o).particleCount}this.initialize(),i.release(),i=void 0,i=null}stabilization(t){let s,i,r,n;const a=new E;let o,l,c,u;const h=t.getModel().parameters.values,_=t.getModel().parameters.maximumValues,d=t.getModel().parameters.minimumValues,p=t.getModel().parameters.defaultValues;(this._parameterCaches?.length??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(this._parameterInputCaches?.length??0)<t.getParameterCount()&&(this._parameterInputCaches=new Float32Array(t.getParameterCount()));for(let y=0;y<t.getParameterCount();++y)this._parameterCaches[y]=h[y],this._parameterInputCaches[y]=h[y];for(let y=0;y<this._physicsRig.subRigCount;++y){s={angle:0},a.x=0,a.y=0,o=this._physicsRig.settings.at(y),l=this._physicsRig.inputs.get(o.baseInputIndex),c=this._physicsRig.outputs.get(o.baseOutputIndex),u=this._physicsRig.particles.get(o.baseParticleIndex);for(let m=0;m<o.inputCount;++m)i=l[m].weight/ur,l[m].sourceParameterIndex==-1&&(l[m].sourceParameterIndex=t.getParameterIndex(l[m].source.id)),l[m].getNormalizedParameterValue(a,s,h[l[m].sourceParameterIndex],d[l[m].sourceParameterIndex],_[l[m].sourceParameterIndex],p[l[m].sourceParameterIndex],o.normalizationPosition,o.normalizationAngle,l[m].reflect,i),this._parameterCaches[l[m].sourceParameterIndex]=h[l[m].sourceParameterIndex];r=A.degreesToRadian(-s.angle),a.x=a.x*A.cos(r)-a.y*A.sin(r),a.y=a.x*A.sin(r)+a.y*A.cos(r),ag(u,o.particleCount,a,s.angle,this._options.wind,la*o.normalizationPosition.maximum);for(let m=0;m<o.outputCount;++m){const I=c[m].vertexIndex;if(c[m].destinationParameterIndex==-1&&(c[m].destinationParameterIndex=t.getParameterIndex(c[m].destination.id)),I<1||I>=o.particleCount)continue;let T=new E;T=u[I].position.substract(u[I-1].position),n=c[m].getValue(T,u,I,c[m].reflect,this._options.gravity),this._currentRigOutputs.at(y).outputs.set(m,n),this._previousRigOutputs.at(y).outputs.set(m,n);const b=c[m].destinationParameterIndex,x=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(h.subarray(b))):h.slice(b);Ai(x,d[b],_[b],n,c[m]);for(let R=b,N=0;R<this._parameterCaches.length;R++,N++)h[R]=this._parameterCaches[R]=x[N]}}}evaluate(t,s){let i,r,n,a;const o=new E;let l,c,u,h;if(0>=s)return;const _=t.getModel().parameters.values,d=t.getModel().parameters.maximumValues,p=t.getModel().parameters.minimumValues,y=t.getModel().parameters.defaultValues;let m;if(this._currentRemainTime+=s,this._currentRemainTime>Hh&&(this._currentRemainTime=0),(this._parameterCaches?.length??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(this._parameterInputCaches?.length??0)<t.getParameterCount()){this._parameterInputCaches=new Float32Array(t.getParameterCount());for(let T=0;T<t.getParameterCount();++T)this._parameterInputCaches[T]=_[T]}for(this._physicsRig.fps>0?m=1/this._physicsRig.fps:m=s;this._currentRemainTime>=m;){for(let b=0;b<this._physicsRig.subRigCount;++b){l=this._physicsRig.settings.at(b),u=this._physicsRig.outputs.get(l.baseOutputIndex);for(let x=0;x<l.outputCount;++x)this._previousRigOutputs.at(b).outputs.set(x,this._currentRigOutputs.at(b).outputs.at(x))}const T=m/this._currentRemainTime;for(let b=0;b<t.getParameterCount();++b)this._parameterCaches[b]=this._parameterInputCaches[b]*(1-T)+_[b]*T,this._parameterInputCaches[b]=this._parameterCaches[b];for(let b=0;b<this._physicsRig.subRigCount;++b){i={angle:0},o.x=0,o.y=0,l=this._physicsRig.settings.at(b),c=this._physicsRig.inputs.get(l.baseInputIndex),u=this._physicsRig.outputs.get(l.baseOutputIndex),h=this._physicsRig.particles.get(l.baseParticleIndex);for(let x=0;x<l.inputCount;++x)r=c[x].weight/ur,c[x].sourceParameterIndex==-1&&(c[x].sourceParameterIndex=t.getParameterIndex(c[x].source.id)),c[x].getNormalizedParameterValue(o,i,this._parameterCaches[c[x].sourceParameterIndex],p[c[x].sourceParameterIndex],d[c[x].sourceParameterIndex],y[c[x].sourceParameterIndex],l.normalizationPosition,l.normalizationAngle,c[x].reflect,r);n=A.degreesToRadian(-i.angle),o.x=o.x*A.cos(n)-o.y*A.sin(n),o.y=o.x*A.sin(n)+o.y*A.cos(n),ng(h,l.particleCount,o,i.angle,this._options.wind,la*l.normalizationPosition.maximum,m,Wh);for(let x=0;x<l.outputCount;++x){const R=u[x].vertexIndex;if(u[x].destinationParameterIndex==-1&&(u[x].destinationParameterIndex=t.getParameterIndex(u[x].destination.id)),R<1||R>=l.particleCount)continue;const N=new E;N.x=h[R].position.x-h[R-1].position.x,N.y=h[R].position.y-h[R-1].position.y,a=u[x].getValue(N,h,R,u[x].reflect,this._options.gravity),this._currentRigOutputs.at(b).outputs.set(x,a);const W=u[x].destinationParameterIndex,rt=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(this._parameterCaches.subarray(W))):this._parameterCaches.slice(W);Ai(rt,p[W],d[W],a,u[x]);for(let j=W,q=0;j<this._parameterCaches.length;j++,q++)this._parameterCaches[j]=rt[q]}}this._currentRemainTime-=m}const I=this._currentRemainTime/m;this.interpolate(t,I)}interpolate(t,s){let i,r;const n=t.getModel().parameters.values,a=t.getModel().parameters.maximumValues,o=t.getModel().parameters.minimumValues;for(let l=0;l<this._physicsRig.subRigCount;++l){r=this._physicsRig.settings.at(l),i=this._physicsRig.outputs.get(r.baseOutputIndex);for(let c=0;c<r.outputCount;++c){if(i[c].destinationParameterIndex==-1)continue;const u=i[c].destinationParameterIndex,h=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(n.subarray(u))):n.slice(u);Ai(h,o[u],a[u],this._previousRigOutputs.at(l).outputs.at(c)*(1-s)+this._currentRigOutputs.at(l).outputs.at(c)*s,i[c]);for(let _=u,d=0;_<n.length;_++,d++)n[_]=h[d]}}}setOptions(t){this._options=t}getOption(){return this._options}constructor(){this._physicsRig=null,this._options=new rl,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0,this._currentRigOutputs=new D,this._previousRigOutputs=new D,this._currentRemainTime=0,this._parameterCaches=null,this._parameterInputCaches=null}release(){this._physicsRig=void 0,this._physicsRig=null}initialize(){let t,s,i;for(let r=0;r<this._physicsRig.subRigCount;++r){s=this._physicsRig.settings.at(r),t=this._physicsRig.particles.get(s.baseParticleIndex),t[0].initialPosition=new E(0,0),t[0].lastPosition=new E(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new E(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new E(0,0),t[0].force=new E(0,0);for(let n=1;n<s.particleCount;++n)i=new E(0,0),i.y=t[n].radius,t[n].initialPosition=new E(t[n-1].initialPosition.x+i.x,t[n-1].initialPosition.y+i.y),t[n].position=new E(t[n].initialPosition.x,t[n].initialPosition.y),t[n].lastPosition=new E(t[n].initialPosition.x,t[n].initialPosition.y),t[n].lastGravity=new E(0,-1),t[n].lastGravity.y*=-1,t[n].velocity=new E(0,0),t[n].force=new E(0,0)}}};class rl{constructor(){this.gravity=new E(0,0),this.wind=new E(0,0)}}class ua{constructor(){this.outputs=new D(0)}}function $h(e){let t=0;return e>0?t=1:e<0&&(t=-1),t}function Yh(e,t,s,i,r,n,a,o,l,c){e.x+=Nr(s,i,r,n,a.minimum,a.maximum,a.defalut,l)*c}function qh(e,t,s,i,r,n,a,o,l,c){e.y+=Nr(s,i,r,n,a.minimum,a.maximum,a.defalut,l)*c}function Jh(e,t,s,i,r,n,a,o,l,c){t.angle+=Nr(s,i,r,n,o.minimum,o.maximum,o.defalut,l)*c}function Kh(e,t,s,i,r){let n=e.x;return i&&(n*=-1),n}function Zh(e,t,s,i,r){let n=e.y;return i&&(n*=-1),n}function Qh(e,t,s,i,r){let n;return s>=2?r=t[s-1].position.substract(t[s-2].position):r=r.multiplyByScaler(-1),n=A.directionToRadian(r,e),i&&(n*=-1),n}function tg(e,t){const s=A.max(e,t),i=A.min(e,t);return A.abs(s-i)}function eg(e,t){return A.min(e,t)+tg(e,t)/2}function sg(e,t){return JSON.parse(JSON.stringify(e.x))}function ig(e,t){return JSON.parse(JSON.stringify(e.y))}function rg(e,t){return JSON.parse(JSON.stringify(t))}function ng(e,t,s,i,r,n,a,o){let l,c,u=new E(0,0),h=new E(0,0),_=new E(0,0),d=new E(0,0);e[0].position=new E(s.x,s.y);const p=A.degreesToRadian(i),y=A.radianToDirection(p);y.normalize();for(let m=1;m<t;++m)e[m].force=y.multiplyByScaler(e[m].acceleration).add(r),e[m].lastPosition=new E(e[m].position.x,e[m].position.y),l=e[m].delay*a*30,u=e[m].position.substract(e[m-1].position),c=A.directionToRadian(e[m].lastGravity,y)/o,u.x=A.cos(c)*u.x-u.y*A.sin(c),u.y=A.sin(c)*u.x+u.y*A.cos(c),e[m].position=e[m-1].position.add(u),h=e[m].velocity.multiplyByScaler(l),_=e[m].force.multiplyByScaler(l).multiplyByScaler(l),e[m].position=e[m].position.add(h).add(_),d=e[m].position.substract(e[m-1].position),d.normalize(),e[m].position=e[m-1].position.add(d.multiplyByScaler(e[m].radius)),A.abs(e[m].position.x)<n&&(e[m].position.x=0),l!=0&&(e[m].velocity=e[m].position.substract(e[m].lastPosition),e[m].velocity=e[m].velocity.divisionByScalar(l),e[m].velocity=e[m].velocity.multiplyByScaler(e[m].mobility)),e[m].force=new E(0,0),e[m].lastGravity=new E(y.x,y.y)}function ag(e,t,s,i,r,n){let a=new E(0,0);e[0].position=new E(s.x,s.y);const o=A.degreesToRadian(i),l=A.radianToDirection(o);l.normalize();for(let c=1;c<t;++c)e[c].force=l.multiplyByScaler(e[c].acceleration).add(r),e[c].lastPosition=new E(e[c].position.x,e[c].position.y),e[c].velocity=new E(0,0),a=e[c].force,a.normalize(),a=a.multiplyByScaler(e[c].radius),e[c].position=e[c-1].position.add(a),A.abs(e[c].position.x)<n&&(e[c].position.x=0),e[c].force=new E(0,0),e[c].lastGravity=new E(l.x,l.y)}function Ai(e,t,s,i,r){let n;const a=r.getScale(r.translationScale,r.angleScale);n=i*a,n<t?(n<r.valueBelowMinimum&&(r.valueBelowMinimum=n),n=t):n>s&&(n>r.valueExceededMaximum&&(r.valueExceededMaximum=n),n=s);const o=r.weight/ur;o>=1||(n=e[0]*(1-o)+n*o),e[0]=n}function Nr(e,t,s,i,r,n,a,o){let l=0;const c=A.max(s,t);c<e&&(e=c);const u=A.min(s,t);u>e&&(e=u);const h=A.min(r,n),_=A.max(r,n),d=a,p=eg(u,c),y=e-p;switch($h(y)){case 1:{const m=_-d,I=c-p;I!=0&&(l=y*(m/I),l+=d);break}case-1:{const m=h-d,I=u-p;I!=0&&(l=y*(m/I),l+=d);break}case 0:{l=d;break}}return o?l:l*-1}var hr;(e=>{e.CubismPhysics=cr,e.Options=rl})(hr||(hr={}));const ki=4,og=36,lg=32;class ug{constructor(t){this._renderTextureCount=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new D,this._clippingContextListForDraw=new D,this._channelColors=new D,this._tmpBoundsOnModel=new ti,this._tmpMatrix=new ge,this._tmpMatrixForMask=new ge,this._tmpMatrixForDraw=new ge,this._clippingContexttConstructor=t;let s=new Mt;s.r=1,s.g=0,s.b=0,s.a=0,this._channelColors.pushBack(s),s=new Mt,s.r=0,s.g=1,s.b=0,s.a=0,this._channelColors.pushBack(s),s=new Mt,s.r=0,s.g=0,s.b=1,s.a=0,this._channelColors.pushBack(s),s=new Mt,s.r=0,s.g=0,s.b=0,s.a=1,this._channelColors.pushBack(s)}release(){for(let t=0;t<this._clippingContextListForMask.getSize();t++)this._clippingContextListForMask.at(t)&&(this._clippingContextListForMask.at(t).release(),this._clippingContextListForMask.set(t,void 0)),this._clippingContextListForMask.set(t,null);this._clippingContextListForMask=null;for(let t=0;t<this._clippingContextListForDraw.getSize();t++)this._clippingContextListForDraw.set(t,null);this._clippingContextListForDraw=null;for(let t=0;t<this._channelColors.getSize();t++)this._channelColors.set(t,null);this._channelColors=null,this._clearedFrameBufferFlags!=null&&this._clearedFrameBufferFlags.clear(),this._clearedFrameBufferFlags=null}initialize(t,s){s%1!=0&&(G("The number of render textures must be specified as an integer. The decimal point is rounded down and corrected to an integer."),s=~~s),s<1&&G("The number of render textures must be an integer greater than or equal to 1. Set the number of render textures to 1."),this._renderTextureCount=s<1?1:s,this._clearedFrameBufferFlags=new D(this._renderTextureCount);for(let i=0;i<t.getDrawableCount();i++){if(t.getDrawableMaskCounts()[i]<=0){this._clippingContextListForDraw.pushBack(null);continue}let r=this.findSameClip(t.getDrawableMasks()[i],t.getDrawableMaskCounts()[i]);r==null&&(r=new this._clippingContexttConstructor(this,t.getDrawableMasks()[i],t.getDrawableMaskCounts()[i]),this._clippingContextListForMask.pushBack(r)),r.addClippedDrawable(i),this._clippingContextListForDraw.pushBack(r)}}findSameClip(t,s){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),n=r._clippingIdCount;if(n!=s)continue;let a=0;for(let o=0;o<n;o++){const l=r._clippingIdList[o];for(let c=0;c<n;c++)if(t[c]==l){a++;break}}if(a==n)return r}return null}setupMatrixForHighPrecision(t,s){let i=0;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r);this.calcClippedDrawTotalBounds(t,n),n._isUsing&&i++}if(i>0){if(this.setupLayoutBounds(0),this._clearedFrameBufferFlags.getSize()!=this._renderTextureCount){this._clearedFrameBufferFlags.clear();for(let r=0;r<this._renderTextureCount;r++)this._clearedFrameBufferFlags.pushBack(!1)}else for(let r=0;r<this._renderTextureCount;r++)this._clearedFrameBufferFlags.set(r,!1);for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r),a=n._allClippedDrawRect,o=n._layoutBounds,l=.05;let c=0,u=0;const h=t.getPixelsPerUnit(),_=n.getClippingManager().getClippingMaskBufferSize(),d=o.width*_,p=o.height*_;this._tmpBoundsOnModel.setRect(a),this._tmpBoundsOnModel.width*h>d?(this._tmpBoundsOnModel.expand(a.width*l,0),c=o.width/this._tmpBoundsOnModel.width):c=h/d,this._tmpBoundsOnModel.height*h>p?(this._tmpBoundsOnModel.expand(0,a.height*l),u=o.height/this._tmpBoundsOnModel.height):u=h/p,this.createMatrixForMask(s,o,c,u),n._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),n._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray())}}}createMatrixForMask(t,s,i,r){this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(s.x,s.y),this._tmpMatrix.scaleRelative(i,r),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(s.x,s.y*(t?-1:1)),this._tmpMatrix.scaleRelative(i,r*(t?-1:1)),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray())}setupLayoutBounds(t){const s=this._renderTextureCount<=1?og:lg*this._renderTextureCount;if(t<=0||t>s){t>s&&it(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-s,this._renderTextureCount,t);for(let c=0;c<this._clippingContextListForMask.getSize();c++){const u=this._clippingContextListForMask.at(c);u._layoutChannelIndex=0,u._layoutBounds.x=0,u._layoutBounds.y=0,u._layoutBounds.width=1,u._layoutBounds.height=1,u._bufferIndex=0}return}const i=this._renderTextureCount<=1?9:8;let r=t/this._renderTextureCount;const n=t%this._renderTextureCount;r=Math.ceil(r);let a=r/ki;const o=r%ki;a=~~a;let l=0;for(let c=0;c<this._renderTextureCount;c++)for(let u=0;u<ki;u++){let h=a+(u<o?1:0);const _=o+(a<1?-1:0);if(u==_&&n>0&&(h-=c<n?0:1),h!=0)if(h==1){const d=this._clippingContextListForMask.at(l++);d._layoutChannelIndex=u,d._layoutBounds.x=0,d._layoutBounds.y=0,d._layoutBounds.width=1,d._layoutBounds.height=1,d._bufferIndex=c}else if(h==2)for(let d=0;d<h;d++){let p=d%2;p=~~p;const y=this._clippingContextListForMask.at(l++);y._layoutChannelIndex=u,y._layoutBounds.x=p*.5,y._layoutBounds.y=0,y._layoutBounds.width=.5,y._layoutBounds.height=1,y._bufferIndex=c}else if(h<=4)for(let d=0;d<h;d++){let p=d%2,y=d/2;p=~~p,y=~~y;const m=this._clippingContextListForMask.at(l++);m._layoutChannelIndex=u,m._layoutBounds.x=p*.5,m._layoutBounds.y=y*.5,m._layoutBounds.width=.5,m._layoutBounds.height=.5,m._bufferIndex=c}else if(h<=i)for(let d=0;d<h;d++){let p=d%3,y=d/3;p=~~p,y=~~y;const m=this._clippingContextListForMask.at(l++);m._layoutChannelIndex=u,m._layoutBounds.x=p/3,m._layoutBounds.y=y/3,m._layoutBounds.width=1/3,m._layoutBounds.height=1/3,m._bufferIndex=c}else{it(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-s,this._renderTextureCount,t);for(let d=0;d<h;d++){const p=this._clippingContextListForMask.at(l++);p._layoutChannelIndex=0,p._layoutBounds.x=0,p._layoutBounds.y=0,p._layoutBounds.width=1,p._layoutBounds.height=1,p._bufferIndex=0}}}}calcClippedDrawTotalBounds(t,s){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MIN_VALUE,a=Number.MIN_VALUE;const o=s._clippedDrawableIndexList.length;for(let l=0;l<o;l++){const c=s._clippedDrawableIndexList[l],u=t.getDrawableVertexCount(c),h=t.getDrawableVertices(c);let _=Number.MAX_VALUE,d=Number.MAX_VALUE,p=-Number.MAX_VALUE,y=-Number.MAX_VALUE;const m=u*ce.vertexStep;for(let I=ce.vertexOffset;I<m;I+=ce.vertexStep){const T=h[I],b=h[I+1];T<_&&(_=T),T>p&&(p=T),b<d&&(d=b),b>y&&(y=b)}if(_!=Number.MAX_VALUE)if(_<i&&(i=_),d<r&&(r=d),p>n&&(n=p),y>a&&(a=y),i==Number.MAX_VALUE)s._allClippedDrawRect.x=0,s._allClippedDrawRect.y=0,s._allClippedDrawRect.width=0,s._allClippedDrawRect.height=0,s._isUsing=!1;else{s._isUsing=!0;const I=n-i,T=a-r;s._allClippedDrawRect.x=i,s._allClippedDrawRect.y=r,s._allClippedDrawRect.width=I,s._allClippedDrawRect.height=T}}}getClippingContextListForDraw(){return this._clippingContextListForDraw}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}getRenderTextureCount(){return this._renderTextureCount}getChannelFlagAsColor(t){return this._channelColors.at(t)}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}}let Le;const cg=10;class nl{constructor(){this._shaderSets=new D}release(){this.releaseShaderProgram()}setupShaderProgramForDraw(t,s,i){t.isPremultipliedAlpha()||it("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders();let r,n,a,o;const l=t.getClippingContextBufferForDraw()!=null,c=s.getDrawableInvertedMaskBit(i),u=l?c?2:1:0;let h;switch(s.getDrawableBlendMode(i)){case de.CubismBlendMode_Normal:default:h=this._shaderSets.at(1+u),r=this.gl.ONE,n=this.gl.ONE_MINUS_SRC_ALPHA,a=this.gl.ONE,o=this.gl.ONE_MINUS_SRC_ALPHA;break;case de.CubismBlendMode_Additive:h=this._shaderSets.at(4+u),r=this.gl.ONE,n=this.gl.ONE,a=this.gl.ZERO,o=this.gl.ONE;break;case de.CubismBlendMode_Multiplicative:h=this._shaderSets.at(7+u),r=this.gl.DST_COLOR,n=this.gl.ONE_MINUS_SRC_ALPHA,a=this.gl.ZERO,o=this.gl.ONE;break}this.gl.useProgram(h.shaderProgram),t._bufferData.vertex==null&&(t._bufferData.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.vertex);const _=s.getDrawableVertices(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,_,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(h.attributePositionLocation),this.gl.vertexAttribPointer(h.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const d=s.getDrawableVertexUvs(i);if(this.gl.bufferData(this.gl.ARRAY_BUFFER,d,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(h.attributeTexCoordLocation),this.gl.vertexAttribPointer(h.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),l){this.gl.activeTexture(this.gl.TEXTURE1);const R=t.getClippingContextBufferForDraw().getClippingManager().getColorBuffer().at(t.getClippingContextBufferForDraw()._bufferIndex);this.gl.bindTexture(this.gl.TEXTURE_2D,R),this.gl.uniform1i(h.samplerTexture1Location,1),this.gl.uniformMatrix4fv(h.uniformClipMatrixLocation,!1,t.getClippingContextBufferForDraw()._matrixForDraw.getArray());const N=t.getClippingContextBufferForDraw()._layoutChannelIndex,W=t.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(N);this.gl.uniform4f(h.uniformChannelFlagLocation,W.r,W.g,W.b,W.a)}const p=s.getDrawableTextureIndex(i),y=t.getBindedTextures().getValue(p);this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,y),this.gl.uniform1i(h.samplerTexture0Location,0);const m=t.getMvpMatrix();this.gl.uniformMatrix4fv(h.uniformMatrixLocation,!1,m.getArray());const I=t.getModelColorWithOpacity(s.getDrawableOpacity(i)),T=s.getMultiplyColor(i),b=s.getScreenColor(i);this.gl.uniform4f(h.uniformBaseColorLocation,I.r,I.g,I.b,I.a),this.gl.uniform4f(h.uniformMultiplyColorLocation,T.r,T.g,T.b,T.a),this.gl.uniform4f(h.uniformScreenColorLocation,b.r,b.g,b.b,b.a),t._bufferData.index==null&&(t._bufferData.index=this.gl.createBuffer());const x=s.getDrawableVertexIndices(i);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t._bufferData.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,x,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(r,n,a,o)}setupShaderProgramForMask(t,s,i){t.isPremultipliedAlpha()||it("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders();const r=this._shaderSets.at(0);this.gl.useProgram(r.shaderProgram),t._bufferData.vertex==null&&(t._bufferData.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.vertex);const n=s.getDrawableVertices(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(r.attributePositionLocation),this.gl.vertexAttribPointer(r.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const a=s.getDrawableTextureIndex(i),o=t.getBindedTextures().getValue(a);this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.uniform1i(r.samplerTexture0Location,0),t._bufferData.uv==null&&(t._bufferData.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t._bufferData.uv);const l=s.getDrawableVertexUvs(i);this.gl.bufferData(this.gl.ARRAY_BUFFER,l,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(r.attributeTexCoordLocation),this.gl.vertexAttribPointer(r.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),t.getClippingContextBufferForMask();const c=t.getClippingContextBufferForMask()._layoutChannelIndex,u=t.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(c);this.gl.uniform4f(r.uniformChannelFlagLocation,u.r,u.g,u.b,u.a),this.gl.uniformMatrix4fv(r.uniformClipMatrixLocation,!1,t.getClippingContextBufferForMask()._matrixForMask.getArray());const h=t.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(r.uniformBaseColorLocation,h.x*2-1,h.y*2-1,h.getRight()*2-1,h.getBottom()*2-1);const _=s.getMultiplyColor(i),d=s.getScreenColor(i);this.gl.uniform4f(r.uniformMultiplyColorLocation,_.r,_.g,_.b,_.a),this.gl.uniform4f(r.uniformScreenColorLocation,d.r,d.g,d.b,d.a);const p=this.gl.ZERO,y=this.gl.ONE_MINUS_SRC_COLOR,m=this.gl.ZERO,I=this.gl.ONE_MINUS_SRC_ALPHA;t._bufferData.index==null&&(t._bufferData.index=this.gl.createBuffer());const T=s.getDrawableVertexIndices(i);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t._bufferData.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,T,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(p,y,m,I)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.getSize();t++)this.gl.deleteProgram(this._shaderSets.at(t).shaderProgram),this._shaderSets.at(t).shaderProgram=0,this._shaderSets.set(t,void 0),this._shaderSets.set(t,null)}generateShaders(){for(let t=0;t<cg;t++)this._shaderSets.pushBack(new al);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(hg,gg),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(dg,fg),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(ca,pg),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(ca,_g),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(0).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_multiplyColor"),this._shaderSets.at(0).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_screenColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(1).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_multiplyColor"),this._shaderSets.at(1).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_screenColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(2).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_multiplyColor"),this._shaderSets.at(2).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_screenColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(3).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_multiplyColor"),this._shaderSets.at(3).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_screenColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(4).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_multiplyColor"),this._shaderSets.at(4).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_screenColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(5).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_multiplyColor"),this._shaderSets.at(5).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_screenColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(6).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_multiplyColor"),this._shaderSets.at(6).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_screenColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(7).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_multiplyColor"),this._shaderSets.at(7).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_screenColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(8).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_multiplyColor"),this._shaderSets.at(8).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_screenColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor"),this._shaderSets.at(9).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_multiplyColor"),this._shaderSets.at(9).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_screenColor")}loadShaderProgram(t,s){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!r)return it("Vertex shader compile error!"),0;let n=this.compileShaderSource(this.gl.FRAGMENT_SHADER,s);return n?(this.gl.attachShader(i,r),this.gl.attachShader(i,n),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(n),i):(it("Failed to link program: {0}",i),this.gl.deleteShader(r),r=0,this.gl.deleteShader(n),n=0,i&&(this.gl.deleteProgram(i),i=0),0)):(it("Vertex shader compile error!"),0)}compileShaderSource(t,s){const i=s,r=this.gl.createShader(t);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const a=this.gl.getShaderInfoLog(r);it("Shader compile log: {0} ",a)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(t){this.gl=t}}class Pe{static getInstance(){return Le==null&&(Le=new Pe),Le}static deleteInstance(){Le&&(Le.release(),Le=null)}constructor(){this._shaderMap=new Lt}release(){for(const t=this._shaderMap.begin();t.notEqual(this._shaderMap.end());t.preIncrement())t.ptr().second.release();this._shaderMap.clear()}getShader(t){return this._shaderMap.getValue(t)}setGlContext(t){if(!this._shaderMap.isExist(t)){const s=new nl;s.setGl(t),this._shaderMap.setValue(t,s)}}}class al{}var ol=(e=>(e[e.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",e[e.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",e[e.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",e[e.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",e[e.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",e[e.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",e))(ol||{});const hg="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",gg="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",dg="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",ca="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",fg="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 color = texColor * u_baseColor;   gl_FragColor = vec4(color.rgb, color.a);}",pg="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",_g="precision mediump float;varying vec2      v_texCoord;varying vec4      v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4      u_channelFlag;uniform vec4      u_baseColor;uniform vec4      u_multiplyColor;uniform vec4      u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * (1.0 - maskVal);   gl_FragColor = col_formask;}";var ha;(e=>{e.CubismShaderSet=al,e.CubismShader_WebGL=nl,e.CubismShaderManager_WebGL=Pe,e.ShaderNames=ol})(ha||(ha={}));let se,ni;class gr extends ug{getMaskRenderTexture(){if(this._maskTexture&&this._maskTexture.textures!=null)this._maskTexture.frameNo=this._currentFrameNo;else{this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=new D,this._maskColorBuffers!=null&&this._maskColorBuffers.clear(),this._maskColorBuffers=new D;const t=this._clippingMaskBufferSize;for(let s=0;s<this._renderTextureCount;s++)this._maskColorBuffers.pushBack(this.gl.createTexture()),this.gl.bindTexture(this.gl.TEXTURE_2D,this._maskColorBuffers.at(s)),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this._maskRenderTextures.pushBack(this.gl.createFramebuffer()),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTextures.at(s)),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._maskColorBuffers.at(s),0);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ni),this._maskTexture=new ll(this._currentFrameNo,this._maskRenderTextures)}return this._maskTexture.textures}setGL(t){this.gl=t}constructor(){super(ul)}setupClippingContext(t,s){this._currentFrameNo++;let i=0;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r);this.calcClippedDrawTotalBounds(t,n),n._isUsing&&i++}if(i>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._currentMaskRenderTexture=this.getMaskRenderTexture().at(0),s.preDraw(),this.setupLayoutBounds(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture),this._clearedFrameBufferFlags.getSize()!=this._renderTextureCount&&(this._clearedFrameBufferFlags.clear(),this._clearedFrameBufferFlags=new D(this._renderTextureCount));for(let r=0;r<this._clearedFrameBufferFlags.getSize();r++)this._clearedFrameBufferFlags.set(r,!1);for(let r=0;r<this._clippingContextListForMask.getSize();r++){const n=this._clippingContextListForMask.at(r),a=n._allClippedDrawRect,o=n._layoutBounds,l=.05;let c=0,u=0;const h=this.getMaskRenderTexture().at(n._bufferIndex);this._currentMaskRenderTexture!=h&&(this._currentMaskRenderTexture=h,s.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),this._tmpBoundsOnModel.setRect(a),this._tmpBoundsOnModel.expand(a.width*l,a.height*l),c=o.width/this._tmpBoundsOnModel.width,u=o.height/this._tmpBoundsOnModel.height,this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(c,u),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(c,u),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),n._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),n._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const _=n._clippingIdCount;for(let d=0;d<_;d++){const p=n._clippingIdList[d];t.getDrawableDynamicFlagVertexPositionsDidChange(p)&&(s.setIsCulling(t.getDrawableCulling(p)!=!1),this._clearedFrameBufferFlags.at(n._bufferIndex)||(this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this._clearedFrameBufferFlags.set(n._bufferIndex,!0)),s.setClippingContextBufferForMask(n),s.drawMeshWebGL(t,p))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ni),s.setClippingContextBufferForMask(null),this.gl.viewport(se[0],se[1],se[2],se[3])}}getColorBuffer(){return this._maskColorBuffers}getClippingMaskCount(){return this._clippingContextListForMask.getSize()}}class ll{constructor(t,s){this.frameNo=t,this.textures=s}}class ul extends Hc{constructor(t,s,i){super(s,i),this._owner=t}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}class mg{setGlEnable(t,s){s?this.gl.enable(t):this.gl.disable(t)}setGlEnableVertexAttribArray(t,s){s?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)}save(){if(this.gl==null){it(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._lastArrayBufferBinding=this.gl.getParameter(this.gl.ARRAY_BUFFER_BINDING),this._lastElementArrayBufferBinding=this.gl.getParameter(this.gl.ELEMENT_ARRAY_BUFFER_BINDING),this._lastProgram=this.gl.getParameter(this.gl.CURRENT_PROGRAM),this._lastActiveTexture=this.gl.getParameter(this.gl.ACTIVE_TEXTURE),this.gl.activeTexture(this.gl.TEXTURE1),this._lastTexture1Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this.gl.activeTexture(this.gl.TEXTURE0),this._lastTexture0Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._lastVertexAttribArrayEnabled[0]=this.gl.getVertexAttrib(0,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[1]=this.gl.getVertexAttrib(1,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[2]=this.gl.getVertexAttrib(2,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[3]=this.gl.getVertexAttrib(3,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastScissorTest=this.gl.isEnabled(this.gl.SCISSOR_TEST),this._lastStencilTest=this.gl.isEnabled(this.gl.STENCIL_TEST),this._lastDepthTest=this.gl.isEnabled(this.gl.DEPTH_TEST),this._lastCullFace=this.gl.isEnabled(this.gl.CULL_FACE),this._lastBlend=this.gl.isEnabled(this.gl.BLEND),this._lastFrontFace=this.gl.getParameter(this.gl.FRONT_FACE),this._lastColorMask=this.gl.getParameter(this.gl.COLOR_WRITEMASK),this._lastBlending[0]=this.gl.getParameter(this.gl.BLEND_SRC_RGB),this._lastBlending[1]=this.gl.getParameter(this.gl.BLEND_DST_RGB),this._lastBlending[2]=this.gl.getParameter(this.gl.BLEND_SRC_ALPHA),this._lastBlending[3]=this.gl.getParameter(this.gl.BLEND_DST_ALPHA),this._lastFBO=this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING),this._lastViewport=this.gl.getParameter(this.gl.VIEWPORT)}restore(){if(this.gl==null){it(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this.gl.useProgram(this._lastProgram),this.setGlEnableVertexAttribArray(0,this._lastVertexAttribArrayEnabled[0]),this.setGlEnableVertexAttribArray(1,this._lastVertexAttribArrayEnabled[1]),this.setGlEnableVertexAttribArray(2,this._lastVertexAttribArrayEnabled[2]),this.setGlEnableVertexAttribArray(3,this._lastVertexAttribArrayEnabled[3]),this.setGlEnable(this.gl.SCISSOR_TEST,this._lastScissorTest),this.setGlEnable(this.gl.STENCIL_TEST,this._lastStencilTest),this.setGlEnable(this.gl.DEPTH_TEST,this._lastDepthTest),this.setGlEnable(this.gl.CULL_FACE,this._lastCullFace),this.setGlEnable(this.gl.BLEND,this._lastBlend),this.gl.frontFace(this._lastFrontFace),this.gl.colorMask(this._lastColorMask[0],this._lastColorMask[1],this._lastColorMask[2],this._lastColorMask[3]),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._lastArrayBufferBinding),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this._lastElementArrayBufferBinding),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture1Binding2D),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture0Binding2D),this.gl.activeTexture(this._lastActiveTexture),this.gl.blendFuncSeparate(this._lastBlending[0],this._lastBlending[1],this._lastBlending[2],this._lastBlending[3])}setGl(t){this.gl=t}constructor(){this._lastVertexAttribArrayEnabled=new Array(4),this._lastColorMask=new Array(4),this._lastBlending=new Array(4),this._lastViewport=new Array(4)}}class Ur extends fi{initialize(t,s=1){t.isUsingMasking()&&(this._clippingManager=new gr,this._clippingManager.initialize(t,s)),this._sortedDrawableIndexList.resize(t.getDrawableCount(),0),super.initialize(t)}bindTexture(t,s){this._textures.setValue(t,s)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(t){if(!this._model.isUsingMasking())return;const s=this._clippingManager.getRenderTextureCount();this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new gr,this._clippingManager.setClippingMaskBufferSize(t),this._clippingManager.initialize(this.getModel(),s)}getClippingMaskBufferSize(){return this._model.isUsingMasking()?this._clippingManager.getClippingMaskBufferSize():-1}getRenderTextureCount(){return this._model.isUsingMasking()?this._clippingManager.getRenderTextureCount():-1}constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._rendererProfile=new mg,this.firstDraw=!0,this._textures=new Lt,this._sortedDrawableIndexList=new D,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}release(){this._clippingManager&&(this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null),this.gl!=null&&(this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null)}doDrawModel(){if(this.gl==null){it(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._clippingManager!=null&&(this.preDraw(),this.isUsingHighPrecisionMask()?this._clippingManager.setupMatrixForHighPrecision(this.getModel(),!1):this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const t=this.getModel().getDrawableCount(),s=this.getModel().getDrawableRenderOrders();for(let i=0;i<t;++i){const r=s[i];this._sortedDrawableIndexList.set(r,i)}for(let i=0;i<t;++i){const r=this._sortedDrawableIndexList.at(i);if(!this.getModel().getDrawableDynamicFlagIsVisible(r))continue;const n=this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw().at(r):null;if(n!=null&&this.isUsingHighPrecisionMask()){n._isUsing&&(this.gl.viewport(0,0,this._clippingManager.getClippingMaskBufferSize(),this._clippingManager.getClippingMaskBufferSize()),this.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,n.getClippingManager().getMaskRenderTexture().at(n._bufferIndex)),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));{const a=n._clippingIdCount;for(let o=0;o<a;o++){const l=n._clippingIdList[o];this._model.getDrawableDynamicFlagVertexPositionsDidChange(l)&&(this.setIsCulling(this._model.getDrawableCulling(l)!=!1),this.setClippingContextBufferForMask(n),this.drawMeshWebGL(this._model,l))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,ni),this.setClippingContextBufferForMask(null),this.gl.viewport(se[0],se[1],se[2],se[3]),this.preDraw()}this.setClippingContextBufferForDraw(n),this.setIsCulling(this.getModel().getDrawableCulling(r)),this.drawMeshWebGL(this._model,r)}}drawMeshWebGL(t,s){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW),this.isGeneratingMask()?Pe.getInstance().getShader(this.gl).setupShaderProgramForMask(this,t,s):Pe.getInstance().getShader(this.gl).setupShaderProgramForDraw(this,t,s);{const i=t.getDrawableVertexIndexCount(s);this.gl.drawElements(this.gl.TRIANGLES,i,this.gl.UNSIGNED_SHORT,0)}this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}saveProfile(){this._rendererProfile.save()}restoreProfile(){this._rendererProfile.restore()}static doStaticRelease(){Pe.deleteInstance()}setRenderState(t,s){ni=t,se=s}preDraw(){if(this.firstDraw&&(this.firstDraw=!1),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.getAnisotropy()>0&&this._extension)for(let t=0;t<this._textures.getSize();++t)this.gl.bindTexture(this.gl.TEXTURE_2D,this._textures.getValue(t)),this.gl.texParameterf(this.gl.TEXTURE_2D,this._extension.TEXTURE_MAX_ANISOTROPY_EXT,this.getAnisotropy())}setClippingContextBufferForMask(t){this._clippingContextBufferForMask=t}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(t){this._clippingContextBufferForDraw=t}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}isGeneratingMask(){return this.getClippingContextBufferForMask()!=null}startUp(t){this.gl=t,this._clippingManager&&this._clippingManager.setGL(t),Pe.getInstance().setGlContext(t),this._rendererProfile.setGl(t),this._extension=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")}}fi.staticRelease=()=>{Ur.doStaticRelease()};var ga;(e=>{e.CubismClippingContext=ul,e.CubismClippingManager_WebGL=gr,e.CubismRenderTextureResource=ll,e.CubismRenderer_WebGL=Ur})(ga||(ga={}));class yg{constructor(t=!1,s=!1){this.isOverridden=t,this.isParameterRepeated=s}}class da{constructor(t=!1,s=new Mt){this.isOverridden=t,this.color=s}get isOverwritten(){return this.isOverridden}}class fa{constructor(t=!1,s=new Mt){this.isOverridden=t,this.color=s}get isOverwritten(){return this.isOverridden}}class Cg{constructor(t=!1,s=!1){this.isOverridden=t,this.isCulling=s}get isOverwritten(){return this.isOverridden}}class cl{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getPixelsPerUnit(){return this._model==null?0:this._model.canvasinfo.PixelsPerUnit}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,s=this._savedParameters.getSize();for(let i=0;i<t;++i)i<s?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getMultiplyColor(t){return this.getOverrideFlagForModelMultiplyColors()||this.getOverrideFlagForDrawableMultiplyColors(t)?this._userMultiplyColors.at(t).color:this.getDrawableMultiplyColor(t)}getScreenColor(t){return this.getOverrideFlagForModelScreenColors()||this.getOverrideFlagForDrawableScreenColors(t)?this._userScreenColors.at(t).color:this.getDrawableScreenColor(t)}setMultiplyColorByTextureColor(t,s){this.setMultiplyColorByRGBA(t,s.r,s.g,s.b,s.a)}setMultiplyColorByRGBA(t,s,i,r,n=1){this._userMultiplyColors.at(t).color.r=s,this._userMultiplyColors.at(t).color.g=i,this._userMultiplyColors.at(t).color.b=r,this._userMultiplyColors.at(t).color.a=n}setScreenColorByTextureColor(t,s){this.setScreenColorByRGBA(t,s.r,s.g,s.b,s.a)}setScreenColorByRGBA(t,s,i,r,n=1){this._userScreenColors.at(t).color.r=s,this._userScreenColors.at(t).color.g=i,this._userScreenColors.at(t).color.b=r,this._userScreenColors.at(t).color.a=n}getPartMultiplyColor(t){return this._userPartMultiplyColors.at(t).color}getPartScreenColor(t){return this._userPartScreenColors.at(t).color}setPartColor(t,s,i,r,n,a,o){if(a.at(t).color.r=s,a.at(t).color.g=i,a.at(t).color.b=r,a.at(t).color.a=n,a.at(t).isOverridden)for(let l=0;l<this._partChildDrawables.at(t).getSize();++l){const c=this._partChildDrawables.at(t).at(l);o.at(c).color.r=s,o.at(c).color.g=i,o.at(c).color.b=r,o.at(c).color.a=n}}setPartMultiplyColorByTextureColor(t,s){this.setPartMultiplyColorByRGBA(t,s.r,s.g,s.b,s.a)}setPartMultiplyColorByRGBA(t,s,i,r,n){this.setPartColor(t,s,i,r,n,this._userPartMultiplyColors,this._userMultiplyColors)}setPartScreenColorByTextureColor(t,s){this.setPartScreenColorByRGBA(t,s.r,s.g,s.b,s.a)}setPartScreenColorByRGBA(t,s,i,r,n){this.setPartColor(t,s,i,r,n,this._userPartScreenColors,this._userScreenColors)}getOverrideFlagForModelParameterRepeat(){return this._isOverriddenParameterRepeat}setOverrideFlagForModelParameterRepeat(t){this._isOverriddenParameterRepeat=t}getOverrideFlagForParameterRepeat(t){return this._userParameterRepeatDataList.at(t).isOverridden}setOverrideFlagForParameterRepeat(t,s){this._userParameterRepeatDataList.at(t).isOverridden=s}getRepeatFlagForParameterRepeat(t){return this._userParameterRepeatDataList.at(t).isParameterRepeated}setRepeatFlagForParameterRepeat(t,s){this._userParameterRepeatDataList.at(t).isParameterRepeated=s}getOverwriteFlagForModelMultiplyColors(){return G("getOverwriteFlagForModelMultiplyColors() is a deprecated function. Please use getOverrideFlagForModelMultiplyColors()."),this.getOverrideFlagForModelMultiplyColors()}getOverrideFlagForModelMultiplyColors(){return this._isOverriddenModelMultiplyColors}getOverwriteFlagForModelScreenColors(){return G("getOverwriteFlagForModelScreenColors() is a deprecated function. Please use getOverrideFlagForModelScreenColors()."),this.getOverrideFlagForModelScreenColors()}getOverrideFlagForModelScreenColors(){return this._isOverriddenModelScreenColors}setOverwriteFlagForModelMultiplyColors(t){G("setOverwriteFlagForModelMultiplyColors(value: boolean) is a deprecated function. Please use setOverrideFlagForModelMultiplyColors(value: boolean)."),this.setOverrideFlagForModelMultiplyColors(t)}setOverrideFlagForModelMultiplyColors(t){this._isOverriddenModelMultiplyColors=t}setOverwriteFlagForModelScreenColors(t){G("setOverwriteFlagForModelScreenColors(value: boolean) is a deprecated function. Please use setOverrideFlagForModelScreenColors(value: boolean)."),this.setOverrideFlagForModelScreenColors(t)}setOverrideFlagForModelScreenColors(t){this._isOverriddenModelScreenColors=t}getOverwriteFlagForDrawableMultiplyColors(t){return G("getOverwriteFlagForDrawableMultiplyColors(drawableindex: number) is a deprecated function. Please use getOverrideFlagForDrawableMultiplyColors(drawableindex: number)."),this.getOverrideFlagForDrawableMultiplyColors(t)}getOverrideFlagForDrawableMultiplyColors(t){return this._userMultiplyColors.at(t).isOverridden}getOverwriteFlagForDrawableScreenColors(t){return G("getOverwriteFlagForDrawableScreenColors(drawableindex: number) is a deprecated function. Please use getOverrideFlagForDrawableScreenColors(drawableindex: number)."),this.getOverrideFlagForDrawableScreenColors(t)}getOverrideFlagForDrawableScreenColors(t){return this._userScreenColors.at(t).isOverridden}setOverwriteFlagForDrawableMultiplyColors(t,s){G("setOverwriteFlagForDrawableMultiplyColors(drawableindex: number, value: boolean) is a deprecated function. Please use setOverrideFlagForDrawableMultiplyColors(drawableindex: number, value: boolean)."),this.setOverrideFlagForDrawableMultiplyColors(t,s)}setOverrideFlagForDrawableMultiplyColors(t,s){this._userMultiplyColors.at(t).isOverridden=s}setOverwriteFlagForDrawableScreenColors(t,s){G("setOverwriteFlagForDrawableScreenColors(drawableindex: number, value: boolean) is a deprecated function. Please use setOverrideFlagForDrawableScreenColors(drawableindex: number, value: boolean)."),this.setOverrideFlagForDrawableScreenColors(t,s)}setOverrideFlagForDrawableScreenColors(t,s){this._userScreenColors.at(t).isOverridden=s}getOverwriteColorForPartMultiplyColors(t){return G("getOverwriteColorForPartMultiplyColors(partIndex: number) is a deprecated function. Please use getOverrideColorForPartMultiplyColors(partIndex: number)."),this.getOverrideColorForPartMultiplyColors(t)}getOverrideColorForPartMultiplyColors(t){return this._userPartMultiplyColors.at(t).isOverridden}getOverwriteColorForPartScreenColors(t){return G("getOverwriteColorForPartScreenColors(partIndex: number) is a deprecated function. Please use getOverrideColorForPartScreenColors(partIndex: number)."),this.getOverrideColorForPartScreenColors(t)}getOverrideColorForPartScreenColors(t){return this._userPartScreenColors.at(t).isOverridden}setOverwriteColorForPartColors(t,s,i,r){G("setOverwriteColorForPartColors(partIndex: number, value: boolean, partColors: csmVector<PartColorData>, drawableColors: csmVector<DrawableColorData>) is a deprecated function. Please use setOverrideColorForPartColors(partIndex: number, value: boolean, partColors: csmVector<PartColorData>, drawableColors: csmVector<DrawableColorData>)."),this.setOverrideColorForPartColors(t,s,i,r)}setOverrideColorForPartColors(t,s,i,r){i.at(t).isOverridden=s;for(let n=0;n<this._partChildDrawables.at(t).getSize();++n){const a=this._partChildDrawables.at(t).at(n);r.at(a).isOverridden=s,s&&(r.at(a).color.r=i.at(t).color.r,r.at(a).color.g=i.at(t).color.g,r.at(a).color.b=i.at(t).color.b,r.at(a).color.a=i.at(t).color.a)}}setOverwriteColorForPartMultiplyColors(t,s){G("setOverwriteColorForPartMultiplyColors(partIndex: number, value: boolean) is a deprecated function. Please use setOverrideColorForPartMultiplyColors(partIndex: number, value: boolean)."),this.setOverrideColorForPartMultiplyColors(t,s)}setOverrideColorForPartMultiplyColors(t,s){this._userPartMultiplyColors.at(t).isOverridden=s,this.setOverrideColorForPartColors(t,s,this._userPartMultiplyColors,this._userMultiplyColors)}setOverwriteColorForPartScreenColors(t,s){G("setOverwriteColorForPartScreenColors(partIndex: number, value: boolean) is a deprecated function. Please use setOverrideColorForPartScreenColors(partIndex: number, value: boolean)."),this.setOverrideColorForPartScreenColors(t,s)}setOverrideColorForPartScreenColors(t,s){this._userPartScreenColors.at(t).isOverridden=s,this.setOverrideColorForPartColors(t,s,this._userPartScreenColors,this._userScreenColors)}getDrawableCulling(t){if(this.getOverrideFlagForModelCullings()||this.getOverrideFlagForDrawableCullings(t))return this._userCullings.at(t).isCulling;const s=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(s[t])}setDrawableCulling(t,s){this._userCullings.at(t).isCulling=s}getOverwriteFlagForModelCullings(){return G("getOverwriteFlagForModelCullings() is a deprecated function. Please use getOverrideFlagForModelCullings()."),this.getOverrideFlagForModelCullings()}getOverrideFlagForModelCullings(){return this._isOverriddenCullings}setOverwriteFlagForModelCullings(t){G("setOverwriteFlagForModelCullings(isOverriddenCullings: boolean) is a deprecated function. Please use setOverrideFlagForModelCullings(isOverriddenCullings: boolean)."),this.setOverrideFlagForModelCullings(t)}setOverrideFlagForModelCullings(t){this._isOverriddenCullings=t}getOverwriteFlagForDrawableCullings(t){return G("getOverwriteFlagForDrawableCullings(drawableIndex: number) is a deprecated function. Please use getOverrideFlagForDrawableCullings(drawableIndex: number)."),this.getOverrideFlagForDrawableCullings(t)}getOverrideFlagForDrawableCullings(t){return this._userCullings.at(t).isOverridden}setOverwriteFlagForDrawableCullings(t,s){G("setOverwriteFlagForDrawableCullings(drawableIndex: number, isOverriddenCullings: boolean) is a deprecated function. Please use setOverrideFlagForDrawableCullings(drawableIndex: number, isOverriddenCullings: boolean)."),this.setOverrideFlagForDrawableCullings(t,s)}setOverrideFlagForDrawableCullings(t,s){this._userCullings.at(t).isOverridden=s}getModelOapcity(){return this._modelOpacity}setModelOapcity(t){this._modelOpacity=t}getModel(){return this._model}getPartIndex(t){let s;const i=this._model.parts.count;for(s=0;s<i;++s)if(t==this._partIds.at(s))return s;return this._notExistPartId.isExist(t)?this._notExistPartId.getValue(t):(s=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(t,s),this._notExistPartOpacities.appendKey(s),s)}getPartId(t){const s=this._model.parts.ids[t];return tt.getIdManager().getId(s)}getPartCount(){return this._model.parts.count}getPartParentPartIndices(){return this._model.parts.parentIndices}setPartOpacityByIndex(t,s){if(this._notExistPartOpacities.isExist(t)){this._notExistPartOpacities.setValue(t,s);return}bt(0<=t&&t<this.getPartCount()),this._partOpacities[t]=s}setPartOpacityById(t,s){const i=this.getPartIndex(t);i<0||this.setPartOpacityByIndex(i,s)}getPartOpacityByIndex(t){return this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.getValue(t):(bt(0<=t&&t<this.getPartCount()),this._partOpacities[t])}getPartOpacityById(t){const s=this.getPartIndex(t);return s<0?0:this.getPartOpacityByIndex(s)}getParameterIndex(t){let s;const i=this._model.parameters.count;for(s=0;s<i;++s)if(t==this._parameterIds.at(s))return s;return this._notExistParameterId.isExist(t)?this._notExistParameterId.getValue(t):(s=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(t,s),this._notExistParameterValues.appendKey(s),s)}getParameterCount(){return this._model.parameters.count}getParameterType(t){return this._model.parameters.types[t]}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterId(t){return tt.getIdManager().getId(this._model.parameters.ids[t])}getParameterValueByIndex(t){return this._notExistParameterValues.isExist(t)?this._notExistParameterValues.getValue(t):(bt(0<=t&&t<this.getParameterCount()),this._parameterValues[t])}getParameterValueById(t){const s=this.getParameterIndex(t);return this.getParameterValueByIndex(s)}setParameterValueByIndex(t,s,i=1){if(this._notExistParameterValues.isExist(t)){this._notExistParameterValues.setValue(t,i==1?s:this._notExistParameterValues.getValue(t)*(1-i)+s*i);return}bt(0<=t&&t<this.getParameterCount()),this.isRepeat(t)?s=this.getParameterRepeatValue(t,s):s=this.getParameterClampValue(t,s),this._parameterValues[t]=i==1?s:this._parameterValues[t]=this._parameterValues[t]*(1-i)+s*i}setParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.setParameterValueByIndex(r,s,i)}addParameterValueByIndex(t,s,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+s*i)}addParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.addParameterValueByIndex(r,s,i)}isRepeat(t){if(this._notExistParameterValues.isExist(t))return!1;bt(0<=t&&t<this.getParameterCount());let s;return this._isOverriddenParameterRepeat||this._userParameterRepeatDataList.at(t).isOverridden?s=this._userParameterRepeatDataList.at(t).isParameterRepeated:s=this._model.parameters.repeats[t]!=0,s}getParameterRepeatValue(t,s){if(this._notExistParameterValues.isExist(t))return s;bt(0<=t&&t<this.getParameterCount());const i=this._model.parameters.maximumValues[t],r=this._model.parameters.minimumValues[t],n=i-r;if(i<s){const a=A.mod(s-i,n);Number.isNaN(a)?s=i:s=r+a}if(s<r){const a=A.mod(r-s,n);Number.isNaN(a)?s=r:s=i-a}return s}getParameterClampValue(t,s){if(this._notExistParameterValues.isExist(t))return s;bt(0<=t&&t<this.getParameterCount());const i=this._model.parameters.maximumValues[t],r=this._model.parameters.minimumValues[t];return A.clamp(s,r,i)}getParameterRepeats(t){return this._model.parameters.repeats[t]!=0}multiplyParameterValueById(t,s,i=1){const r=this.getParameterIndex(t);this.multiplyParameterValueByIndex(r,s,i)}multiplyParameterValueByIndex(t,s,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(s-1)*i))}getDrawableIndex(t){const s=this._model.drawables.count;for(let i=0;i<s;++i)if(this._drawableIds.at(i)==t)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){const s=this._model.drawables.ids;return tt.getIdManager().getId(s[t])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this.getDrawableTextureIndex(t)}getDrawableTextureIndex(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(s[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableMultiplyColor(t){const s=this._model.drawables.multiplyColors,i=t*4,r=new Mt;return r.r=s[i],r.g=s[i+1],r.b=s[i+2],r.a=s[i+3],r}getDrawableScreenColor(t){const s=this._model.drawables.screenColors,i=t*4,r=new Mt;return r.r=s[i],r.g=s[i+1],r.b=s[i+2],r.a=s[i+3],r}getDrawableParentPartIndex(t){return this._model.drawables.parentPartIndices[t]}getDrawableBlendMode(t){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(s[t])?de.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(s[t])?de.CubismBlendMode_Multiplicative:de.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(s[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(s[t])}getDrawableDynamicFlagVisibilityDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(s[t])}getDrawableDynamicFlagOpacityDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(s[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(s[t])}getDrawableDynamicFlagBlendColorDidChange(t){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasBlendColorDidChangeBit(s[t])}loadParameters(){let t=this._model.parameters.count;const s=this._savedParameters.getSize();t>s&&(t=s);for(let i=0;i<t;++i)this._parameterValues[i]=this._savedParameters.at(i)}initialize(){bt(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const s=this._model.parameters.ids,i=this._model.parameters.count;this._parameterIds.prepareCapacity(i),this._userParameterRepeatDataList.prepareCapacity(i);for(let r=0;r<i;++r)this._parameterIds.pushBack(tt.getIdManager().getId(s[r])),this._userParameterRepeatDataList.pushBack(new yg(!1,!1))}const t=this._model.parts.count;{const s=this._model.parts.ids;this._partIds.prepareCapacity(t);for(let i=0;i<t;++i)this._partIds.pushBack(tt.getIdManager().getId(s[i]));this._userPartMultiplyColors.prepareCapacity(t),this._userPartScreenColors.prepareCapacity(t),this._partChildDrawables.prepareCapacity(t)}{const s=this._model.drawables.ids,i=this._model.drawables.count;this._userMultiplyColors.prepareCapacity(i),this._userScreenColors.prepareCapacity(i),this._userCullings.prepareCapacity(i);const r=new Cg(!1,!1);for(let n=0;n<t;++n){const a=new Mt(1,1,1,1),o=new Mt(0,0,0,1),l=new fa(!1,a),c=new fa(!1,o);this._userPartMultiplyColors.pushBack(l),this._userPartScreenColors.pushBack(c),this._partChildDrawables.pushBack(new D),this._partChildDrawables.at(n).prepareCapacity(i)}for(let n=0;n<i;++n){const a=new Mt(1,1,1,1),o=new Mt(0,0,0,1),l=new da(!1,a),c=new da(!1,o);this._drawableIds.pushBack(tt.getIdManager().getId(s[n])),this._userMultiplyColors.pushBack(l),this._userScreenColors.pushBack(c),this._userCullings.pushBack(r);const u=this.getDrawableParentPartIndex(n);u>=0&&this._partChildDrawables.at(u).pushBack(n)}}}constructor(t){this._model=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new D,this._parameterIds=new D,this._drawableIds=new D,this._partIds=new D,this._isOverriddenParameterRepeat=!0,this._isOverriddenModelMultiplyColors=!1,this._isOverriddenModelScreenColors=!1,this._isOverriddenCullings=!1,this._modelOpacity=1,this._userParameterRepeatDataList=new D,this._userMultiplyColors=new D,this._userScreenColors=new D,this._userCullings=new D,this._userPartMultiplyColors=new D,this._userPartScreenColors=new D,this._partChildDrawables=new D,this._notExistPartId=new Lt,this._notExistParameterId=new Lt,this._notExistParameterValues=new Lt,this._notExistPartOpacities=new Lt}release(){this._model.release(),this._model=null}}var pa;(e=>{e.CubismModel=cl})(pa||(pa={}));class mi{static create(t,s){let i=null;if(s&&!this.hasMocConsistency(t))return it("Inconsistent MOC3."),i;const r=Live2DCubismCore.Moc.fromArrayBuffer(t);return r&&(i=new mi(r),i._mocVersion=Live2DCubismCore.Version.csmGetMocVersion(r,t)),i}static delete(t){t._moc._release(),t._moc=null,t=null}createModel(){let t=null;const s=Live2DCubismCore.Model.fromMoc(this._moc);return s&&(t=new cl(s),t.initialize(),++this._modelCount),t}deleteModel(t){t!=null&&(t.release(),t=null,--this._modelCount)}constructor(t){this._moc=t,this._modelCount=0,this._mocVersion=0}release(){bt(this._modelCount==0),this._moc._release(),this._moc=null}getLatestMocVersion(){return Live2DCubismCore.Version.csmGetLatestMocVersion()}getMocVersion(){return this._mocVersion}static hasMocConsistency(t){return Live2DCubismCore.Moc.prototype.hasMocConsistency(t)===1}}var _a;(e=>{e.CubismMoc=mi})(_a||(_a={}));const ma="Meta",xg="UserDataCount",Sg="TotalUserDataSize",Ni="UserData",bg="Target",Mg="Id",vg="Value";class hl{constructor(t,s){this._json=lt.create(t,s)}release(){lt.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString(ma).getValueByString(xg).toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString(ma).getValueByString(Sg).toInt()}getUserDataTargetType(t){return this._json.getRoot().getValueByString(Ni).getValueByIndex(t).getValueByString(bg).getRawString()}getUserDataId(t){return tt.getIdManager().getId(this._json.getRoot().getValueByString(Ni).getValueByIndex(t).getValueByString(Mg).getRawString())}getUserDataValue(t){return this._json.getRoot().getValueByString(Ni).getValueByIndex(t).getValueByString(vg).getRawString()}}var ya;(e=>{e.CubismModelUserDataJson=hl})(ya||(ya={}));const Pg="ArtMesh";class gl{}class Fs{static create(t,s){const i=new Fs;return i.parseUserData(t,s),i}static delete(t){t!=null&&(t.release(),t=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(t,s){let i=new hl(t,s);if(!i){i.release(),i=void 0;return}const r=tt.getIdManager().getId(Pg),n=i.getUserDataCount();for(let a=0;a<n;a++){const o=new gl;o.targetId=i.getUserDataId(a),o.targetType=tt.getIdManager().getId(i.getUserDataTargetType(a)),o.value=new Tt(i.getUserDataValue(a)),this._userDataNodes.pushBack(o),o.targetType==r&&this._artMeshUserDataNode.pushBack(o)}i.release(),i=void 0}constructor(){this._userDataNodes=new D,this._artMeshUserDataNode=new D}release(){for(let t=0;t<this._userDataNodes.getSize();++t)this._userDataNodes.set(t,null);this._userDataNodes=null}}var Ca;(e=>{e.CubismModelUserData=Fs,e.CubismModelUserDataNode=gl})(Ca||(Ca={}));let Bg=class dl{isInitialized(){return this._initialized}setInitialized(t){this._initialized=t}isUpdating(){return this._updating}setUpdating(t){this._updating=t}setDragging(t,s){this._dragManager.set(t,s)}setAcceleration(t,s,i){this._accelerationX=t,this._accelerationY=s,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(t){this._opacity=t}getOpacity(){return this._opacity}loadModel(t,s=!1){if(this._moc=mi.create(t,s),this._moc==null){it("Failed to CubismMoc.create().");return}if(this._model=this._moc.createModel(),this._model==null){it("Failed to CreateModel().");return}this._model.saveParameters(),this._modelMatrix=new Ro(this._model.getCanvasWidth(),this._model.getCanvasHeight())}loadMotion(t,s,i,r,n,a,o,l,c=!1){if(t==null||s==0)return it("Failed to loadMotion()."),null;const u=Yo.create(t,s,r,n,c);if(u==null)return it("Failed to create motion from buffer in LoadMotion()"),null;if(a){const h=a.getMotionFadeInTimeValue(o,l);h>=0&&u.setFadeInTime(h);const _=a.getMotionFadeOutTimeValue(o,l);_>=0&&u.setFadeOutTime(_)}return u}loadExpression(t,s,i){return t==null||s==0?(it("Failed to loadExpression()."),null):ze.create(t,s)}loadPose(t,s){if(t==null||s==0){it("Failed to loadPose().");return}this._pose=Is.create(t,s)}loadUserData(t,s){if(t==null||s==0){it("Failed to loadUserData().");return}this._modelUserData=Fs.create(t,s)}loadPhysics(t,s){if(t==null||s==0){it("Failed to loadPhysics().");return}this._physics=cr.create(t,s)}isHit(t,s,i){const r=this._model.getDrawableIndex(t);if(r<0)return!1;const n=this._model.getDrawableVertexCount(r),a=this._model.getDrawableVertices(r);let o=a[0],l=a[0],c=a[1],u=a[1];for(let d=1;d<n;++d){const p=a[ce.vertexOffset+d*ce.vertexStep],y=a[ce.vertexOffset+d*ce.vertexStep+1];p<o&&(o=p),p>l&&(l=p),y<c&&(c=y),y>u&&(u=y)}const h=this._modelMatrix.invertTransformX(s),_=this._modelMatrix.invertTransformY(i);return o<=h&&h<=l&&c<=_&&_<=u}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(t=1){this._renderer&&this.deleteRenderer(),this._renderer=new Ur,this._renderer.initialize(this._model,t)}deleteRenderer(){this._renderer!=null&&(this._renderer.release(),this._renderer=null)}motionEventFired(t){Ft("{0}",t.s)}static cubismDefaultMotionEventCallback(t,s,i){const r=i;r?.motionEventFired(s)}constructor(){this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._mocConsistency=!1,this._debugMode=!1,this._renderer=null,this._motionManager=new Jo,this._motionManager.setEventCallback(dl.cubismDefaultMotionEventCallback,this),this._expressionManager=new ko,this._dragManager=new Eo}release(){this._motionManager!=null&&(this._motionManager.release(),this._motionManager=null),this._expressionManager!=null&&(this._expressionManager.release(),this._expressionManager=null),this._moc!=null&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,Is.delete(this._pose),Fo.delete(this._eyeBlink),pi.delete(this._breath),this._dragManager=null,cr.delete(this._physics),Fs.delete(this._modelUserData),this.deleteRenderer()}};var dr;(e=>{e.CubismUserModel=Bg})(dr||(dr={}));const Me=tt;class Hg extends er.ICubismModelSetting{}class Ig extends sr.CubismModelSettingJson{}class Vg extends tr.CubismMatrix44{}class wg extends dr.CubismUserModel{}class $g extends rr.ACubismMotion{}class Yg extends ar.CubismMotion{}class qg extends nr.CubismExpressionMotion{}class Jg extends or.CubismMotionManager{}class Kg extends hr.CubismPhysics{}class Fg extends ir.CubismEyeBlink{}class Gs extends Qi.csmVector{}class Tg extends wg{motionResources;expressionResources;lipSyncParamIds=new Gs;eyeBlinkParamIds=new Gs;constructor(){super(),this.motionResources={},this.expressionResources={},this.lipSyncParamIds=new Gs,this.eyeBlinkParamIds=new Gs,this._lipsync=!1}setEyeBlink(t){this._eyeBlink=t}addEyeBlinkParameterId(t){this.eyeBlinkParamIds.pushBack(t)}addLipSyncParameterId(t){this.lipSyncParamIds.pushBack(t)}addMotion(t,s,i=1,r=1){const n=this.loadMotion(t,t.byteLength,s);return i>0&&n.setFadeInTime(i),r>0&&n.setFadeOutTime(r),n.setEffectIds(this.eyeBlinkParamIds,this.lipSyncParamIds),this.motionResources[s]=n,s}addExpression(t,s,i=1,r=1){const n=this.loadExpression(t,t.byteLength,s);return i>0&&n.setFadeInTime(i),r>0&&n.setFadeOutTime(r),this.expressionResources[s]=n,s}get motionNames(){return Object.keys(this.motionResources)}get isMotionFinished(){return this._motionManager.isFinished()}startMotionByName(t){const s=this.motionResources[t];s&&this._motionManager.startMotionPriority(s,!1,0)}startExpressionByName(t){const s=this.expressionResources[t];s&&this._expressionManager.startMotionPriority(s,!1,1)}update(t){this.getModel().loadParameters();const s=this._motionManager.updateMotion(this.getModel(),t),i=this._expressionManager.updateMotion(this.getModel(),t);this.getModel().saveParameters(),!s&&!i&&this._eyeBlink!=null&&this._eyeBlink.updateParameters(this._model,t),this._pose!==null&&this._pose.updateParameters(this._model,0),this._physics!=null&&this._physics.evaluate(this._model,t),this._model.update()}}const Rg={autoBlink:!0,x:0,y:0,scale:1};let xa=!1;class Eg{canvas;model=new Tg;point=new Po;constructor(t){this.canvas=t}async init(t,s,i={}){const r=this.canvas.getContext("webgl");if(r===null)throw new Error("WebGL");r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.clearColor(0,0,0,0),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL);const n=Object.assign({},Rg,i),a=r.getParameter(r.FRAMEBUFFER_BINDING);xa||(Me.startUp(),Me.initialize(),xa=!0);const o=new Ig(t,t.byteLength),{moc3:l,textures:c,physics:u,expressions:h,motions:_}=s;this.model.loadModel(l),this.model.createRenderer();let d=0;for(const j of c){const q=await Dg(j,r);this.model.getRenderer().bindTexture(d,q),d++}this.model.getRenderer().setIsPremultipliedAlpha(!0),this.model.getRenderer().startUp(r),n.autoBlink&&this.model.setEyeBlink(Fg.create(o));for(let j=0,q=o.getEyeBlinkParameterCount();j<q;j++)this.model.addEyeBlinkParameterId(o.getEyeBlinkParameterId(j));for(let j=0,q=o.getLipSyncParameterCount();j<q;j++)this.model.addLipSyncParameterId(o.getLipSyncParameterId(j));this.model.loadPhysics(u,u.byteLength);for(const[j,q]of h)this.model.addExpression(q,j);for(const[j,q]of _)this.model.addMotion(q,j);const p=Object.assign({x:0,y:0,z:1},{x:n.x,y:n.y,z:n.scale}),y=new Vg,m=()=>{this.canvas.width=this.canvas.clientWidth*devicePixelRatio,this.canvas.height=this.canvas.clientHeight*devicePixelRatio;const j=this.model.getModelMatrix();j.bottom(0),j.centerY(-1),j.translateY(-1),y.loadIdentity(),1<this.canvas.height/this.canvas.width?j.scale(1,this.canvas.width/this.canvas.height):j.scale(this.canvas.height/this.canvas.width,1),j.translateRelative(p.x,p.y),y.multiplyByMatrix(j);const Rt=p.z;y.scaleRelative(Rt,Rt),this.model.getRenderer().setMvpMatrix(y)};m();const I=[0,0,this.canvas.width,this.canvas.height];let T=Date.now();const b=this.model.getModel(),x=Me.getIdManager(),R=()=>{const j=Date.now(),q=(j-T)/1e3;b.setParameterValueById(x.getId("ParamAngleX"),this.point.angleX,.5),b.setParameterValueById(x.getId("ParamAngleY"),this.point.angleY,.5),b.setParameterValueById(x.getId("ParamAngleZ"),this.point.angleZ,.5),b.setParameterValueById(x.getId("ParamEyeBallX"),this.point.angleEyeX,.5),b.setParameterValueById(x.getId("ParamEyeBallY"),this.point.angleEyeY,.5),b.setParameterValueById(x.getId("ParamBodyAngleZ"),this.point.angleZ/2,.05),b.saveParameters(),this.model.update(q),I[2]=this.canvas.width,I[3]=this.canvas.height,this.model.getRenderer().setRenderState(a,I),this.model.getRenderer().drawModel(),T=j,requestAnimationFrame(R)};window.addEventListener("resize",()=>{m(),R()}),R();const N=["akubi","akubi","swing","AiArt"],W=()=>{setTimeout(()=>{this.model.isMotionFinished&&this.model.startMotionByName(N[Math.floor(Math.random()*N.length)]),W()},1e3*10+Math.random()*1e3*80)};W();const rt=()=>{setTimeout(()=>{this.model.startMotionByName("mimi"),rt()},1e3*10+Math.random()*1e3*30)};rt()}updatePoint(t){Object.assign(this.point,t)}click(t){const s=this.canvas.getBoundingClientRect(),i=s.left+s.width/2,r=s.top+s.height/2,n=(t.clientX-i)/(s.width/2),a=(t.clientY-r)/(s.height/2);this.model.isHit(Me.getIdManager().getId("HitArea"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Me.getIdManager().getId("HitArea2"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Me.getIdManager().getId("HitArea_Body"),n,a)?this.model.startMotionByName("mimi"):this.model.isHit(Me.getIdManager().getId("HitArea_Head"),n,a)}}async function Dg(e,t){return new Promise(s=>{const i=URL.createObjectURL(e),r=new Image;r.onload=()=>{const n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.generateMipmap(t.TEXTURE_2D),URL.revokeObjectURL(i),s(n)},r.addEventListener("error",()=>{console.error("image load error")}),r.src=i})}function Og(e,t,s,i){return Math.sqrt(Math.pow(s-e,2)+Math.pow(i-t,2))}function Lg(e,t,s,i){return Math.atan2(i-t,s-e)}const Sa="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js",Bt="./misskey/live2d/ai/web/",Ae={moc3:Bt+"ai.moc3",model3:Bt+"ai.model3.json",physics3:Bt+"ai.physics3.json",textures:[Bt+"ai.4096/texture_00.png"],expressions:{smile:Bt+"expressions/exp_01.exp3.json",surprise:Bt+"expressions/exp_02.exp3.json",happy:Bt+"expressions/exp_06.exp3.json",jitome:Bt+"expressions/exp_11.exp3.json",gurugurume:Bt+"expressions/exp_20.exp3.json"},motions:{swing:Bt+"motions/mtn_03.motion3.json",akubi:Bt+"motions/mtn_04.motion3.json",mimi:Bt+"motions/mtn_05.motion3.json",AiArt:Bt+"motions/AiArt.motion3.json"}};let ba=!1;function Ag(e,t){return new Promise((s,i)=>{const r=document.head.querySelector(`script[src="${Sa}"]`);if(r)ba?Ui(e,t).then(n=>{s(n)}):r.addEventListener("load",()=>{Ui(e,t).then(n=>{s(n)})});else{const n=document.createElement("script");n.setAttribute("src",Sa),document.head.appendChild(n),n.addEventListener("load",()=>{ba=!0,Ui(e,t).then(a=>{s(a)})})}})}async function Ui(e,t){try{const[s,i,r,n,a,o]=await Promise.all([fetch(Ae.model3).then(h=>h.arrayBuffer()),fetch(Ae.moc3).then(h=>h.arrayBuffer()),fetch(Ae.physics3).then(h=>h.arrayBuffer()),Promise.all(Ae.textures.map(h=>fetch(h).then(_=>_.blob()))),Promise.all(Object.entries(Ae.expressions).map(([h,_])=>fetch(_).then(d=>d.arrayBuffer()).then(d=>[h,d]))),Promise.all(Object.entries(Ae.motions).map(([h,_])=>fetch(_).then(d=>d.arrayBuffer()).then(d=>[h,d])))]),l=new Eg(e);await l.init(s,{moc3:i,physics:r,textures:n,expressions:a,motions:o},{autoBlink:!0,...t}),window.parent.postMessage({type:"loaded",body:null},"*");const c=new Po,u=h=>{const _=h.x,d=h.y,p=e.getBoundingClientRect(),y=t.eyeX?t.eyeX:p.left+p.width/2,m=t.eyeY?t.eyeY:p.top+p.height/2,I=Lg(_,d,y,m),T=Math.cos(I)*Math.sin(I)*180/Math.PI,b=Og(_,d,y,m),x=y-_,R=m-d;Object.assign(c,{angleX:-x/10,angleY:R/10,angleZ:T*(b/y)/10,angleEyeX:-x/y/10,angleEyeY:R/m/2}),l.updatePoint(c)};return document.body.addEventListener("mousemove",h=>{u({x:h.clientX,y:h.clientY})},!1),window.addEventListener("message",h=>{const{type:_,body:d}=h.data;switch(_){case"setPos":break;case"moveCursor":u(d);break;default:break}},!1),l}catch(s){alert(s.message),console.error(s)}}const kg=fu({__name:"App",setup(e,{expose:t}){let s=null;const i=Kl(),r=n=>{s&&s.click(n)};return Qa(()=>{const n=new URL(window.location.href);Ag(i.value,{scale:parseFloat(n.searchParams.get("scale")||"1"),x:parseFloat(n.searchParams.get("x")||"0"),y:parseFloat(n.searchParams.get("y")||"1"),eyeX:n.searchParams.has("eyeX")?parseFloat(n.searchParams.get("eyeX")):void 0,eyeY:n.searchParams.has("eyeY")?parseFloat(n.searchParams.get("eyeY")):void 0}).then(a=>{a&&(s=Xa(a))})}),t({canvas:i,touched:r}),(n,a)=>(sc(),nc("canvas",{id:"canvas",ref_key:"canvas",ref:i,onClick:r},null,512))}});Xc(kg).mount("#app");
